Observer-based boundary control of distributed
parameter systems : a port- Hamiltonian approach
Jesus Pablo Toledo Zucco

To cite this version:
Jesus Pablo Toledo Zucco. Observer-based boundary control of distributed parameter systems : a portHamiltonian approach. Automatic. Université Bourgogne Franche-Comté, 2021. English. �NNT :
2021UBFCD032�. �tel-03439358�

HAL Id: tel-03439358
https://tel.archives-ouvertes.fr/tel-03439358
Submitted on 22 Nov 2021

HAL is a multi-disciplinary open access
archive for the deposit and dissemination of scientific research documents, whether they are published or not. The documents may come from
teaching and research institutions in France or
abroad, or from public or private research centers.

L’archive ouverte pluridisciplinaire HAL, est
destinée au dépôt et à la diffusion de documents
scientifiques de niveau recherche, publiés ou non,
émanant des établissements d’enseignement et de
recherche français ou étrangers, des laboratoires
publics ou privés.



Thèse de doctorat de l’établissement
Université Bourgogne Franche-Comté
preparée à l’Université de Franche-Comté
École doctorale no 37
Sciences Pour l’Ingénieur et Microtechniques
Doctorat de Automatique
Par

Jesús Pablo Toledo Zucco
Synthèse de lois de commande à base
d’observateurs pour les systèmes à
paramètres distribués: une
approache Hamiltonienne à ports
Thèse présentée et soutenue à Besançon, le 01 Juillet 2021

Composition du Jury :
Laurent Lefèvre
Alessandro Macchelli
Thomas Meurer
Bernhard Maschke
Paul Kotyczka
Yongxin Wu
Hector Ramirez
Yann Le Gorrec

Professeur des Universités, Grenoble INP-Esisar
Maître de conférences, HDR, Université de Bologna
Professeur, Université de Kiel
Professeur des Universités, Université Claude Bernard Lyon1
Maître de conférences, HDR, Université technique de Munich
Maître de conférences, ENSMM Besançon
Maître de conférences, HDR, Université Federico Santa María
Professeur des Universités, ENSMM Besançon

Rapporteur
Rapporteur
Examinateur
Examinateur
Examinateur
Co-directeur
Co-directeur
Directeur de thèse



Ph.D. thesis of the University Bourgogne
Franche-Comté prepared at the
University of Franche-Comté
Doctoral school no 37
Engineering Sciences and Microtechnologies
Ph.D in Automatic
by

Jesús Pablo Toledo Zucco
Observer-based boundary control of
distributed parameter systems: a
port-Hamiltonian approach
Thesis defended publicly on July 01, 2021, in Besançon

Composition of jury :
Laurent Lefèvre
Alessandro Macchelli
Thomas Meurer
Bernhard Maschke
Paul Kotyczka
Yongxin Wu
Hector Ramirez
Yann Le Gorrec

Professor of University, Grenoble INP-Esisar
Associate Professor, University of Bologna
Professor, Kiel University
Professor of University, Claude Bernard University Lyon 1
Associate Professor, Technical University of Munich
Associate Professor, ENSMM Besançon
Associate Professor, Federico Santa María Technical University
Professor of University, ENSMM Besançon

Reviewer
Reviewer
Member
Member
Member
Co-supervisor
Co-supervisor
Supervisor



To my mother, father and brothers.



Acknowledgements

Acknowledgements
I want to start by thanking the most important people of my life, my family. I am who I
am because of all of you: Paola, Enrique, Enrique, Nicolás and José. I also want to thank my
grandfathers, uncles and cousins for all the support you have given me throughout my life. I want
to thank, as well, my nephews and their mother for the immense joy that they have brought to our
family.
I want to continue with the people who have made this thesis possible: Yann, Héctor and Yongxin.
Thank you for including me in your group, introducing me to the port-Hamiltonian (pH) community
and the world of Partial Differential Equations. Thanks, as well, for discussing with me, explaining
complex stuff in simple words, working on our papers, reading my manuscript and correcting it.
More important, thank you for worrying not only about the scientific aspects but also the social
ones. It is not an easy task to leave your country, but you have made it too much simpler for me.
I want to thank, as well, Daniel from the University of Concepción. He has motivated me to follow
the scientific career in the domain of automatic control.
I want to thank the reviewers of my thesis: Laurant and Alessandro. Thank you for taking your
time to read my manuscript and give me your feedback that has contributed to a better quality
of the final version of this manuscript. I want to thank, as well, the jury members of my defense.
Bernhard, Thomas and Paul. Thank you for all the scientific discussions we have had before, during,
and after my defense. Your remarks have improved the quality of the final version of this manuscript,
as well. I want to thank Bernhard for assisting in person to my defense during a complex period.
Your assistance made the thesis defense more pleasant.
This thesis has been supported by the French-German ANR-DFG INFIDHEM project ANR-16CE92-0028. In this project, I met very nice and interesting people whom I want to thank for all the
moments lived together in meetings, conferences, summer schools, etc. In particular, I want to thank
Denis, Andrea and Annas from Toulouse, Bernhard from Lyon, Birgit and Julia from Wuppertal,
Thomas and Bastian from Kiel, Paul and Tobias from Munich, and Marc from Paris.
Most of my work has been within the pH team at the AS2M department of Femto-ST. I want
to thank, again, Yann, Yongxin and Héctor for their patience discussing with me. I want to thank
Vincent, even if we couldn’t have too many discussions, his discretization method was useful for my
thesis. I want to thank Luis for all the discussion that we have had and for recently helping me with
the final format of this thesis. I want to thank Ning for helping me, from the first day that I met
her, with the french, the new theory, the administrative paperwork, and many other things. Finally,
I want to thank a very good friend, Andrea. Thank you for supporting me from the beginning of
my thesis, spending a lot of time discussing with me complex math concepts, receiving me in your
home, introducing me to your lovely family, sharing your culture, playing football, hiking, etc.
I want to thank Alika, from the doctoral school, for her patience and all the help she gave
me during the doctoral period. Similarly, I want to thank Isabelle and Estelle from the AS2M
department for their cooperation concerning all the administrative stuff. At the AS2M department,
I met a lot of people to whom I want to thank everyone. Thanks for all discussions during the coffee
break. From the permanent staff, I would like to thank Phillipe, Jean-Marc, Kanty, Christophe,

iii



Acknowledgements

Nicolas, Aude, Cedric, Zeina, Guillaume, Patrick R., Patrick N., and Jean-Yves. From the nonpermanent staff, I would like to thank Abbas, Romain, Benjamin, Maxime, Omar, Hugo, Amine,
Belal, Alexis, Aicha, Anh, Aurélie, Chibundo, Daniel, Maribel, and Yucely. I would like to especially
thank Chifaa, for being a very good friend, being a very nice and happy person, helping me with
the french and sharing very nice moments. Also, I want to thank all my office colleagues for theirs
cultural exchanges, general discussion, and nice moments lived together in our great office. Thank
Joël, Marwa, Ning, Bhawnath, Yuning, Olivier, and Luc.
Many non-academic activities kept me active and allowed me to recharge my energy and rest
my mind. I want to thank the football team of USport which I have spent almost every Tuesday at
noon. In general, I am very grateful to the USport. They have provided nice activities like hiking,
skiing, and volley nights that helped me distract myself and rest my mind. Also, I want to thank the
football team of BBF, especially Daniel, Adrien and Billy. I want to thank as well a more recently
hiking group that keeps me active on Sundays. In all these activities, I met wonderful people that I
will never forget. I want to thank some good friends that I met during my stay in Besançon: Diego,
Veronica, and Wilmar, and some friends from Chile with whom I kept in touch all this time: Felipe,
Andrés, Eric, Enrique, Natalia, Héctor, Alejandro, and Rodrigo.
Finally, I want to thank the person who was next to me, supporting me, encouraging me, and
making me happy. Thank Irina for being with me during this period. I will always be grateful to
you and your family for including me in your activities and celebrations. I also want to thank you
for bringing Olympe to our home. She has always been a source of energy and happiness.
Jesús Toledo Zucco, September 15, 2021, in Besançon, France.

“Gracias a la vida que me ha dado tanto,
me ha dado la marcha de mis pies cansados,
con ellos anduve ciudades y charcos,
playas y desiertos, montañas y llanos,
y la casa tuya, tu calle y tu patio.”
Violeta Parra

iv



Notation

Notation
Symbols
t
ζ
R
Rn
Rn×n
Mn (R)
H 1 ([a, b], Rn )
L(X)
L(U, X)
L2 ([a, b], Rn )
♦

♣

Time variable.
Spatial variable.
Set of all scalar with real values.
Set of all column vectors with real values.
Set of all matrices with real values.
Space of all real n × n matrices.
Vector space of all function from [a, b] to Rn , which are square integrable,
absolutely continuous and the derivative is again square integrable.
Vector space of bounded linear operators from X to X.
Vector space of bounded linear operators from U to X.
Space of all square-integrable functions ion Rn evaluated at [a, b].
Ending a Theorem, Proposition, Lemma, or Corollary.
Ending a Proof.
Ending an Example, Remark, Definition, or Assumption.

Acronyms
BCSs
BC-PHSs
PR
SPR
ODEs
PDEs
ZSD
OSP
LTI
NTI
LPSs
DPSs
LQR
OBSF
i.e.

Boundary control systems.
Boundary controlled port-Hamiltonian systems.
Positive real.
Strictly positive real.
Ordinary differential equations.
Partial differential equations.
Zero state detectable.
Output strictly passive.
Linear time invariant.
Nonlinear time invariant.
Lumped parameter systems.
Distributed parameter systems.
Linear quadratic regulator.
Observer-based state feedback.
abbreviation for id est (that is).

v





Contents

Contents
Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . iii
Notation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . v
Contents . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . vii
I

II

III

Context . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1
I.1

Main introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

2

I.2

Organization of the thesis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4

I.3

Publications . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

5

I.4

Main contributions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

6

Background on boundary controlled port-Hamiltonian systems . 7
II.1

Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

8

II.2

Boundary controlled port-Hamiltonian systems . . . . . . . . . . . . . . . . . . . . . . .

8

II.3

Examples of BC-PHSs. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
II.3.1 The transmission line . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
II.3.2 The vibrating string . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
II.3.3 The Timoshenko beam. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

11
11
12
14

II.4

Controllability and observability of BC-PHSs . . . . . . . . . . . . . . . . . . . . . . . . . 16

II.5

Stabilization of BC-PHSs. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
II.5.1 Static output feedback . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
II.5.2 Dynamic output feedback . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21

II.6

Motivation example: observer-based control . . . . . . . . . . . . . . . . . . . . . . . . . .
II.6.1 Control by interconnection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
II.6.2 Observer-based control: early-lumping approach . . . . . . . . . . . . . . . . . . . . .
II.6.3 Observer-based control: late-lumping approach . . . . . . . . . . . . . . . . . . . . . .

II.7

Conclusion. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31

26
27
28
30

Finite-dimensional observer-based boundary controllers: earlylumping approach . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33

vii



Contents

III.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
III.2 Preliminaries . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36
III.3 State feedback and Luenberger observer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37
III.4 Passive observer-based state feedback structure. . . . . . . . . . . . . . . . . . . . . . . 40
III.5 Asymptotic stability analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
III.6 Observer design for a specific state feedback . . . . . . . . . . . . . . . . . . . . . . . . . . 44
III.6.1 Design method . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44
III.6.2 Application examples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47
III.7 State feedback design for a specific observer . . . . . . . . . . . . . . . . . . . . . . . . . . 58
III.7.1 Design method . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58
III.7.2 Application example . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60
III.8 Extension to a class of nonlinear systems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65
III.8.1 Design method . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65
III.8.2 Application example . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 68
III.9 Conclusions. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77

IV

Infinite-dimensional observer-based boundary controllers: latelumping approach . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79
IV.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 80
IV.2 Preliminaries . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 82
IV.3 Infinite-dimensional observers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
IV.3.1 The co-energy variables are measured . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
IV.3.2 The integral over time of the co-energy variables are measured . . . . . . . .
IV.3.3 The co-energy variables and their integrals over time are both measured. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

84
84
91
98

IV.4 Observer-based damping injection: application to the vibrating string
105
IV.4.1 Fully actuated string with a force sensor . . . . . . . . . . . . . . . . . . . . . . . . . . . . 105
IV.4.2 Fully actuated string with a displacement sensor. . . . . . . . . . . . . . . . . . . . . 111
IV.5 Observer-based damping injection and energy shaping: application
to the vibrating string. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 120
IV.6 Conclusion. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 124

V

viii

Conclusions and future works. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 125
V.1

Conclusions. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 126

V.2

Future works . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 128



Contents

A

Appendix . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 131
A.1

Finite-differences spatial discretization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 132
A.1.1 Vibrating string . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 132
A.1.2 Timoshenko beam . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 134

A.2

Mid-point time discretization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 138

A.3

An LMI approach to design K or L . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 139

A.4

Abstract formulation of boundary control systems . . . . . . . . . . . . . . . . . . . . 141

Bibliography . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 143
List of Figures . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 151
List of Tables . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 155

ix



Chapter I
Context

I.1

Main introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

2

I.2

Organization of the thesis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4

I.3

Publications . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

5

I.4

Main contributions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

6

1



Chapter I. Context

I.1

Main introduction

In control theory, state feedback control is the most efficient way to assign desired behaviour
to dynamical systems and to guarantee closed-loop stability [Kalman 69]. The main drawback
of this control strategy is that it requires knowledge of the complete or partial state. Since the
state is not always available from sensors, this control law is, in general, applied using observers
[Luenberger 64]. An observer is a dynamical system that uses the model and the available data
from sensors and actuators to estimate, in real-time, the state variables of the system. Then, the
desired state feedback is applied using the observed values instead of the real ones. This is known as
observer-based state feedback (OBSF) control. In this thesis, we study the synthesis of this type of
control laws for port-Hamiltonian systems described by partial differential equations (PDEs) defined
on a one-dimensional domain with actuators and sensors collocated at the spatial boundaries.
The port-Hamiltonian formulation of systems described by ordinary differential equations (ODEs)
has been introduced in [Maschke 92], and it has shown to be well suited for modelling, analysis and
control of multiphysical systems [Dalsmo 98, van der Schaft 00, Stramigioli 01, Duindam 09]. A
port-Hamiltonian system is characterized by its energy and the power that is exchanged with the
environment (controllers, perturbations, or other systems). For this type of systems, the most
popular control technique is the control by energy shaping and damping injection. This control
technique consists in assigning the closed-loop energy function and guaranteeing closed-loop stability
by adding damping [Maschke 98, Ortega 02, Ortega 04]. For linear time-invariant (LTI) systems,
control by energy shaping and damping injection can be compared with classical control techniques
as pole placement, linear quadratic regulation (LQR), or H∞ -control [Prajna 02]. The control law
obtained using this technique usually ends in a state feedback control law. To implement it, the
use of observers is necessary. Using the port-Hamiltonian approach, the synthesis of observers has
been quite intensively studied for lumped parameter systems (LPSs) [Venkatraman 10a, Kotyczka 15,
Vincent 16, Yaghmaei 18, Biedermann 18], but only a few studies have been addressed for distributed
parameter systems (DPSs) [Toledo 20, Malzer 20a].
The port-Hamiltonian formulation has been extended to DPSs or systems described by PDEs in
[van der Schaft 02], showing in a period of twenty years to be a successful approach for the modelling, analysis, and control design of DPSs [Rashad 20]. The general formulation of boundary control systems (BCSs) [Fattorini 68, Curtain 12] using the port-Hamiltonian approach is addressed in
[Le Gorrec 05], where a new class of BCSs is defined as boundary controlled port-Hamiltonian systems
(BC-PHSs). BC-PHSs are DPSs with actuators and sensors located at the spatial boundaries and
with the state variables chosen as the energy variables. This class of systems can model beams and
waves [Macchelli 04b, Voß 14], open channels [Hamroun 06], piezoelectric structures [Schöberl 08],
ionic polymer-metal composite [Nishida 11, Liu 21], chemical reactors [Le Gorrec 06, Zhou 17], fluid
motion in containers [Cardoso-Ribeiro 17], rotating flexible spacecrafts [Aoues 17], among others.
The existence and uniqueness of solutions for BC-PHSs have been studied using functional analysis for the linear case in [Le Gorrec 05, Le Gorrec 06, Zwart 10, Jacob 12, Jacob 15, Jacob 18,
Augner 20] and for the nonlinear case in [Augner 19, Hastir 19]. In [Jacob 19], the authors have
shown that every well-posed linear BC-PHS is exact controllable and exact observable. The stabilization and the synthesis of control laws for BC-PHSs have been addressed in [Villegas 07] using static
output feedback [Villegas 09] and dynamic output feedback [Villegas 05, Ramirez 14, Macchelli 18,
Macchelli 20]. The energy shaping and damping injection techniques have been extended from the

2



I.2. Organization of the thesis

finite-dimensional formulation to the infinite-dimensional one in [Macchelli 04a, Pasumarthy 07,
Hamroun 10, Schöberl 12, Macchelli 17]. Some others approaches have been studied using backstepping boundary control [Vu 17, Ramirez 17b] and nonlinear dynamic boundary control for linear
BC-PHSs [Ramirez 17a, Califano 18]. In this thesis, we are interested in the observer-based state
feedback design for the class of impedance energy preserving BC-PHSs. To this end, we employ
both early-lumping and late-lumping approaches [Meurer 12].
In the early-lumping approach, the infinite-dimensional system is first discretized into a finitedimensional system by using suitable approximation methods as finite element [Golo 04, Bassi 07,
Pasumarthy 12], geometric approaches [Seslija 12, Kotyczka 18], partitioned finite element
[Brugnoli 19a, Brugnoli 19b, Serhani 19], and finite difference [Trenchant 18]. Then, the synthesis of the OBSF controller is based on a discretized model (finite-dimensional system). Finally, the
OBSF controller is applied to the infinite-dimensional system, i.e. to the BC-PHS. The main advantage of using this approach is the high number of tools available in the literature for the synthesis
of the OBSF gains. These are, for instance, the linear quadratic regulator (LQR) [Anderson 07], the
pole-placement [Brasch 70], and the interconnection and damping assignment passivity based control
(IDA-PBC) [Prajna 02]. The main drawback when using the early-lumping approach is that since
the OBSF controller is designed on an approximated model and not on the BC-PHS, the closed-loop
stability is not guaranteed when applying the OBSF controller to the BC-PHS. The closed-loop
instability generated when applying an OBSF controller (finite-dimensional system) to a BC-PHS
(infinite-dimensional system) is known as spillover effect [Balas 78]. This closed-loop instability is
mainly due to the fact that some high-frequency modes, that are not considered during the design,
are destabilized by the OBSF controller. In this thesis, we design the OBSF controller such that it
is equivalent to the control by interconnection with a passive controller. In this way, the closed-loop
stability is guaranteed when the OBSF controller is applied to the BC-PHS. To satisfy this structure,
we propose two methodologies for the design of the OBSF gains.
In the late-lumping approach, the infinite-dimensional model is used for the design of the OBSF
controller. In this case, the observer is an infinite-dimensional system as in [Smyshlyaev 05],
[Hidayat 11, Meurer 13, Schaum 18], and for the implementation, the infinite-dimensional observer
has to be discretized by using suitable approximation methods like the ones mentioned before.
The main advantage of using this approach is that the infinite-dimensional structure is completely
used for analysis and control. This approach is increasingly used in applications such as the
wave equation [Guo 07, Krstic 08, Guo 09, Smyshlyaev 09, Meurer 11, Feng 16, Auriol 19] or the
diffusion-convection-reaction processes [Smyshlyaev 05, Meurer 09, Schaum 18], among others. The
main difficulty when using this approach is the generalization of the OBSF design for the class of
infinite-dimensional systems of interest. In this thesis, we propose a general setting for the design of
infinite-dimensional observers for impedance energy preserving BC-PHSs [Toledo 20, Malzer 20a].
We analyze different cases depending on the measured output. We cover the cases when the coenergy variables are measured and when the integral over time of them are. For mechanical systems,
these are the cases when velocities and displacements are measured, for instance. Finally, some
first steps towards the OBSF control design for BC-PHSs are presented using the vibrating string
as an example. In this case, we combine the energy shaping and damping injection techniques with
infinite-dimensional observers to stabilize the undamped vibrating string.

3



Chapter I. Context

I.2

Organization of the thesis

This thesis is composed of three main chapters. In Chapter II, a background on BC-PHSs
is provided. In Chapter III, we consider the early-lumping approach for the synthesis of OBSF
controllers. Finally, in Chapter IV, we consider the late-lumping approach for the design. We
summarize the content of each chapter as follows:
In Chapter II, we provide a background on BC-PHSs. We first introduce the class of systems
that we are interested in. This class is exemplified with some classic examples modelled as BC-PHSs.
Then, we recall the concepts of well-posedness, exact controllability and exact observability. We give
some results on the stabilization of BC-PHSs using static and dynamic output feedback. Finally,
we provide a motivation example, where we use observers for the practical implementation of the
control law that has been designed using energy shaping and damping injection.
In Chapter III, we use the early-lumping approach for the synthesis of OBSF controllers. Using
this approach, the BC-PHS is first discretized into a finite-dimensional model. Then, the observer
and controller gains are designed based on the finite-dimensional model. Since the discretized model
is a finite-dimensional system, one can use classical control tools for the design (LQR or pole placement, for example). However, using a counterexample, we show that the closed-loop stability is not
always guaranteed when the OBSF controller is applied to the infinite-dimensional system. To overcome this issue, we impose a passive structure on the OBSF controller. This structure can guarantee
closed-loop stability when applying the OBSF controller to the BC-PHS. We propose two methods
for the synthesis of the OBSF gains. In the first one, the state feedback gain is designed freely using
classical tools and the observer gain is designed such that the passive structure is guaranteed. In the
second one, the observer gain is designed freely and the state feedback gain is designed to achieve
the desired structure. Both methods are exemplified using the vibrating string and the Timoshenko
beam models. Finally, we extend this idea to a class of nonlinear finite-dimensional systems. In
this case, the nonlinear system is first linearized into an LTI system. Then, the same methods can
be used for the synthesis of the OBSF gains. In the same way as before, the passive structure
guarantees closed-loop stability when applying the OBSF controller to the nonlinear system.
In Chapter IV, we use the late-lumping approach for the synthesis of OBSF controllers. Using this
approach, the observer is an infinite-dimensional system and has to be discretized for implementation.
First, we propose infinite-dimensional observers that can estimate the state of the BC-PHS. We
analyze different cases depending on the available sensors, and we give the conditions to achieve
asymptotic or exponential convergence of the observer. The port-Hamiltonian formalism is used to
show the stability of the error system. Once again, the results are exemplified with the vibrating
string and the Timoshenko beam models. Then, we apply two OBSF control laws to the vibrating
string. First, we apply observer-based damping injection at both sides of the string in the case when
a force sensor is available at one side only and in the case when a displacement sensor is available
at one side only. Then, we use observer-based energy shaping and damping injection at one side of
the string in the case when a velocity sensor and a force actuator are available at the same side.
The thesis ends with some conclusions and perspectives.

4



I.3. Publications

I.3

Publications

The publications related to this thesis are the followings:
Toledo, J., Wu, Y., Ramirez, H., & Le Gorrec, Y. (2020). Observer-based boundary control of
distributed port-Hamiltonian systems. Automatica, 120, 109130.
doi.org/10.1016/j.automatica.2020.109130 (Draft)
Toledo, J., Ramirez, H., Wu, Y., & Le Gorrec, Y. (2020). Linear Matrix Inequality Design of
Observer-Based Controllers for port-Hamiltonian Systems. Submitted to IEEE Transactions on
Automatic Control.
arxiv.org/abs/2010.06314 (Draft)
Malzer, T., Toledo, J., Gorrec, Y. L., & Schöberl, M. (2020). Energy-based in-domain control
and observer design for infinite-dimensional port-Hamiltonian systems. In Proceedings of the 24th
International Symposium on Mathematical Theory of Networks and Systems, 24-28 August 2020,
Cambridge, UK.
arxiv.org/abs/2002.01717
Toledo, J., Wu, Y., Ramirez, H., & Le Gorrec, Y. (2019). Observer-Based State Feedback Controller
for a class of Distributed Parameter Systems. Paper presented at the 3rd IFAC Workshop on Control of Systems Governed by Partial Differential Equations CPDE 2019, 20–24 May 2019, Oaxaca,
Mexico.
doi.org/10.1016/j.ifacol.2019.08.020
Toledo, J., Ramirez, H., Wu, Y., & Le Gorrec, Y. (2019). Passive observers for distributed portHamiltonian systems. In Proceedings of the 21st IFAC World Congress, Berlin, Germany, July
12-17, 2020.
doi.org/10.1016/j.ifacol.2020.12.1356 (Draft)
Mattioni, A., Toledo, J., & Le Gorrec, Y. (2019). Observer Based Nonlinear Control of a Rotating
Flexible Beam. In Proceedings of the 21st IFAC World Congress, Berlin, Germany, July 12-17, 2020.
doi.org/10.1016/j.ifacol.2020.12.1306

5



Chapter I. Context

I.4

Main contributions

The main contribution of Chapter II is the background on BC-PHSs. Besides, in this chapter,
we present an example that shows the importance of using observers to implement state feedback
control laws like the ones derived using energy shaping and damping injection.
The main contribution of Chapter III is a design procedure of finite-dimensional OBSF controllers
(Proposition III.6.1 and Proposition III.7.1) for BC-PHSs. This procedure guarantees closed-loop
stability when applying the finite-dimensional OBSF controller to the BC-PHS (Theorem III.5.1).
The achieved closed-loop performances are close to the desired ones as soon as the discretized model
is close to the BC-PHS. Another contribution of this chapter is that the same design procedure
can be used to design OBSF controllers for a class of finite-dimensional nonlinear systems. We can
guarantee closed-loop stability when applying the linear OBSF controller to this class of systems
(Proposition III.8.3).
The main contribution of Chapter IV is the generalization of infinite-dimensional observer for
BC-PHSs. We cover a large number of cases depending on the type of available measurements. One
can use Proposition IV.3.1 when the full conjugated output is measured, Proposition IV.3.2 when
the conjugated output is partially measured, Proposition IV.3.3 when the conjugated output is not
measured but the integral over time of it is, or Proposition IV.3.4 when the conjugated output and
the integral over time of it are both measured. These are, for instance, the cases of measuring forces,
velocities and displacements in mechanical systems. Then, some first steps towards observer-based
damping injection and energy shaping are studied for the stabilization of the vibrating string. In
Proposition IV.4.1, the closed-loop system is shown to be exponentially stable when applying the
observer-based damping injection at both sides using a force sensor at one side only. In Proposition
IV.4.2, the closed-loop system is shown to be asymptotically stable when applying the observer-based
damping injection at both sides using a displacement sensor at one side only. Finally, in Section
IV.5, the closed-loop system is shown to be asymptotically stable when applying observer-based
energy shaping and damping injection to the vibrating string. In this case, we consider the vibrating
string attached at one side and with a force actuator and velocity sensor at the other side.

6



Chapter II
Background on boundary controlled
port-Hamiltonian systems

II.1

Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

8

II.2

Boundary controlled port-Hamiltonian systems . . . . . . . . . . . . . . . . . . . . . . . . . .

8

II.3

Examples of BC-PHSs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
II.3.1 The transmission line . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
II.3.2 The vibrating string . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
II.3.3 The Timoshenko beam . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

11
11
12
14

II.4

Controllability and observability of BC-PHSs . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16

II.5

Stabilization of BC-PHSs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
II.5.1 Static output feedback . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
II.5.2 Dynamic output feedback . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21

II.6

Motivation example: observer-based control . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
II.6.1 Control by interconnection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
II.6.2 Observer-based control: early-lumping approach . . . . . . . . . . . . . . . . . . . . . . . .
II.6.3 Observer-based control: late-lumping approach . . . . . . . . . . . . . . . . . . . . . . . . .

II.7

26
27
28
30

Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31

7



Chapter II. Background on boundary controlled port-Hamiltonian systems

II.1

Introduction

Boundary control systems (BCSs) [Fattorini 68, Curtain 12] is a class of control systems described
by partial differential equations (PDEs) with actuation and measurement situated at the boundaries
of the spatial domain. This class of systems is more and more encountered in engineering applications
and system control theory due to the recent progress in modelling and analysis of complex systems.
In many cases, the system of interest can be represented as a BCS. These are, for instance, the
cases of beams and waves in mechanical systems, heat bars and bed reactors in chemical systems,
or telegraph equations in electric systems.
Recently, the BCS formulation has been addressed by the port-Hamiltonian approach using
Stokes-Dirac structures [van der Schaft 02, Le Gorrec 05, Jacob 12] and jet bundles [Ennsbrunner 05,
Schöberl 14]. Port-Hamiltonian systems are an extension of the Hamiltonian formulation for mechanical systems to open multi-physical systems [Duindam 09]. This formalism has shown to be
suitable for modelling and control of complex physical systems, such as systems described by nonlinear equations or PDEs. For the latter, the formulation of boundary controlled port-Hamiltonian
systems (BC-PHSs) has shown to be very useful for the modelling, discretization, control and analysis [Rashad 20]. In this chapter, we present a background on BC-PHSs. We recall the concepts of
existence and uniqueness of solutions, exact controllability and stability for this class of systems.
First, we recall the parametrization of the boundary conditions proposed in [Le Gorrec 05], leading to a well-posed system, i.e. the BC-PHS has a solution, and it is unique. Then, we present
some classic examples of BC-PHSs. We recall the exact controllability property that every BCPHS satisfies when it is well-posed [Jacob 19]. Some stability results from [Villegas 07] are provided in the case when static output feedback is applied to the BC-PHS [Villegas 09] and in the
case when dynamic output feedback is [Villegas 05, Ramirez 14, Macchelli 18]. Finally, we use the
example of the vibrating string to motivate the use of observer-based state feedback (OBSF) control laws. We consider the vibrating string attached at one side and with a force actuator at the
other side. The objective is to apply a state feedback control law derived through energy shaping [Macchelli 05, Pasumarthy 07, Hamroun 10, Schöberl 12, Macchelli 17] and damping injection
[Macchelli 04b, Villegas 07]. Since the knowledge of the state is required, we use observers to estimate the state from a collocated velocity sensor only.
We organize the rest of this chapter as follows. In Section II.2, we recall the structure of the
considered BC-PHS. In Section II.3, we present three classical examples, the transmission line,
the vibrating string and the Timoshenko beam. In Section II.4 and Section II.5, we recall the
controllability and stabilizability results for BC-PHSs. Finally, in Section II.6, we give an example
to motivate the necessity of using observers.

II.2

Boundary controlled port-Hamiltonian systems

Boundary controlled port-Hamiltonian systems (BC-PHSs) are dynamical system described by
the following hyperbolic partial differential equation (PDE):
∂
∂x
(ζ, t) = P1 (H(ζ)x(ζ, t)) + P0 H(ζ)x(ζ, t),
∂t
∂ζ

8

x(ζ, 0) = x0 (ζ),

(II.1)



II.2. Boundary controlled port-Hamiltonian systems

where ζ ∈ [a, b] is the space variable and t ≥ 0 is the time variable. x(ζ, t) ∈ Rn is the state variable
and x0 (ζ) is the initial condition. P1 = P1T ∈ Mn (R) is a non-singular matrix, P0 = −P0T ∈ Mn (R),
and H(·) = H(ζ)T ∈ Mn (L2 ([a, b]; R)) is a bounded and continuously differentiable matrix-valued
function satisfying for all ζ ∈ [a, b] mI < H(ζ) < M I with 0 < m < M both scalars independent
on ζ. x(ζ, t) is called energy variable and H(ζ)x(ζ, t) is called co-energy variable. The Hamiltonian
related to the PDE (II.1) is given by
1Z b
x(ζ, t)T H(ζ)x(ζ, t)dζ.
H(t) =
2 a

(II.2)

Example II.2.1. [Jacob 12, Chapter 11] The transport equation is given by the following PDE:
∂w
∂w
(ζ, t) =
(ζ, t),
∂t
∂ζ

w(ζ, 0) = w0 (ζ),

(II.3)

and is written as in (II.1) with
x(ζ, t) = w(ζ, t), P1 = 1, H = 1, P0 = 0, x0 (ζ) = w0 (ζ),
and Hamiltonian

1Z b
x(ζ, t)2 dζ.
H(t) =
2 a

♣
The PDE (II.1) by itself does not describe a dynamical system and requires boundary conditions
to guarantee the existence and uniqueness of solutions. The boundary port variables are instrumental
for this and are defined as follows
Definition II.2.1. [Le Gorrec 05, Definition 3.5] Let H(ζ)x(ζ, t) ∈ H 1 ((a, b), Rn ). The boundary
port variables associated with (II.1) are the vectors f∂ (t) and e∂ (t) ∈ Rn , defined by
!

1 P1 −P1
f∂ (t)
=√
I
e∂ (t)
2 I

!

!

H(b)x(b, t)
.
H(a)x(a, t)

(II.4)

♣
The time derivative of the Hamiltonian is equivalent to the multiplication between the boundary
port variables. This is shown in the following theorem.
Theorem II.2.1. The balance equation of the Hamiltonian energy (II.2) related to the PDE (II.1)
is given by
Ḣ(t) = f∂ (t)T e∂ (t).
(II.5)
♦
Proof. In [Le Gorrec 05], the skew symmetry of the operator defined in (II.1) is used to express
the time derivative of the Hamiltonian with respect to the boundary conditions (using integration by
parts). These boundary conditions can be splitted using the formulation (II.4).

In [Le Gorrec 05], the authors proposed a parametrization of the boundary port variables for
defining inputs and outputs of BC-PHSs. In the following theorem, we recall the parametrization
of all possible boundary conditions such that the dynamic system defined by the PDE (II.1) is
well-posed (Definition II.4.1).

9



Chapter II. Background on boundary controlled port-Hamiltonian systems

Theorem II.2.2. [Le Gorrec 05, Theorem 4.1] Let WB ∈ Rn×2n be a full rank matrix. Define the
operator A with domain D(A) as
d
Ax = P1 (Hx) + P0 (Hx)
(II.6)
dζ
(

!

n

1

D(A) = x ∈ X | Hx ∈ H ([a, b]; R ), WB

)

f∂ (t)
=0 .
e∂ (t)

(II.7)

Then, A generates a contraction
semigroup on X = L2 ([a, b], Rn ) if and only if WB satisfies


♦ Now, we define the inputs and outputs of
WB ΣWBT ≥ 0 with Σ = 0Inn 0Inn .
the considered BC-PHS. Among all possible choices, we consider the input u(t) and the output y(t)
such that the system is an impedance energy preserving system [Staffans 05]. This class of system
are such that the energy balance is given by Ḣ(t) = u(t)T y(t). Then, inputs and outputs have a
physical interpretation. They can be, for instance, forces and velocities for mechanical systems and
voltages and currents for electrical ones.
Theorem II.2.3. [Le Gorrec 05, Theorem 4.2 and
Theorem 4.4] Let WB ∈ Rn×2n be a full rank

matrix such that WB ΣWBT ≥ 0 with Σ = 0Inn 0Inn . Define the input u(t) ∈ L2loc ((0, ∞), Rn ). The
PDE (II.1) with boundary conditions
!

WB

f∂ (t)
= u(t)
e∂ (t)

(II.8)

is a boundary control system. Furthermore, define the output as
!

f∂ (t)
,
e∂ (t)

y(t) = WC


(II.9)



B
with WC ∈ Rn×2n a full rank matrix such that W
is invertible. In addition, if WB ΣWBT =
WC
T
2
n
1
n
WC ΣWCT =0n and
 WC ΣWB = In , for all u(t) ∈ C ((0, ∞), R ), H(ζ)x(ζ, 0) ∈ H ((a, b); R ), and
f∂ (0)
u(0) = WB e∂ (0) , then the following balance equation of the Hamiltonian is satisfied

Ḣ(t) = u(t)T y(t).

(II.10)
♦

Remark II.2.1. Roughly speaking, Theorem II.2.3 says that if WB is a full rank and WB ΣWBT ≥ 0
is satisfied, we can impose some function u(t) at the spatial boundaries of the PDE (II.1), i.e. we
can do control.
♣
Finally, we define the class of boundary controlled port-Hamiltonian systems (BC-PHSs) of interest in this thesis. We consider these type of systems in Chapter III and Chapter IV for the OBSF
control design.
Definition II.2.2. A BC-PHS is defined as a system composed by the PDE (II.1), the input (II.8),
and the output (II.9) according to Theorem II.2.3. We also refer to a BC-PHS as in the following
compact form:

∂
∂x


(ζ, t) = P1 (H(ζ)x(ζ, t)) + P0 H(ζ)x(ζ, t), x(ζ, 0) = x0 (ζ),


 ∂t 
∂ζ

(II.11)
P W f∂ (t) = u(t),

 B e∂ (t)


y(t)

10

= WC



f∂ (t)
e∂ (t)



.

♣



II.3. Examples of BC-PHSs

Remark II.2.2. If the BC-PHS (II.11) satisfies the balance equation (II.10), then it is called an
impedance energy preserving BC-PHS [Staffans 05].
♣
Remark II.2.3. The BC-PHS (II.11) is the lossless form of a more general representation in where
the internal dissipation can be included replacing P0 by P0 − G0 , where G0 is a semi-positive definite
matrix.
♣
In the following, we present some classic examples of BC-PHSs.

II.3

Examples of BC-PHSs

We present three examples of dynamical systems that we can represent as BC-PHSs (II.11).
First, the transmission line used for modelling electric power transmissions [Duindam 09]. Then,
the string equation used for modelling water, sound and seismic waves [Villegas 07, Jacob 12]. And
finally, the Timoshenko beam used for modelling thick beams [Macchelli 04b].

II.3.1

The transmission line

In Figure II.1, we show a transmission line used for electrical power distribution. Due to the
extensions of the lines, we cannot neglect the spatial distribution. We can model, a lossless trans-

Figure II.1 – Electrical power distribution

mission line with the following PDEs:
∂Q
∂
(ζ, t) = −
∂t
∂ζ
∂φ
∂
(ζ, t) = −
∂t
∂ζ

!

φ(ζ, t)
(ζ, t) ,
L(ζ)
!
Q(ζ, t)
(ζ, t) ,
C(ζ)

Q(ζ, 0) = Q0 (ζ),

(II.12)

φ(ζ, 0) = φ0 (ζ),

(II.13)

11



Chapter II. Background on boundary controlled port-Hamiltonian systems

where ζ ∈ [a, b] and t ≥ 0 are the space and time variables, respectively. Q(ζ, t) is the electric charge
with initial condition Q0 (ζ), φ(ζ, t) is the magnetic flux with initial condition φ0 (ζ), C(ζ) is the
distributed capacity and L(ζ) is the distributed inductance. We can write the lossless transmission
line equations as in (II.11) with
!

!

Q(ζ, t)
Q0 (ζ)
x(ζ, t) =
, x0 (ζ) =
,
φ(ζ, t)
φ0 (ζ)
!

!

0 −1
0 0
P1 =
, P0 =
, H=
−1 0
0 0

1
C(ζ)

0

0

1
L(ζ)

!

.

The total energy is given by the sum of the electrical and magnetic one as follows:
"

#

1 Z b Q(ζ, t)2 φ(ζ, t)2
+
dζ.
H(t) =
2 a
C(ζ)
L(ζ)
We obtain the boundary port variables from (II.4) as:
φ(a, t) φ(b, t)
−

1 
L(b) 
 L(a)
f∂ (t) = √  Q(a, t) Q(b, t)  ,

2
−
C(a)
C(b)




Q(a, t) Q(b, t)
+

1 
C(b) 
 C(a)
e∂ (t) = √  φ(a, t) φ(b, t)  .

2
+
L(a)
L(b)




Then, we can choose the following inputs and outputs:
Q(a, t)


 C(a) 
 = u(t),

 Q(b, t) 
C(b)




φ(a, t)


L(a) 
y(t) = 

,
 −φ(b, t) 
L(b)




from the boundary port variables, satisfying the conditions of Theorem II.2.3 with
!

1 0 1 1 0
WB = √
,
2 0 −1 1 0

!

1 1 0 0 1
WC = √
,
2 1 0 0 −1

!

0 I
Σ= 2 2 .
I2 02

Note that, the variables Q(·,t)
and φ(·,t)
are respectively the voltage and the current. In this example,
C(·)
L(·)
we impose the voltage in both boundaries of the transmission line and we measure the currents at
both sides.

II.3.2

The vibrating string

In Figure II.2, we show the deformations of the strings of a guitar. We can model these deformations using the one-dimensional wave equation. We can model a single string with the following
PDE:
!
!
!
∂ 2w
1 ∂
∂w
w(ζ, 0)
w0 (ζ)
T (ζ) (ζ, t) ,
(ζ, t) =
=
,
(II.14)
∂w
v0 (ζ)
(ζ, 0)
∂t2
ρ(ζ) ∂ζ
∂ζ
∂t

12



II.3. Examples of BC-PHSs

Figure II.2 – Vibrating strings in a guitar

where ζ ∈ [a, b] and t ≥ 0 are the space and time variable, respectively. w(ζ, t) is the vertical
position of the string with initial position and velocity given by w0 (ζ) and v0 (ζ), respectively. T (ζ)
is the Young’s modulus and ρ(ζ) is the mass density of the string. Note that, if the mass density
and Young’s modulus are constant, the PDE becomes
2
∂ 2w
2∂ w
(ζ,
t)
=
c
(ζ, t),
∂t2
∂ζ 2

c2 =

T
.
ρ

(II.15)

We define as state variables the strain q(ζ, t) = ∂w
(ζ, t) and the momentum distribution p(ζ, t) =
∂ζ
dw0
∂w
ρ(ζ) ∂t (ζ, t), with initial conditions q0 (ζ) = dζ (ζ) and p0 (ζ) = ρ(ζ)v0 (ζ), respectively. Then, we
can represent the vibrating string as in (II.11) with
!

!

q(ζ, t)
q (ζ)
x(ζ, t) =
, x0 (ζ) = 0
,
p(ζ, t)
p0 (ζ)
!

!

T (ζ)
0 1
0 0
, P0 =
, H=
P1 =
0
1 0
0 0

0
1
ρ(ζ)

!

.

The total energy is given by the sum of the kinetic and potential ones as follows:
"

#

1
1Z b
T (ζ)q(ζ, t)2 +
p(ζ, t)2 dζ.
H(t) =
2 a
ρ(ζ)
The boundary port variables are obtained from (II.4) as follows




p(b, t) p(a, t)
1 
−

f∂ (t) = √ 
,
ρ(b)
ρ(a)
2 T (b)q(b, t) − T (a)q(a, t)





T (b)q(b, t) + T (a)q(a, t)
1 

p(b, t) p(a, t)
e∂ (t) = √ 
.
+
2
ρ(b)
ρ(a)

13



Chapter II. Background on boundary controlled port-Hamiltonian systems

Then, the following input and output can be chosen as




p(a, t)



ρ(a)  = u(t),
T (b)q(b, t)





−T (a)q(a, t)


y(t) =  p(b, t) 
ρ(b)

satisfying the conditions of Theorem II.2.3 with
!

!

1 0 1 −1 0
WC = √
,
2 1 0 0 1

1 −1 0 0 1
,
WB = √
2 0 1 1 0

!

0 I
Σ= 2 2 .
I2 02

Note that, the variables T (·)q(·, t) and p(·,t)
are respectively the force and the velocity. Here, we can
ρ(·)
for example act with a force actuator at the right side and clamp the string on the left side. The
conjugated outputs are the force at the left side and the velocity at the right side.

II.3.3

The Timoshenko beam

We can use the Timoshenko beam to model the deformation of thick beams. We can use this,
for instance, to model the solar panel deformation of a satellite, as shown in Figure II.3. We can

Figure II.3 – Satellite
represent the Timoshenko beam model with the following PDEs:
∂ 2w
ρ(ζ) 2 (ζ, t) =
∂t
∂ 2φ
Iρ (ζ) 2 (ζ, t) =
∂t
!

∂
∂ζ
∂
∂ζ

!!

∂w
K(ζ)
(ζ, t) − φ(ζ, t)
∂ζ
!
!
∂φ
∂w
EI(ζ) (ζ, t) + K(ζ)
(ζ, t) − φ(ζ, t)
∂ζ
∂ζ
!

w(ζ, 0)
w0 (ζ)
=
,
∂w
v0 (ζ)
(ζ, 0)
∂t

14

!

(II.16)
(II.17)

!

φ(ζ, 0)
φ0 (ζ)
=
,
∂φ
ω0 (ζ)
(ζ, 0)
∂t

(II.18)



II.3. Examples of BC-PHSs

where ζ ∈ [a, b] and t ≥ 0 are the space and time, respectively. w(ζ, t) is the transverse displacement
of the beam with initial displacement and velocity given by w0 (ζ) and v0 (ζ), respectively. φ(ζ, t) is
the rotation angle of a filament of the beam with initial rotation angle and angular velocity given
by φ0 (ζ) and ω0 (ζ), respectively. K(ζ), ρ(ζ), EI(ζ) and Iρ (ζ) are respectively the shear modulus,
the mass density, the Young’s modulus of elasticity multiplied by the moment of inertia of a cross
section and the rotary moment of inertia of a cross section. We define as state variables the shear
displacement x1 (ζ, t), the momentum x2 (ζ, t), the angular displacement x3 (ζ, t) and the angular
momentum x4 (ζ, t) as follows:
∂w
(ζ, t) − φ(ζ, t),
∂ζ
∂w
x2 (ζ, t) = ρ(ζ) (ζ, t),
∂t
∂φ
(ζ, t),
x3 (ζ, t) =
∂ζ
∂φ
x4 (ζ, t) = Iρ (ζ) (ζ, t),
∂t
x1 (ζ, t) =

x1 (ζ, 0) = x10 (ζ),
x2 (ζ, 0) = x20 (ζ),
x3 (ζ, 0) = x30 (ζ),
x4 (ζ, 0) = x40 (ζ),

0
with x10 (ζ) = dw
(ζ) − φ0 (ζ), x20 (ζ) = ρ(ζ)v0 (ζ), x30 (ζ) =
dζ
we can represent the Timoshenko beam as in (II.11) with

dφ0
(ζ)
dζ

and x40 (ζ) = Iρ (ζ)ω0 (ζ). Then,

x1 (ζ, t)
x10 (ζ)
x (ζ, t)
x (ζ)


 20

x(ζ, t) =  2
 , x0 (ζ) = 
,
x3 (ζ, t)
x30 (ζ)
x4 (ζ, t)
x40 (ζ)


0
1

P1 = 
0
0

1
0
0
0



0
0
0
1

0
0
0
0


 , P0 = 
0
1
0
1






0
0
0
0






K(ζ)
0 −1


 0
0 0
, H = 
 0
0 0

0
0 0



0
1
ρ(ζ)

0
0

0
0
EI(ζ)
0

0
0
0
1
Iρ (ζ)




.



The total energy is given by the sum of the kinetic and the potential ones as follows:
"

#

1Z b
1
1 2
H(t) =
K(ζ)x1 (ζ, t)2 +
x2 (ζ, t)2 + EI(ζ)x3 (ζ, t)2 +
x (ζ, t) dζ.
2 a
ρ(ζ)
Iρ (ζ) 4
We obtain the boundary port variables from (II.4) as follows:
x2 (b, t) x2 (a, t)
K(b)x1 (b, t) + K(a)x1 (a, t)
−




x2 (b, t) x2 (a, t)
ρ(b)
ρ(a)




+




1  K(b)x1 (b, t) − K(a)x1 (a, t) 
1 

ρ(b)
ρ(a)
√
f∂ (t) = √ 
,
e
(t)
=

.

x4 (b, t) x4 (a, t)
 ∂
EI(b)x3 (b, t) + EI(a)x3 (a, t)
2
2




−




x4 (b, t) x4 (a, t)
Iρ (b)
Iρ (a)
+
EI(b)x3 (b, t) − EI(a)x3 (a, t)
Iρ (b)
Iρ (a)








15



Chapter II. Background on boundary controlled port-Hamiltonian systems

Then, we can choose the following inputs and outputs:
x2 (a, t)




ρ(a)


 x4 (a, t) 

 = u(t),


Iρ (a)




 K(b)x1 (b, t) 
EI(b)x3 (b, t)








−K(a)x1 (a, t)


−EI(a)x3 (a, t)




x2 (b, t)

,
y(t) = 

ρ(b)




x4 (b, t)


Iρ (b)

satisfying the conditions of Theorem II.2.3 with
−1

1 0
WB = √ 
2 0
0


0 0 0 0
0 −1 0 0
1 0 0 1
0 0 1 0

1
0
0
0

0
0
0
1

0
0 1


1 0 0
1
 , WC = √ 

0
2 1 0
0
0 0




0
0
0
1

0 −1 0 0 0
1 0 0 −1 0

,
0 0 1 0 0
0 0 0 0 1


!

0 I
Σ= 4 4 .
I4 04
(·,t)
Note that, the variables K(·)x1 (·, t), x2ρ(·)
, EI(·)x3 (·, t), xI4ρ(·,t)
are respectively the force, the velocity,
(·)
the torque and the angular velocity. Here, we can for example act with a force and torque actuator
at the right side and clamp the beam on the left side. The outputs are the force and torque at the
left side and the transverse and angular velocity at the right side.

II.4

Controllability and observability of BC-PHSs

In control systems theory, the following two questions arise concerning the choice of the inputs
and outputs:
(i) Is the input sufficient to move the state of the system to a desired one?
(ii) Is the output enough to describe the whole state of the system?
Controllability and observability are the properties of a control system that answer these questions. For linear lumped parameter systems (LPSs), these properties are guaranteed by checking
a matrix condition [Kalman 69]. However, for linear distributed parameter systems (DPSs), it is
not the case, and in general, it has to be analyzed on a case by case basis. See for example
[Gugat 05, Zuazua 93] dealing with the one-dimensional wave equation. Concerning the BC-PHS
(II.11), the questions become
(i) Is the input u(t) sufficient to move the state x(ζ, t) to a desired state in the space X =
L2 ([a, b], Rn )?
(ii) Is the knowledge of y(t) enough to describe all the state x(ζ, t)?
Recently, it has been shown that BC-PHSs are exactly controllable when they are well-posed
[Jacob 19]. Similarly, BC-PHSs are exactly observable when they are well-posed. The well-posedness
of a system is related to the existence and uniqueness of solutions of a system for some initial
conditions. In the following, we define the well-posedness. Then, we show that the BC-PHS (II.11)
is well-posed. Then, we define exact controllability. Finally, we recall the main theorem from
[Jacob 19] which states that the BC-PHS (II.11) is exactly controllable.

16



II.5. Stabilization of BC-PHSs

Definition II.4.1. [Jacob 19, Definition 2] The BC-PHS (II.11) is well-posed if there exist a τ > 0
and mτ ≥ 0 such that for all x0 ∈ D(A) and u ∈ C 2 ([0, τ ]; Rn ) with u(0) = Bx0 , the classical
solution x (Definition A.4.2) and the output y satisfiy
kx(τ )k2X

+

Z τ
0

2

ky(t)k dt ≤ mτ



kx0 k2X

+

Z τ

2



ku(t)k dt .

(II.19)

0

♣
As it has been mentioned in [Jacob 19], the well-posedness of a system is in general difficult to
show for BCSs. See for example [Staffans 05] and [Tucsnak 14]. However, for BC-PHSs of the form
(II.11), we can show it by a matrix condition as we show in the following theorem and remark.
Theorem II.4.1. [Jacob 12, Theorem 13.2.2] The port-Hamiltonian system (II.11) is well-posed if
and only if the operator
!
d
(II.20)
Ax = P1 + P0 (Hx), x ∈ D(A)
dζ
with domain
n

D(A) = x ∈ X, Hx ∈ H 1 ([a, b]; Rn ) | WB



f∂ (t)
e∂ (t)

generates a strongly continuous semigroup on X (Definition A.4.4).



o

=0

(II.21)
♦

Remark II.4.1. Note that, from Theorem II.2.2, if WB ΣWBT ≥ 0, then the operator (II.20) with
domain (II.21) generates a contraction semigroup on X. Thus, (II.11) is well-posed
♣
Since the BC-PHS of interest is well-posed, we can show that it is exactly controllable also. To
this end, we define the exact controllability and we recall the main result of [Jacob 19].
Definition II.4.2. [Jacob 19, Definition 6] The well-posed port-Hamiltonian system (II.11) is exactly controllable, if there exists a time τ > 0 such that for all x1 ∈ X there exists a control function
u(t) ∈ L2 ([0, τ ], Rn ) such that the corresponding mild solution (Definition A.4.3) satisfies x(0) = 0
and x(τ ) = x1 .
♣
Theorem II.4.2. [Jacob 19] Every well-posed port-Hamiltonian system (II.11) is exactly controllable.
♦
Similarly, as it is mentioned in [Jacob 19], by duality the BC-PHS (II.11) is also exactly observable.
Remark II.4.2. Basically, in the fully actuated and fully sensed case, Theorem II.4.2 and its dual
allow us to design controllers for achieving all possibles states on the space X and also, to design
observers to reconstruct the state variables from the measurement of the output.
♣

II.5

Stabilization of BC-PHSs

In [Villegas 07], the stabilization of BC-PHSs is studied. It is shown that by static or dynamic
output feedback, the BC-PHS can be stabilized asymptotically or exponentially. When static output
feedback is applied to the BC-PHS, exponential stability is achieved in closed-loop even when partial
output feedback is applied [Villegas 09]. When dynamic output feedback is applied to the BC-PHS,
asymptotic stability is achieved if the dynamical controller is strictly positive real (SPR) [Villegas 05].

17



Chapter II. Background on boundary controlled port-Hamiltonian systems

This result is extended in [Ramirez 14], where the authors have shown that if the controller is
a strictly inputs passive system, the closed-loop system is exponentially stable. In [Augner 14],
the closed-loop stability is studied for a more general class of BC-PHSs that includes the EulerBernoulli beam, for example. Finally, in [Macchelli 13, Macchelli 17, Macchelli 20], the authors
have studied the energy shaping and damping injection techniques. The resulting control laws using
these strategies correspond, in general, to a state feedback control law. To implement these control
laws, we require observers for the state variable estimation.
In the following, we recall the main stability results for BC-PHSs in closed-loop. We start with
an important property, which states that the Hamiltonian of a BC-PHS is always bounded by the
time integral of the co-energy variable evaluated at the spatial boundaries. Then, this result is used
for showing the closed-loop stability when a controller is applied to the system.
Theorem II.5.1. [Villegas 07, Theorem 5.17] Consider the BC-PHS (II.11) with WB such that
WB ΣWBT ≥ 0. If u(t) = 0, for all t ≥ 0, then the Hamiltonian energy H(t) = 12 kx(t)k2H satisfies for
τ large enough
H(τ ) ≤ c(τ )

Z τ
0

H(τ ) ≤ c(τ )

Z τ
0

kH(b)x(b, t)k2R dt,

and
(II.22)

kH(a)x(a, t)k2R dt

where c(τ ) is a constant that only depends on τ .

II.5.1

♦

Static output feedback

The static output feedback for the BC-PHS (II.11) is represented as shown in Figure II.4 and is
defined as follows:
u(t) = r(t) − αy(t),
(II.23)
with α ∈ Rn×n such that α > 0 and r(t) an external input. Since we consider the BC-PHS (II.11)
r(t)

u(t)

P

y(t)
r(t)

α

Pα

y(t)

Figure II.5 – Equivalent representation of the
static output feedback

Figure II.4 – Static output feedback
as an impedance energy preserving system (WB ΣWBT = WC ΣWCT = 0n and WC ΣWBT = In ), the time
derivative of the Hamiltonian is given by
Ḣ(t) = u(t)T y(t)
= r(t)T y(t) − y(t)T αy(t).

18

(II.24)



II.5. Stabilization of BC-PHSs

Then, the closed-loop system can be represented as a BC-PHS as well, but not anymore as an
impedance energy preserving system. The closed-loop system is equivalently represented, as shown
in Figure II.5 with the new input r(t). The closed-loop system is written as the following BC-PHS:

∂
∂x


(ζ, t) = P1 (H(ζ)x(ζ, t)) + P0 H(ζ)x(ζ, t),


 ∂t 
∂ζ

Pα W f∂ (t) = r(t),
Wα = WB + αWC ,

α e∂ (t)





f∂ (t)
y(t) = W
.
C

x(ζ, 0) = x0 (ζ),
(II.25)

e∂ (t)

Theorem II.5.2. [Villegas 07, Theorem 5.17] The closed-loop system between the impedance energy
preserving BC-PHS (II.11) and the static output feedback (II.23) is exponentially stable if α > 0 and
r(t) = 0.
♦
Proof. The reader is refer to [Villegas 07, Theorem 5.17] for the proof. However, since it is important for the following sections, we develop it in here.The proof is equivalent to show that the system
(II.25) is exponentially stable. Note that the closed-loop system (II.25) is a BC-PHS as well. In fact,
one can verify Wα ΣWαT = αT + α > 0. Then, the system (II.25) satisfies the conditions of Theorem
II.5.1 with respect to the new input r(t) and the new input matrix Wα . Then, the Hamiltonian satisfies the estimations (II.22). Using one of these estimations, one can show the exponential stability
by showing that the Hamiltonian is such that
H(τ ) ≤

c(τ )
H(0)
c(τ ) + α1 m1

(II.26)

for some positive constants c(τ ), α1 , m1 , and τ large enough. To find the estimation (II.26), we
write the new input r(t) and the output y(t) as follows
!

1 Wα
r(t)
=√
y(t)
2 WC

!

P1 −P1
In In

!

!

H(b)x(b, t)
.
H(a)x(a, t)

(II.27)

We define the matrix
1 Wα
M=√
2 WC
The matrix Rext =

√1
2



P1 −P1
In In

is also invertible. Indeed


0n In
In 0n





Wα
WC





!

!

P1 −P1
.
In In

(II.28)

is invertible (See [Le Gorrec 05, Lemma 3.4]). The matrix


is invertible if and only if

Wα ΣWαT Wα ΣWCT
WC ΣWαT WC ΣWCT



Wα
WC





is invertible with Σ =

(See [Le Gorrec 05, Theorem 4.2]). Then, one can compute
Wα ΣWαT Wα ΣWCT
WC ΣWαT WC ΣWCT


0

!

!

αT + α In
=
,
In
0n

(II.29)



I

which has an inverse and it is Inn −(αTn+α) . Then, the matrix M in (II.28) is invertible as well.
This implies that kM wk2R ≥ m1 kwk2R , for some vector w of appropriated dimension and a constant
m1 that can be the smallest eigenvalue of M , for instance. If we compute the norm at both sides of
(II.27) with r(t) = 0 (by definition), we obtain the following
!

ky(t)k2R

H(b)x(b, t)
= M
H(a)x(a, t)

!

2

≥ m1
R

H(b)x(b, t)
H(a)x(a, t)

2

≥ m1 kH(b)x(b, t)k2R ,

R

19



Chapter II. Background on boundary controlled port-Hamiltonian systems

implying that the norm of the co-energy variables evaluated at the spatial boundaries are bounded by
the norm of the output as follows
kH(b)x(b, t)k2R ≤

1
ky(t)k2R
m1

(II.30)

(similar for kH(b)x(a, t)k2R ). Moreover, since α is positive definite, the norm of the output can be
also bounded as follows
1
ky(t)k2R ≤ y(t)T αy(t),
(II.31)
α1
with α1 a positive scalar that can be for instance the smallest eigenvalue of α. Then, from (II.30)
and (II.31), one can conclude
kH(b)x(b, t)k2R ≤

1
y(t)T αy(t).
m1 α1

(II.32)

Since the closed-loop system (II.25) is a BC-PHS and satisfies the conditions of Theorem II.5.1 with
respect to the new input r(t) and new input matrix Wα , we can use the estimations (II.22). Then,
using (II.22) and (II.32) we obtain the following estimation for the Hamiltonian
c(τ ) Z τ
y(t)T αy(t)dt.
H(τ ) ≤
m1 α1 0

(II.33)

Finally, from (II.24) we obtain
H(τ ) − H(0) = −

Z τ

y(t)T αy(t)dt,

(II.34)

0

with r(t) = 0 (by definition). Replacing (II.34) into the estimation (II.33), we obtain the estimation
(II.26), concluding the exponential stability of the closed-loop system.

Note that the last theorem corresponds to the case of a fully actuated and fully sensed scenario,
i.e. when n actuators and n sensors are available. This is not always possible, either due to the lack
of actuators or the lack of sensors. However, one can also achieve closed-loop exponential stability by
partially output feedback if an additional condition is satisfied, as we state in the following corollary.
In this case, the static output feedback for the BC-PHS (II.11) is defined as follows:
u(t) = r(t) − βy(t),

(II.35)

with β ∈ Rn×n such that β ≥ 0 and r(t) an external input. Similarly as before, the closed-loop
system is written as follows

∂x
∂


(ζ, t) = P1 (H(ζ)x(ζ, t)) + P0 H(ζ)x(ζ, t),


 ∂t 
∂ζ

Pβ W f∂ (t) = r(t),
Wβ = WB + αWC ,
 β e∂ (t) 



f∂ (t)
y(t) = W
.
C

20

e∂ (t)

x(ζ, 0) = x0 (ζ),
(II.36)



II.5. Stabilization of BC-PHSs

Corollary II.5.1. [Villegas 07, Corollary 5.19]. The closed-loop system between the impedance
energy preserving BC-PHS (II.11) and the static output feedback (II.35) is exponentially stable if
β ≥ 0, r(t) = 0, and one of the following conditions is satisfied
kHx(b, t)k2R ≤ k1 y(t)T βy(t) or
kHx(a, t)k2R ≤ k1 y(t)T βy(t)
for some positive constant k1 .

(II.37)
♦

Proof. The proof is equivalent to show that the system (II.36) is exponentially stable. One can
show that the closed-loop system (II.36) is again a BC-PHS and satisfies the conditions in Theorem
II.5.1 with respect to the new input r(t) and the new input matrix Wβ . Indeed, one can verify
Wβ ΣWβT = β T + β ≥ 0. Then, the closed-loop system (II.36) satisfies the estimations (II.5.1).
Then, using (II.5.1) and (II.37), the following estimation is satisfied
H(τ ) ≤ c(τ )k1

Z τ

y(t)T βy(t)dt

(II.38)

0

Finally, from (II.24) we obtain
H(τ ) − H(0) = −

Z τ

y(t)T βy(t)dt,

(II.39)

0

with r(t) = 0 (by definition). Replacing (II.39) into the estimation (II.38), we obtain the estimation
H(τ ) ≤

c(τ )
H(0).
c(τ ) + k1−1

(II.40)

This concludes the proof.

When applying damping injection (static output feedback), the achievable closed-loop performances are limited to the change of the damping ratio, only. If other performances are required in
closed-loop (modifying the settling time, for instance), dynamic output feedback has to be considered. In the following section, we present the case when the controller is a dynamic system, and the
control law depends on the state variables of the controller. With this type of controller, one can
use the energy shaping control strategy, for instance.

II.5.2

Dynamic output feedback

The dynamic output feedback is represented in Figure II.6, where P is the BC-PHS (II.11), and
C is the finite-dimensional controller in a port-Hamiltonian form. u(t) and y(t) are respectively the
input and output of the BC-PHS, and uc (t) and yc (t) are respectively the input and output of the
controller. r(t) is an external input, and the passive interconnection is given by
!

!

0 −1
u(t)
=
uc (t)
1 0

!

!

y(t)
1
+
r(t).
yc (t)
0

(II.41)

21



Chapter II. Background on boundary controlled port-Hamiltonian systems

r(t)

u(t)

P

yc (t)

C

y(t)

uc (t)

Figure II.6 – Dynamic output feedback

The finite-dimensional controller C is defined as follows:
C


ẋ

c (t)

yc (t)

= Ac xc (t) + Bc uc (t)
= Cc xc (t) + Dc uc (t),

(II.42)

where xc ∈ Rnc , uc ∈ Rmc , yc ∈ Rmc are the state, input, and output, respectively. Ac ∈ Rnc ×nc , Bc ∈
Rnc ×mc , Cc ∈ Rmc ×nc and Dc ∈ Rmc ×mc are all matrices to be designed, such that Ac = (Jc − Rc )Qc ,
Bc = Gc − Pc , Cc = (Gc + Pc )> Qc and Dc = Mc + Sc , where Jc = −Jc> , Rc = Rc> , Mc = −Mc> and
Sc = Sc> , satisfying
!
Rc Pc
≥ 0 and Qc = Q>
c > 0.
Pc> Sc
Furthermore, we assume for the system (II.42) that (Ac , Bc ) is controllable and (Ac , Cc ) is observable.
The Hamiltonian of the controller is given by
1
Hc (t) = xc (t)T Qc xc (t),
2

(II.43)

and the closed-loop Hamiltonian related to the closed-loop system represented in Figure II.6 is given
by
1Z b
1
x(ζ, t)T H(ζ)x(ζ, t)dζ + xc (t)T Qc xc (t).
(II.44)
V (t) =
2 a
2
If we impose some conditions on the dynamic controller, we can guarantee the closed-loop stability between the BC-PHS (II.11) and the dynamic controller (II.42) (represented in Figure II.6). In
[Morgül 94, Morgul 98, Morgül 02, Yang 05] the authors use positive real (PR) and strictly positive
real (SPR) controllers to stabilize the one-dimensional wave equation. This idea is extended and
generalized for BC-PHSs in [Villegas 07, Ramirez 14]. In the following, we recall these results. To
this end, the definitions of positive real, and strictly positive real systems are presented (Definition
(II.5.1) and Definition (II.5.2)). The equivalent state-space representation of SPR systems is presented in Lemma II.5.1. Finally, a particular case of finite-dimensional port-Hamiltonian systems is
presented as an SPR system (Corollary II.5.2).
Definition II.5.1. A n × n matrix G(s) of real rational functions is positive real (PR) if:
1. All elements of G(s) are analytic in the open right-half plane Re(s) > 0.
2. Poles of any element of G(s) on the jw-axis are distinct, and the associated residue matrix of
G(s) is ≥ 0.

22



II.5. Stabilization of BC-PHSs

3. G(jw) + GT (−jw) ≥ 0 for all w which are not a pole of any element of G(jw).
♣
Definition II.5.2. A n × n matrix G(s) of real rational functions is strictly positive real (SPR) if
there exists a scalar ε > 0 such that G(s − ε) is PR.
♣
Example II.5.1. The following scalar transfer function G(s) = 1s . G(s) has all its coefficients
positives, it has a single pole at s = 0 with residue 1, and G(jw) + GT (−jw) = 0 for all w 6= 0.
However, G(s) is not SPR, since G(s − ε) is not PR due to the first and third condition of Definition
II.5.1.
♣
Lemma II.5.1. (Kalman-Yakubovich-Popov KYP-Lemma) Assume for the system (II.42) that (Ac , Bc )
is controllable and (Ac , Cc ) is observable. Then, the transfer matrix G(s) = Cc (sI − Ac )−1 Bc + Dc
is SPR if and only if there exist real matrices P = P T > 0, Γ, W and a scalar ε > 0 such that
P Ac + ATc P = −ΓT Γ − εP
Cc − BcT P
Dc + DcT

(II.45a)

T

(II.45b)

T

(II.45c)

=W Γ
=W W

♦
Corollary II.5.2. The system (II.42) with Ac = (Jc − Rc )Qc , Cc = BcT Qc and Dc = 0 is strictly
♦
positive real if Jc = −JcT , Rc = RcT > 0 and Qc = QTc > 0.
Proof. From Lemma II.5.1 choose P = Qc and W = 0, then (II.45c) is trivial, (II.45b) is Cc =
BcT Qc and (II.45a) becomes
ΓT Γ = 2Qc Rc Qc − εQc
(II.46)
then, for Rc > 0 there exists a constant ε > 0 such that the right hand side is positive definite, giving a
solution for Γ, using for instance Cholesky factorization. See for example [Horn 12, Corollary 7.2.9].

From Corollary II.5.2, one can show that the finite-dimensional port-Hamiltonian system (II.42)
is SPR if Dc = 0 and Rc > 0. In the following theorem, the asymptotic stability is guaranteed when
an SPR finite-dimensional controller is applied to the BC-PHS in a power preserving way.
Theorem II.5.3. [Villegas 07, Chapter 5.1.2] Consider the impedance energy preserving BC-PHS
(II.11) with WB and WC defined according to Theorem II.2.3. Consider the finite-dimensional controller (II.42) such its transfer matrix is SPR (Lemma II.5.1). Then, the closed-loop system between
(II.11) and (II.42) using the interconnection (II.41) is well-posed and converges asymptotically to
zero for r(t) = 0.
♦
Proof. The reader is refer to [Villegas 07, Theorem 5.8] for the well-posedness of the closed-loop
system, to [Villegas 07, Theorem 5.9] for the precompactness of the solution trajectories of the closedloop system, and to [Villegas 07, Theorem 5.10] for the asymptotic stability of the closed-loop. 
A particular case of Theorem II.5.3 is when the dynamic controller (II.42) is defines as in Corollary
II.5.2. Then, we can write the following Corollary from Theorem II.5.3.

23



Chapter II. Background on boundary controlled port-Hamiltonian systems

Corollary II.5.3. Consider the impedance energy preserving BC-PHS (II.11) with WB and WC
defined according to Theorem II.2.3. Consider the finite-dimensional controller (II.42) with Ac =
(Jc − Rc )Qc , Cc = BcT Qc , Dc = 0, Jc = −JcT , Rc = RcT > 0 and Qc = QTc > 0. Assume that (Ac , Bc )
is controllable and (Ac , Cc ) is observable. The closed-loop system between (II.11) and (II.42) using
the interconnection (II.41) is well-posed and converges asymptotically to zero for r(t) = 0.
♦
Proof. In this case, the controller is an SPR system as well as in Theorem II.5.3 (see Corollary
II.5.2 to verify the conditions). Then, for the well-posedness of the closed-loop system, this is an
application case of [Villegas 07, Theorem 5.8]. For the precompactness of the solution trajectories
of the closed-loop system, this is an application case of [Villegas 07, Theorem 5.9]. Then, for the
asymptotic stability, we use LaSalle’s invariance principle provided that the closed-loop is well-posed
and the solution trajectories are precompact (See [Luo 12, Theorem 3.64]). It follows that all solutions of the closed-loop system tend to the maximal invariant set of
ϑc = {x ∈ L2 ([a, b], Rn ), xc ∈ Rnc | V̇ (t) = 0}.

(II.47)

We define the maximal invariant subset of ϑc as I, and we show that I only contains the zero state,
i.e. I = {x(ζ, t) = 0, xc (t) = 0}. From (II.44), (II.11), and (II.42), we obtain the following balance
equation
V̇ (t) = −xc (t)T Qc Rc Qc xc (t).
(II.48)
Since Rc > 0, V̇ (t) = 0 implies xc (t) = 0, which implies ẋc (t) = 0. Then, from (II.42) Bc uc (t) = 0.
Since the controller is controllable, uc (t) = 0. Since Dc = 0 and xc (t) = 0, from (II.42) yc (t) =
0. Since uc (t) = yc (t) = 0, from the interconnection we can conclude (II.41) y(t) = u(t) = 0.
Then, since the invariant solution of the closed-loop system, subject to V̇ (t) = 0, corresponds to the
solution of the PDE with all the boundary variables set to zero, hence from Holmgren’s Theorem (See
[John 49]) the only solution is x(ζ, t) = 0. Thus, the asymptotic stability of the closed-loop system
is guaranteed.

Achieving exponential stability when interconnecting the BC-PHS (II.11) with the finite-dimensional
controller (II.42) as Figure II.6 shows, requires and additional conditions on the controller. The controller has to be strictly input passive [Ramirez 14], i.e. Dc > 0.
Theorem II.5.4. [Ramirez 14, Theorem IV.2] Consider the BC-PHS (II.11), the controller (II.42),
and the interconnection (II.41) with r(t) = 0, for all t ≥ 0. The closed-loop is exponentially stable
if Ac is Hurwitz, Dc is positive definite and one of the following conditions is satisfied
ku(t)k2 + ky(t)k2 ≥ kH(b)x(b, t)k2 ,
ku(t)k2 + ky(t)k2 ≥ kH(a)x(a, t)k2 .

or

(II.49)

♦
Assigning performances to the closed-loop system is in general achieved using damping injection and energy shaping [Macchelli 04a, Pasumarthy 07, Macchelli 11, Schöberl 12, Macchelli 13,
Macchelli 17, Malzer 19]. Damping injection (static output feedback) allows ensuring the closed-loop
stability, while energy shaping allows assigning performances in terms of the closed-loop energy. The
energy shaping control strategy is achieved by relating the state of the controller to the state of the
system. Then, the closed-loop energy (II.44) can be shaped by choosing Qc . This is usually achieved
by using structural invariants or Casimir functions [Schöberl 12, Macchelli 17, Macchelli 20]. Since

24



II.5. Stabilization of BC-PHSs

the state of the controller is related to the state of the plant, the control law can be applied either by
state feedback u(t) = β(x(·, t)) or by control by interconnection (u(t) = −yc (t)) between the BC-PHS
(II.11) and the dynamic controller (II.42) through (II.41). For the state feedback, knowledge of the
state of the system is required. For the control by interconnection technique, proper initialization of
the dynamic controller is required.
In this thesis, we use observers for applying the state feedback control law without requiring the
knowledge of the complete state of the plant, neither a proper initialization of the controller. In
the following section, a motivational example is presented using the vibrating string example, where
some desired control law (derived by energy shaping and damping injection) is implemented using
observers. We illustrate the effect of improper initialization when applying the desired control law
using a dynamic controller. Then, an alternative observer-based control strategy is proposed using
both early and late-lumping approaches.

25



Chapter II. Background on boundary controlled port-Hamiltonian systems

II.6

Motivation example: observer-based control

In this section, we consider the vibrating string of Example II.3.2 with ρ(ζ) = T (ζ) = 1, and
ζ ∈ [a, b] = [0, 1]. The string is attached at the left side and is controlled with a force actuator at the
right side. The desired control law is obtained using for instance the energy shaping method proposed
in [Macchelli 17]. The obtained control law is a state feedback control law and we compare it with
the closed-loop when control by interconnection is used instead of the state feedback, and when the
observer-based approach is used. Using control by interconnection we show that the controller has to
be initialized properly, and using the observer-based approach, we show that a proper initialization
is not required.
The PDE and boundary conditions describing the system are given by




q(ζ,
t)
∂








∂t
p(ζ,
t)











0 1 ∂ q(ζ, t)
=
,
1 0 ∂ζ p(ζ, t)









q(ζ, 0) q0 (ζ)

,
=
p(ζ, 0)
p0 (ζ)

P p(0, t) = 0,





q(1, t) = u(t),




y(t) = p(1, t),

(II.50)

Note that, with unitary parameters, the strain is equivalent to the force and the momentum is
equivalent to the velocity. We consider the following control law
u(t) = −w(1, t) − p(1, t),

(II.51)

where w(1, t) and p(1, t) are respectively, the displacement and the velocity at ζ = 1. Due to the
fact that q(ζ, t) = wζ (ζ, t) and that the string is attached at the left side (w(0, t) = 0), the control
law (II.51) can be written equivalently as
u(t) = −

Z 1

q(ζ, t)dζ − p(1, t),

(II.52)

0

and it can be seen as a state feedback control law. Then, for the real implementation it is required
the velocity at ζ = 1, and either the string deformation at ζ = 1, or the force q(ζ, t). In the following,
three different control laws are applied to (II.50) in order to approach the desired control law (II.51)
or (II.52), using as measurement the velocity at ζ = 1 only.
In each case, we simulate the BC-PHS (II.50) using the discretization methods proposed in
[Trenchant 18]. The reader is refered to Appendix A for further details. For the spatial discretization
we use finite differences on staggered grid with 200 state variables, and for the time discretization
we use the midpoint rule with time step δt = 0.1ms. We consider the following initial conditions for
the BC-PHS (II.50)
q0 (ζ) = 0.1, p0 (ζ) = 0, w(ζ, 0) = 0.1ζ.
Using the desired control law ((II.51) or (II.52)), the string deformation w(ζ, t) along time and
space is shown in Figure II.7. In this figure, and in all subsequent figures the bold black lines
represent the initial and final string deformation (w(ζ, 0), w(ζ, 10)), and the green line represents
the desired end-tip string deformation w(1, t). We consider that the response shown in Figure II.7
is the desired one. In the following sections, we aim to apply the control law (II.51) by measuring
p(1, t) only.

26



II.6. Motivation example: observer-based control

Figure II.7 – String deformation
behavior)

(Desired

Figure II.8 – String deformation (control by
interconnection)

Remark II.6.1. Note that,
the control law (II.52) is a particular case of a more general control
R
1
p(1, t). In this more general representation, by properly
law given by u(t) = −qc 01 q(ζ, t)dζ − dc ρ(1)
tuning the parameters qc and dc , one can speed up or speed down the end-tip position of the string,
allowing to modify its settling time. The reader is referred to [Macchelli 17] for further details of
this control law.
♣

II.6.1

Control by interconnection

One way to achieve the desired behavior (Figure II.7) by only measuring p(1, t) is using the
control by interconnection method between (II.50) and the dynamic controller
ẋc (t) = uc (t),
xc (0) = xc0
yc (t) = xc (t) + uc (t),

(II.53a)
(II.53b)

with the passive interconnection (II.41). In this case, the structural invariant is xc (t) = w(1, t)
if xc (0) = w(1, 0). With this initialization, the interconnection with the dynamic controller is
equivalent to the state feedback (II.52). In what follows, we consider the initialization is not ideal.
We simulate the BC-PHS (II.50) with the control law obtained using the controller (II.53) and
the interconnection (II.41) with r(t) = 0 and initial condition xc (0) = xc0 = 0.05. Figure II.8 shows
the deformation response, where a similar behaviour to the desired one (Figure II.7) is obtained.
However, the end-tip response w(1, t) (orange dashed line) does not approach the desired end-tip
response (green line). And indeed, both closed-loop systems converge to a different equilibrium
position for the string deformation. We see then, that control by interconnection is not robust with
respect to the error in the initialization. In the following, we use observers for achieving the same
equilibrium independently of the initial conditions.

27



Chapter II. Background on boundary controlled port-Hamiltonian systems

II.6.2

Observer-based control: early-lumping approach

Using the early-lumping approach, the infinite-dimensional model (II.50) is first discretized into
a finite-dimensional one. Then, a state feedback and a Luenberger observer are designed on the
finite-dimensional model. We define the following Luenberger observer-based control law
u(t) = −K x̂(t)
˙
x̂(t)
= Ad x̂(t) + Bd u(t) + L(y(t) − Cd x̂(t)),

(II.54)
x̂(0) = x̂0 ,

(II.55)

where x̂(t) ∈ Rnd is the estimation of the finite-dimensional state (from the discretized model),
x̂0 ∈ Rnd is the initial condition of the observer, u(t) ∈ R is the control law, and y(t) ∈ R is the
measured velocity at ζ = 1. For simplicity, the matrices Ad ∈ Rnd ×nd , Bd ∈ Rnd ×1 , and Cd ∈ R1×nd
are obtained using finite-differences on staggered grids [Trenchant 18]. Note that, it is the same
discretization method for the BC-PHS (II.50), but the observer (II.54) uses less state variables than
the BC-PHS. For simplicity, we show in Figure II.9 a grid example that takes nd = 8, i.e. 4 elements
for the force q(ζ, t) and 4 elements for the velocity p(ζ, t).
w(ζ, t)
ζ
a

ζp2

ζq2

ζp1

ζq1

ζp4

ζq4

ζp3

ζq3

b

Figure II.9 – Discretization scheme using staggered grids.

In this case, the observer state is given by


!

x̂(t) =

q̂(t)
,
p̂(t)





q̂1 (t)
 . 

q̂(t) =  .. 
,



p̂1 (t)
 . 

p̂(t) =  .. 
,

q̂nq (t)

p̂np (t)

where q̂i (t) is the observed strain at ζ = ζqi for i = {1, · · · , nq }, and p̂i (t) is the observed momentum
at ζ = ζpi for i = {1, · · · , np }, and nq = np = n2d . The following control law
u(t) = −h

nq
X

q̂i (t) − p̂np (t)

(II.56)

i=1

approximates the state feedback (II.52) with h =

2
nd +1

being the length of the grid.

Remark II.6.2. Since we aim to apply a complete observer-based state feedback, we use p̂np (t)
instead of y(t) = p(1, t) in the control law (II.56).
♣
The state feedback gain K is obtained directly from (II.56) as


K = Kq K p

28


nd ×1

,





Kq = h · · · h

nq ×1

,



Kp = 0 · · · 0 1


np ×1

.



II.6. Motivation example: observer-based control

The matrix L is obtained such that the Luenberger observer in (II.54) estimates the state variables
of the finite-dimensional model and such that (II.54) stabilizes asymptotically the BC-PHS (II.50).
In Chapter III, the synthesis of the observer gain is developed such that this is satisfied.
Using the observer-based state feedback controller (II.54) with initial conditions x̂(0) = 0 and
nd = 80, the string deformation behaves as shown in Figure II.10, and the observed deformation
behaves as in Figure II.11. We see that using the observer-based controller, similar performances
than the ones obtained in Figure II.7 are achieved. Figure II.12 and Figure II.13 show closed-loop
simulations with different initial conditions. Once again the observer-based controller allows to
achieve the desired closed-loop performances.
Remark II.6.3. The observer-based controller (II.54) is a dynamic system with nd = 80 state
variables and the vibrating string (II.50) is simulated as a finite-dimensional system using 200 state
variables.
♣

Figure II.10 – String deformation

Figure II.11 – Observed deformation

Figure II.12 – String deformation

Figure II.13 – Observed deformation

29



Chapter II. Background on boundary controlled port-Hamiltonian systems

II.6.3

Observer-based control: late-lumping approach

Using the late-lumping approach, the infinite-dimensional model (II.50) is used for the observer
design. We define the following infinite-dimensional observer
!

!

!

∂ q̂(ζ, t)
0 1 ∂ q̂(ζ, t)
=
,
p̂(ζ,
t)
1 0 ∂ζ p̂(ζ, t)
∂t
p̂(0, t) = 0,
q̂(1, t) = u(t) + y(t) − p̂(1, t),

!

!

q̂(ζ, 0)
q̂ (ζ)
= 0
,
p̂(ζ, 0)
p̂0 (ζ)

(II.57)

where q̂(ζ, t) is the estimation of the strain q(ζ, t), and p̂(ζ, t) is the estimation of the momentum
p(ζ, t). q̂0 (ζ) and p̂0 (ζ) are the observer initial condition for the strain and momentum, respectively.
u(t) is the control law and y(t) is the velocity of the string at ζ = 1. In Chapter IV, we will show
that the observer (II.57) converges exponentially to the state of the BC-PHS (II.50). Then, the
following control law
Z
1

u(t) = −

q̂(ζ, t)dζ − p̂(1, t)

(II.58)

0

approximates the desired one (II.52) as soon as the observer converge to the real state. In Chapter
IV, we show that this control law makes the closed-loop system (composed by (II.50),(II.57), and
(II.58)) asymptotically stable.
Using the infinite-dimensional observer (II.57) with the control law (II.58) in the BC-PHS (II.50)
the string deformation behaves as shown in Figure II.14, and the observed deformation behaves as
in Figure II.15. Both variables achieve the zero equilibrium, and independently of the observer
initial conditions, the same equilibrium is achieved as shown in Figure II.16 and Figure II.17 where
different initial conditions are considered.
Remark II.6.4. Different to the early-lumping approach, in this case the observer is an infinitedimensional system and it has to be discretized for practical implementations. However, since the
discretization is not the aim of this thesis, both systems (the vibrating string (II.50) and the observer
(II.57)) are simulated as finite-dimensional systems with 200 state variables each one.
♣

Figure II.14 – String deformation

30

Figure II.15 – Observed deformation



II.7. Conclusion

Figure II.16 – String deformation

II.7

Figure II.17 – Observed deformation

Conclusion

In this chapter, a background on boundary controlled port-Hamiltonian systems (BC-PHSs) has
been presented. First, we have introduced the class of impedance energy preserving BC-PHSs of
interest in this thesis. Then, we have given some classic examples of them. The parametrization
of the boundary conditions leading to a well-posed system has been given as well. Then, the exact
controllability and the exact observability properties have been discussed for BC-PHSs. Finally, the
closed-loop stability has been studied when static output feedback and dynamic output feedback
is applied to the BC-PHS of interest. In both cases, the conditions for guaranteeing closed-loop
stability has been presented.
This chapter has ended with a motivation example showing the necessity of developing observers
for the implementation of a state feedback controller derived using energy shaping or damping injection, for example.

31





Chapter III
Finite-dimensional observer-based boundary
controllers: early-lumping approach

III.1

Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34

III.2

Preliminaries . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36

III.3

State feedback and Luenberger observer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37

III.4

Passive observer-based state feedback structure . . . . . . . . . . . . . . . . . . . . . . . . . . 40

III.5

Asymptotic stability analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41

III.6

Observer design for a specific state feedback . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44
III.6.1 Design method . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44
III.6.2 Application examples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47

III.7

State feedback design for a specific observer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58
III.7.1 Design method . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58
III.7.2 Application example . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60

III.8

Extension to a class of nonlinear systems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65
III.8.1 Design method . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65
III.8.2 Application example . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 68

III.9

Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77

33



Chapter III. Finite-dimensional observer-based boundary controllers: early-lumping approach

III.1

Introduction

In the previous chapter, we have introduced the class of boundary controlled port-Hamiltonian
systems (BC-PHSs) [Le Gorrec 05] of interest in this thesis. We have seen that this class of systems
can be stabilized by applying static output feedback or dynamic output feedback [Villegas 07]. In
this chapter, we stabilize the BC-PHS by using observer-based state feedback (OBSF) controllers. To
this end, we employ an early-lumping approach. Using this approach, the BC-PHS is first discretized
into a linear time-invariant (LTI) system (or discretized model). This is, the set of partial differential
equations (PDEs) is approximated by a set of ordinary differential equations (ODEs) by using suitable
structure-preserving discretization methods as, for instance, mixed finite-element [Golo 04] or finitedifference on staggered grids [Trenchant 18] techniques. Then, the synthesis of the OBSF gains is
based on the LTI system. Finally, the OBSF controller has to guarantee the closed-loop stability
when it is applied to the BC-PHS.
One of the main advantages of using an early-lumping approach is the number of tools available
in the literature for designing the OBSF gains of LTI systems [Kalman 69, Luenberger 64]. These
techniques are, for instance, the linear quadratic regulator (LQR) [Anderson 07], the pole-placement
[Brasch 70], and more recently, the control by interconnection using Casimirs [Ortega 08], and the interconnection and damping assignment passivity based control (IDA-PBC) [Ortega 02, Prajna 02].
However, since the design is based on the discretized model (LTI system) and not on the BC-PHS,
the closed-loop stability is not guaranteed when applying the OBSF controller to the BC-PHS. We
use an example to show this issue. We design some OBSF gains using classical control techniques
for LTI systems. Then, we show that when applying the OBSF controller to the BC-PHS, the
closed-loop system becomes unstable. This phenomenon is known as spillover effect [Balas 78] and
it occurs when some high-frequency modes that are not considered for the design destabilize the
closed-loop system. To overcome this effect and to guarantee closed-loop stability (when applying
the OBSF controller to the BC-PHS), the classical control techniques have to be adapted.
In this chapter, we impose a passive structure on the OBSF controller. This structure guarantees the closed-loop stability when the OBSF controller is applied to the BC-PHS. We convert the classical OBSF representation into an equivalent dynamic output feedback representation
[Villegas 05, Villegas 07, Wu 18]. As we have seen in the previous chapter, if the dynamic output
feedback controller (or equivalently the OBSF controller) is strictly positive real (SPR), the closedloop between the infinite-dimensional system (BC-PHS) and the OBSF controller is asymptotically
stable [Morgül 94, Morgul 98, Yang 05, Villegas 07]. To achieve this structure, we propose two
methodologies for the synthesis of the OBSF gains. In the first method, the state feedback gain is
freely designed by using classical control techniques. Then, the observer gain is designed (through
the resolution of an algebraic Riccati equation) such that the OBSF controller is SPR. In the second
method, the observer gain is freely designed and the state feedback gain is designed (through the
resolution of a set of linear matrix inequalities) such that the OBSF is SPR. In both cases, it is not
completely free the design of one of the two gains. The benefit of using these constraints is that we
can guarantee closed-loop stability when applying the OBSF controller to the BC-PHS. We use the
vibrating string and the Timoshenko beam as application examples.
In the last section of this chapter, we extend these design methods to a class of nonlinear timeinvariant (NTI) systems. We show that the proposed OBSF controller is output strictly passive (OSP)
and zero state detectable (ZSD). Then, the OBSF controller can stabilize nonlinear systems that are

34



III.1. Introduction

OSP and ZSD too [van der Schaft 00, Brogliato 20]. Similarly to the early-lumping approach, the
NTI system is first linearized into an LTI system. Then, the OBSF gains are designed on the LTI
system by using the aforementioned methodologies. Finally, we show that the closed-loop stability is
guaranteed when applying the OBSF controller to the NTI system. We use a microelectromechanical
system to exemplify the synthesis method.
This chapter is organized as follows. In Section III.2, we introduce the structure of the BC-PHS
of interest and the discretized model used for design. In Section III.3, we present the classic OBSF
controller for LTI systems. In the same section, by using a counterexample, we show that if we
use classical control tools for the design, the closed-loop stability is not guaranteed when applying
the OBSF controller to the BC-PHS. In Section III.4, we impose a passive structure to the OBSF
controller such that when applying it to the BC-PHS, the closed-loop stability is guaranteed. In
Section III.5, we show the asymptotic stability when applying the OBSF controller to the BC-PHS.
In Section III.6 and Section III.7, we propose two methodologies for designing the controller and
observer gains. We exemplify these methodologies using the vibrating string and the Timoshenko
beam models. Finally, in Section III.8, we extend these methodologies to a class of finite-dimensional
nonlinear systems. In this case, the synthesis of the OBSF controller is based on a linearized model
and the closed-loop stability is guaranteed when the OBSF controller is applied to the nonlinear
system. We use a microelectromechanical system to exemplify this extension. Some conclusions are
presented in Section III.9.

35



Chapter III. Finite-dimensional observer-based boundary controllers: early-lumping approach

III.2

Preliminaries

We consider the following BC-PHS:

∂
∂x


(ζ, t) = P1 (H(ζ)x(ζ, t)) + P0 H(ζ)x(ζ, t),


 ∂t 
∂ζ

P W f∂ (t) = u(t),

 B e∂ (t) 



f∂ (t)
y(t) = W
,
C

x(ζ, 0) = x0 (ζ),
(III.1)

e∂ (t)

where ζ ∈ [a, b] is the spatial variable and t ≥ 0 is the time variable. x(ζ, t) ∈ Rn is the state variable
with initial condition x0 (ζ). P1 = P1T ∈ Mn (R) is a non-singular matrix, P0 = −P0T ∈ Mn (R), H(·) ∈
Mn (L2 ([a, b]; R)) is a bounded and continuously differentiable matrix-valued function satisfying for
all ζ, H(ζ) = HT (ζ) and mI < H(ζ) < M I with 0 < m < M both constant scalars. WB and WC
T
T
T
are two
 n × 2n full rank real matrices such that WB ΣWB = WC ΣWC = 0n and WC ΣWB = In , with
Σ = 0Inn 0Inn . The boundary port variables are defined as in [Le Gorrec 05] as follows:
!

1 P1 −P1
f∂ (t)
=√
e∂ (t)
I
2 I

!

!

H(b)x(b, t)
,
H(a)x(a, t)

(III.2)

and the Hamiltonian energy is given by
1Z b
x(ζ, t)T H(ζ)x(ζ, t)dζ.
H(t) =
2 a

(III.3)

Since the input u(t) and the output y(t) of the BC-PHS (III.1) are defined in terms of the boundary
port variables and the matrices WB and WC satisfy WB ΣWBT = WC ΣWCT = 0n and WC ΣWBT = In ,
the Hamiltonian (III.3) satisfies
Ḣ(t) = u(t)T y(t).
(III.4)
In this chapter, the synthesis of an OBSF controller for the BC-PHS (III.1) is proposed using an
early-lumping approach. Using this approach, the BC-PHS is first discretized into a system described
by ODEs (discretized model). Then, the synthesis of the OBSF gains is based on the discretized
model such that the closed-loop system between the BC-PHS (III.1) and the OBSF controller is
stable. To achieve this stability requirement, the OBSF controller is restricted to be passive. Even
with this restriction, one can assign a desired behavior (settling time, rise time, overshoot, etc) to the
closed-loop system between the discretized model and the OBSF controller, but more important one
can guarantee the closed-loop stability when applying the OBSF controller to the BC-PHS (III.1)
(infinite-dimensional system).
The first step in an early-lumping approach is to discretize the BC-PHS into a finite-dimensional
model. In the literature we can found different techniques that preserve the port-Hamiltonian
structure. These techniques are, for instance, the mixed finite element [Golo 04, Hamroun 06], finite
differences on staggered grids [Trenchant 18], discrete exterior geometry [Seslija 12], and partitioned
finite element [Brugnoli 19a, Serhani 19, Cardoso-Ribeiro 21]. For simplicity, in this thesis, we use
the finite differences on staggered grids method proposed in [Trenchant 18]. The reader is referred to
the Appendix A for further details of this method. The following assumption is considered concerning
the structure of the discretized model used for the design of the OBSF controller proposed in this
chapter.

36



III.3. State feedback and Luenberger observer

Assumption III.2.1. There exists a discretized model for the system (III.1) with input u(t) and
output y(t) of the following form
P


ẋ

d (t)

y(t)

= (Jd − Rd )Qd xd (t) + Bd u(t)
= BdT Qd xd (t)

(III.5)

where xd ∈ Rnd with nd given by the size of the discretization, Jd = −JdT , Rd = RdT ≥ 0nd ,
Qd = QTd > 0nd all of them in Mnd (R) and Bd ∈ Rnd ×n . Furthermore we assume (III.5) to be
controllable and observable. For simplicity, we shall define Ad = (Jd − Rd )Qd and Cd = BdT Qd and
we refer to the system (Ad , Bd , Cd ) as the approximated model of (III.1).
♣
Remark III.2.1. As soon as nd increases, the discretized model (III.5) approaches the infinitedimensional system (III.1).
♣

III.3

State feedback and Luenberger observer

State feedback allows to assign the overall closed-loop eigenvalues and may also be used to assign a
part of the closed-loop eigenstructure [Kalman 69, Andry 83, Jiang 94]. For example, state feedback
may be used to assign settling time, rise time, damping ratio or overshoot. The main drawback of
this control strategy is that it requires the measurement of the overall state. To overcome this, the
state is reconstructed using observers. An observer is a dynamical system that uses the dynamical
model of the system and the measurement of the input and output to reconstruct the state variables
[Luenberger 64].
Definition III.3.1. A full observer-based state feedback controller for the system (III.5) is defined
as follows:
u(t) = −K x̂(t) + r(t)
˙
x̂(t)
= Ad x̂(t) + Bd u(t) + L(y(t) − Cd x̂(t)),

(III.6a)
x̂(0) = x̂0 ,

(III.6b)

where (III.6a) is the observed state feedback and (III.6b) is a Luenberger observer. K ∈ Rn×nd and
L ∈ Rnd ×n are the controller and the observer gains, respectively. These gains are designed such
that Ad − Bd K and Ad − LCd are Hurwitz matrices. x̂(t) ∈ Rnd is the observed state with initial
condition x̂0 , and r(t) ∈ Rn is an external input.
♣
The system (III.5) is assumed to be observable and controllable. Then, the synthesis of the state
feedback and observer gains can be designed using classical control tools. However, several issues
can occur when applying the OBSF controller to the BC-PHS (III.1). The most critical one is the
instability in closed-loop caused by the spillover effect. In this case, the high frequency modes that
have not been taken into account during the design are destabilized when the OBSF controller is
applied to the BC-PHS. This effect is shown in the following example.
Example III.3.1. Consider the one-dimensional wave equation with unitary parameters and Neumann boundary control at both sides, i.e. with force actuators at both sides. The system can be
written as a BC-PHS (III.1) with
"

P1 =

0 1
1 0

#

,

P0 = 0,

H = I2 .

37



Chapter III. Finite-dimensional observer-based boundary controllers: early-lumping approach

This model is discretized by using finite differences on staggered grids in order to preserve the structure of the system [Trenchant 18]. Consider nd = 59 elements for the discretization. All the eigenvalues of Ad are on the imaginary axis as shown in Figure III.1 (a). (Ad , Bd ) is controllable and
(Ad , Cd ) is observable, hence K and L can be designed such that AK = Ad −Bd K and AL = Ad −LCd
are Hurwitz matrices. Using for instance the LQR method, the closed-loop eigenvalues can be assigned as shown in Figure III.1 (a).
The question that naturally arises is if the same OBSF controller, i.e. the same choice of matrices
K and L, preserves the stability when applying it to the infinite-dimensional system. The answer
is in general no. In this particular case for instance, when applying the designed OBSF controller
(with nd = 59 states) to a more precise discretized model that uses for example nd = 67 states, the
closed-loop system turns unstable as shown in Figure III.1 (b).

Figure III.1 – (a): λ(A): Eigenvalues of Ad with nd = 59, λ(AK ): Ad − Bd K eigenvalues and
λ(AL ): Ad − LCd eigenvalues. (b): λ(Ah ): discretized model eigenvalues with nd = 67, λ(Acl ):
closed-loop eigenvalues.

♣

38



III.3. State feedback and Luenberger observer

u(t)
−

K

P

y(t)

P̂

x̂(t)
Figure III.2 – Observer-based state feedback
diagram block

u(t)

P

yc (t)

C

y(t)

uc (t)

Figure III.3 – Passive observer-based state
feedback diagram block.

In Example III.3.1, we have shown that the classical control tools have to be adapted to guarantee
closed-loop stability when applying the OBSF controller to the BC-PHS. In the following section,
we convert the classical closed-loop structure between (III.5) and (III.6), represented in Figure
III.2 with r(t) = 0, into an equivalent closed-loop structure represented in Figure III.3, where C
represents the OBSF controller. By imposing a passive structure to the dynamic controller C (or
the OBSF controller), we can guarantee closed-loop stability when applying the OBSF controller to
the BC-PHS. Then, the matrices K and L are restricted to obtain a passive OBSF controller. In
the following section, we present the conditions to have a passive OBSF controller and in Sections
III.6 and III.7, we propose two methods for the synthesis of the OBSF gains.

39



Chapter III. Finite-dimensional observer-based boundary controllers: early-lumping approach

III.4

Passive observer-based state feedback structure

In this section, we adapt the OBSF scheme of Figure III.2 into an equivalent closed-loop scheme
as shown in Figure III.3, where C is a passive dynamic controller with input uc (t) and output yc (t).
To this end, we replace (III.6a) in (III.6b)
˙
x̂(t)
= (Ad − Bd K − LCd )x̂(t) + Ly(t) + Bd r(t).

(III.7)

Then, the synthesis of the matrices K and L are chosen such that the dynamical system (III.7) is a
finite-dimensional port-Hamiltonian system with inputs y(t) and r(t). To do that, the matrices K
and L have to be chosen such that
Ad − LCd − Bd K = (Jc − Rc )Qc

(III.8)

is satisfied for some nc × nc matrices Jc = −JcT , Rc = RcT ≥ 0, Qc = Q>
c > 0, (Ad , Bd , Cd ) defined in
(III.5), and nc the size of the controller given by the discretized model used for design. If (III.8) is
satisfied we can write (III.7) as a finite-dimensional port-Hamiltonian system as follows:

˙


x̂(t)

= (Jc − Rc )Qc x̂(t) + Bc uc (t) + Bd r(t),
C yc (t) = Bc> Qc x̂(t),



yr (t) = Bd> Qc x̂(t).

x̂(0) = x̂0 ,
(III.9)

with Bc = L and uc (t) = y(t). The inputs of this system are uc (t) and r(t) with conjugated outputs
yc (t) and yr (t), respectively. Then, the closed-loop dynamics when using control by interconnection
with the passive interconnection
!

!

u(t)
0 −1
=
1 0
uc (t)

!

!

y(t)
1
+
r(t)
yc (t)
0

(III.10)

between (III.5) and (III.9) is equivalent to the closed-loop dynamics between (III.6) and (III.5). In
the following proposition, the matching conditions (III.8) guaranteeing the equivalence between the
scheme of Figure III.2 and the scheme of Figure III.3 are made explicit.
Proposition III.4.1. The original OBSF controller (III.6) applied to (III.5) using the scheme of
Figure III.2 is equivalent to the control by interconnection between (III.5) and (III.9) through (III.10)
as shown in Figure III.3 if the following matching conditions are satisfied
(Jc − Rc )Qc = Ad − Bd K − LCd ,
BcT Qc = K,
Bc = L.

(III.11)

♦
Proof. The matching equations (III.11) are directly obtained replacing (III.6a) in (III.6b) and identifying with (III.9) in order to get a passive and collocated dynamic controller. The first matching
condition in (III.11) is obtained from (III.8), the second matching condition in (III.11) is such that
yc (t) is a conjugated output of uc (t). The last condition in (III.11) is obtained such that y(t) is an
input of the controller (III.9).


40



III.5. Asymptotic stability analysis

Then, solving the algebraic equation (III.11) of Proposition III.4.1 and imposing Rc > 0 to the
controller, we can show the asymptotic stability of the closed-loop system between the discretized
model (III.5) and the OBSF controller (III.9) through the passive interconnection (III.10) (Figure
III.3).
Theorem III.4.1. The interconnection (III.10) between (III.5) and (III.9) is asymptotically stable
and converges to zero if Rc = RcT > 0 and r(t) = 0.
♦
Proof. Consider the total energy as Lyapunov function
1
1
V (xd , x̂) = xTd Qd xd + x̂T Qc x̂
2
2
Then from (III.5) and (III.9) we have
V̇ (xd , x̂) = −xd T Qd Rd Qd xd − x̂T Qc Rc Qc x̂,
with Rd ≥ 0 and Rc > 0. From Lasalle’s invariance principle the system converges to the invariant
set corresponding to V̇ (xd , x̂) = 0, i.e. x̂ = 0 (since Rc > 0). In this case, x̂ = 0 implies x̂˙ = 0, which
implies Bc uc = 0 (from (III.9) and r = 0). The controller being controllable implies uc = 0 and
x̂ = 0 implies yc = 0 (from (III.9)). From the interconnection (III.10) y = uc = 0 and u = −yc = 0
(since r = 0). The system (III.5) being observable implies that the only equilibrium point is xd = 0.

In Theorem III.4.1 we show that the OBSF controller (III.9) stabilizes asymptotically the discretized model (III.5). In the following section we show that the same OBSF controller stabilizes
asymptotically the BC-PHS (III.1).

III.5

Asymptotic stability analysis

Now, we apply the OBSF controller (III.9) to the BC-PHS (III.1) in a power preserving way as it
is shown in Figure III.4, where P refers to the BC-PHS (III.1) and C refers to the OBSF controller
(III.9). In the following theorem, we show that the controller (III.9), being strictly positive real,
stabilizes asymptotically the BC-PHS (III.1).
u(t)

P

yc (t)

C

y(t)

uc (t)

Figure III.4 – Closed-loop system between a BC-PHS and a finite-dimensional controller

41



Chapter III. Finite-dimensional observer-based boundary controllers: early-lumping approach

Theorem III.5.1. Consider the closed-loop system obtained from the passive interconnection (III.10)
between the BC-PHS (III.1) and the OBSF controller (III.9) with r(t) = 0 as shown in Figure III.4.
If the matrix Rc from the OBSF controller (III.9) is strictly positive definite, then the followings
results hold
(i) The closed-loop system is well-posed.
(ii) The closed-loop system is asymptotically stable.
♦
Proof. This is a direct application of Corollary II.5.3.

Theorem III.5.1 uses the passive interconnection (III.10) considering that the full inputs and outputs are available for the interconnection between the BC-PHS and the OBSF controller. However,
this is not always possible and some times only some parts of the inputs and outputs are used for
the interconnection as shown in Figure III.5. This is for instance, the case of the string attached
at one side and actuated at the other side. In these cases, we have to assume that the BC-PHS is
approximately observable with respect to the interconnected output (as for example the output y1 (t)
from Figure III.5). Approximate observability [Curtain 12, Corollary 4.1.14] states that if the output
of a system with homogenous input is zero for a period of time, then the state of the system is zero
as well. Using this property, similarly to Theorem III.5.1, we can use LaSalle’s invariance principle
to show that the closed-loop system is asymptotically stable.
u2 (t)

y2 (t)

u1 (t)
yc (t)

P
C

y1 (t)
uc (t)

Figure III.5 – Closed-loop system between a BC-PHS and a finite-dimensional controller by partial
interconnection

Corollary III.5.1. Consider the closed-loop scheme of Figure III.5, where P is the impedance energy
preserving BC-PHS (III.1) with
!

u (t)
u(t) = 1
u2 (t)

!

y (t)
and y(t) = 1
,
y2 (t)

and C is the OBSF controller (III.9) with r(t) = 0. Provided that the closed-loop system is wellposed and that the solution trajectories are precompact, If the matrix Rc > 0, u2 (t) = 0, and
(III.1) is approximately observable with respect to the output y1 (t), then the closed-loop system is
asymptotically stable.
♦
Proof. We consider the following as a Lyapunov function:
V (t) =

42

1
1Z b
x(ζ, t)T H(ζ)x(ζ, t)dζ + x̂(t)T Qc x̂(t).
2 a
2



III.5. Asymptotic stability analysis

It follows from LaSalle’s invariance principle (See [Luo 12, Theorem 3.64]) that all solutions of the
closed-loop system tend to the maximal invariant set of
ϑc = {x ∈ L2 ([a, b], Rn ), x̂ ∈ Rnc | V̇ (t) = 0}.

(III.12)

We define the maximal invariant subset of ϑc as I, and we show that I only contains the zero state,
i.e. I = {x(ζ, t) = 0, x̂(t) = 0}. From (III.1), (III.9), and r(t) = 0, we obtain the following balance
for the Lyapunov function:
V̇ (t) = −x̂(t)T Qc Rc Qc x̂(t).
(III.13)
˙
Since Rc > 0, V̇ (t) = 0 implies x̂(t) = 0, which implies x̂(t)
= 0. Then, from (III.9) Bc uc (t) = 0.
Since the controller is controllable, uc (t) = 0. Since x̂(t) = 0, from (III.9) yc (t) = 0. Since
uc (t) = yc (t) = 0, from the interconnection (Figure III.5)
!

!

u1 (t)
0 −1
=
1 0
uc (t)

!

y1 (t)
,
yc (t)

we can conclude y1 (t) = u1 (t) = 0. Then, the maximal invariant set I contains x̂ = 0 and the
solution of the following BC-PHS:

∂x
∂


(ζ, t) = P1 (H(ζ)x(ζ, t)) + P0 H(ζ)x(ζ, t),


 ∂t 
∂ζ 


f∂ (t)
u1 (t)
W
=
= ( 00 ) ,
 B e∂ (t)
u

2 (t) 






f∂ (t)
0
y(t) = W
= y1 (t) =
.
C

e∂ (t)

y2 (t)

x(ζ, 0) = x0 (ζ),

y2 (t)

By definition, the latter is approximately observable with respect to y1 (t). This implies that if y1 (t) =
0 for an interval of t, then the state is such that x(ζ, t) = 0 (See [Curtain 12, Corollary 4.1.14]).
Then, the maximal invariant set I only contains the states x(ζ, t) = and x̂(t) = 0. Thus, by LaSalle’s
invariance principle, the asymptotic stability of the closed-loop system is guaranteed.

In the following two sections, two methods are provided for the synthesis of the matrices K
and L such that the OBSF controller is on the form (III.9) with Rc > 0. Then, the asymptotic
stability is preserved when applying it to the BC-PHS (III.1) (Figure III.4 or Figure III.5). In the
first method, the gain K is freely designed using classical control tools and the gain L is designed
such that the OBSF controller is passive. In the second method, the gain L is freely designed using
classical control tools and the gain K is designed such that the OBSF controller is passive.

43



Chapter III. Finite-dimensional observer-based boundary controllers: early-lumping approach

III.6

Observer design for a specific state feedback

In this section, the state feedback gain K is first designed using an approach like LQR
[Anderson 07], pole-placement [Brasch 70], control by interconnection using Casimirs [Ortega 08],
or IDA-PBC [Ortega 02, Prajna 02]. Then, by solving an algebraic Riccati equation (ARE), the
observer gain L is designed in order to satisfy the matching conditions of Proposition III.4.1. This
section is organized as follows. First, the methodology is proposed, and then, the vibrating string
and the Timoshenko beam are used as examples.

III.6.1

Design method

The gains K and L are designed on the discretized model (Ad , Bd , Cd ) from (III.5). The discretized model is an approximation of the BC-PHS (III.1). Then, we have to choose nd (from (III.5))
large enough to have similar performances when applying the OBSF controller to the discretized
model than when applying it to the BC-PHS. Since the pair (Ad , Bd ) is controllable, the matrix K
is chosen with classical control tools such that the following assumption is satisfied.
Assumption III.6.1. The gain K is designed such that Ad − Bd K is Hurwitz.

♣

Remark III.6.1. In this case, the design of the state feedback is free and it can be achieved by
using traditional methods such as LQR, pole-placement or the LMI passivity based control proposed
in [Prajna 02].
♣
After designing the gain K such that Ad − Bd K is Hurwitz, we have to design the gain L such
that the OBSF controller is passive. To this end, we fix the matrix Rc and we obtain the matrices
Jc , Qc and L such that the matching conditions of Proposition III.4.1 are satisfied. To this end, we
have to chose Rc > 0 in such a way that there exists a solution for the matching conditions (III.11).
Assumption III.6.2. The matrix Rc is chosen positive definite such that the following matrix
HM

AK
2Rc
=
−CK −ATK

!

(III.14)

with
AK = Ad − Bd K, CK = −(K T Cd + CdT K),

(III.15)

has no pure imaginary eigenvalues.
♣
The matrix HM in (III.14) is known as the Hamiltonian matrix related to the algebraic Riccati
equation (ARE) (III.16). If the HM has no pure imaginary eigenvalues, then there exists a solution
Qc = QTc > 0 for the ARE (III.16). A simple choice to have solution is the choice of Rc = αInc for
some α > 0 small enough such that the matrix (III.14) has no pure imaginary eigenvalues. Finally,
using the following proposition, we can complete the design and obtain the gain L such that the
matching conditions (III.11) are satisfied.
Proposition III.6.1. Let Assumptions III.6.1 and III.6.2 be satisfied. There exists a matrix Qc =
QTc > 0, solution of the algebraic Riccati equation (ARE)
ATK Qc + Qc AK + 2Qc Rc Qc + CK = 0,

44

(III.16)



III.6. Observer design for a specific state feedback

such that the matching equations (III.11) are satisfied with
i
1h
−1 T
−1
T
T
−1
AK Q−1
,
c − Qc AK − Qc (K Cd − Cd K)Qc
2
T
Bc = Q−1
c K ,
L = Bc .

Jc =

Furthermore, the matrix Ad − LCd is Hurwitz.

(III.17)

♦

Proof. From [Kosmidou 07] it is known that if the Hamiltonian matrix (III.14) has no pure imaginary eigenvalues then there exists a solution Qc = QTc > 0 for (III.16). Hence we only need to prove
that (III.16) is compatible with the matching equation (III.11) for Jc and L as in (III.17). Since Qc
is invertible and solution of (III.16) we have
i
1 h −1 T
−1
−1
C
Q
+
Q
Qc AK + AK Q−1
K c
c
c
2
i
h
1
−1
T
T
−1
−1
T
.
= − Q−1
K)Q
(K
C
+
C
−
Q
+
A
Q
A
d
K c
c
d
c
2 c K
Then, using (III.17) and (III.18) we have

Rc = −

1
−1 T
−1
(Jc − Rc )Qc = (2AK Q−1
c − 2Qc K CQc )Qc
2
T
= AK − Q−1
c K C
= AK − LC
= Ad − Bd K − LCd

(III.18)

(III.19)

which corresponds to (III.11). From Theorem III.4.1 the closed-loop system
!

d xd
Ad
−Bd K
=
Bc Cd (Jc − Rc )Qc
dt x̂

!

!

!

xd
Bd
r
+
x̂
Bd

(III.20)

is asymptotically stable. Applying the following transformation
!

xd
I 0
=
x̃
I −I

!

!

xd
,
x̂

the closed-loop system (III.20) can be written
!

d xd
AK
Bd K
=
AK − Bc Cd − Ac Ac + Bd K
dt x̃

!

!

!

xd
Bd
+
r
x̃
Bd

(III.21)

with AK = Ad − Bd K, Bc = L and Ac = (Jc − Rc )Qc = Ad − Bd K − LCd or equivalently
!

d xd
Ad − Bd K
Bd K
=
0
Ad − LCd
dt x̃

!

!

!

xd
Bd
+
r
x̃
0

(III.22)

Since AK is Hurwitz, and the closed-loop system asymptotically stable, Ad − LCd is also Hurwitz.

Note that, using Proposition III.6.1 the design of the matrix L depends on the matrix K, and
then, the separation principle is not satisfied using this methodology. However, an important benefit
of using this approach is that the controller (III.6) can stabilize not only the discretized model (III.5)
but also the BC-PHS (III.1).

45



Chapter III. Finite-dimensional observer-based boundary controllers: early-lumping approach

Theorem III.6.1. Consider the BC-PHS (III.1) controlled by (III.6) with K and L designed using
Proposition III.6.1. The closed-loop system converges asymptotically to zero for r(t) = 0.
♦
Proof. The proof is a direct application of Theorem III.5.1. By Proposition III.6.1, since Rc is positive definite, the controller is SPR and then, from Theorem III.5.1, the closed-loop is asymptotically
stable.

In the following, we present a summary of the design procedure of the OBSF controller proposed
in this section. Then, the procedure is exemplified in the following sections using the vibrating string
and the Timoshenko beam as examples.
Procedure III.6.1. The design procedure is summarized as follows:
Step 1: Represent the BC-PHS as in (III.1).
Step 2: Derive a structure-preserving finite-dimensional approximation P as in (III.5).
Step 3: Design K such that Ad − Bd K is Hurwitz.
Step 4: Choose a matrix Rc > 0 such that HM in (III.14) has no pure imaginary eigenvalues.
For example Rc = αInc with α > 0.
Step 5: Solve the ARE (III.16) to find Qc .
T
Step 6: Implement the OBSF controller with L = Q−1
c K .

♣

46



III.6. Observer design for a specific state feedback

III.6.2

Application examples

In this section, we use the vibrating string and the Timoshenko beam examples to show the
design procedure proposed in Procedure III.6.1.
Example III.6.1. We consider the vibrating string of Example II.3.2 with ρ(ζ) = T (ζ) = 1, and
ζ ∈ [a, b] = [0, 1]. The string is attached at ζ = 0 and it is controlled with a force actuator at ζ = 1.
By only measuring the velocity at ζ = 1, we aim to apply a state feedback control law obtained using
energy shaping and damping injection. The control law was introduced in the motivational example in
Section II.6, where it was also shown the necessity of using observers to achieve the desired behavior.
Now, we follow the Procedure III.6.1 to design the OBSF controller.
Step 1. The dynamical system is represented as a BC-PHS
!

!

!

∂ q(ζ, t)
0 1 ∂
=
1 0 ∂ζ
∂t p(ζ, t)
p(0, t) = 0,
q(1, t) = u(t),
y(t) = p(1, t),

!

!

q(ζ, 0)
q (ζ)
= 0
,
p(ζ, 0)
p0 (ζ)

q(ζ, t)
,
p(ζ, t)

where u(t) and y(t) are respectively, the force and the velocity at the right side of the string. In this
case, the vibrating string has no internal dissipation. This makes more difficult the stabilization than
the case in which internal dissipation is included.
Step 2. The finite-dimensional approximation of the BC-PHS is obtained using finite differences
on staggered grids [Trenchant 18]. The reader is refer to Appendix A for further details. Using this
discretization method, the grid is chosen such that the boundary conditions p(0, t) and q(1, t) are
exactly located at the respective borders. The discretized model contains as inputs both boundary
conditions that, in this case, can be settled equal to 0 and u(t), respectively. For simplicity, we chose
w(ζ, t)
ζ
a

ζq1

ζp1

ζq2

ζp2

ζq3

ζp3

ζq4

ζp4

b

Figure III.6 – Discretization scheme using staggered grids.

nd = 8, that corresponds to 4 elements for the force and 4 elements for the velocity. Figure III.6
shows the spatial distribution of the finite-dimensional variables for the force (subscript q) and for
the velocity (subscript p) on staggered grids. The discretized model is represented as (III.5) with
"

xd (t) =

qd (t)
pd (t)


#

, u(t) = q(1, t), y(t) = p4 (t).


q1 (t)
 . 

qd (t) =  .. 
,
q4 (t)





p1 (t)



pd (t) =  ... 
,
p4 (t)

47



Chapter III. Finite-dimensional observer-based boundary controllers: early-lumping approach

where qi (t) and pi (t) with i = {1, 2, 3, 4} are respectively, the approximation of the strain (force) and
the momentum (velocity) along ζ as shown in Figure III.6. The matrices of the discretized model
(III.5) are
"

Jd =

04 D
−DT 04

#

"

, Rd =



D=

where h =
ζp2 − ζ11 .

2
9

1
h2






04 04
04 04

#

"

, Qd = h

1 0 0
−1 1 0
0 −1 1
0 0 −1

0
0
0
1

I4 04
04 I4




,




bb =

1


h

0
0
0
1

#

"

, Bd =

04×1
bb

#







is the spatial distance between two consecutive variables as for example h = ζq2 − ζq1 =

Step 3. The control law is introduced in Section II.6. It is obtained by using energy shaping and
damping injection. The control law ends in the following state feedback:

u(t) = −

Z 1

q(ζ, t)dζ − p(1, t),

0

that it is approximated in terms of the discretized model as follows

u(t) = −h

4
X

qi (t) − p4 (t),

i=1

or equivalently as
u(t) = −Kxd (t)
with
K=

h

i

h h h h 0 0 0 1 .

The closed-loop matrix AK = Ad − Bd K is Hurwitz, since all its eigenvalues have negative real part
as shown in Figure III.7.

48



III.6. Observer design for a specific state feedback

Figure III.7 – Plant eigenvalues λ(A), controller
eigenvalues λ(AK ), and observer eigenvalues
λ(AL ).

Figure III.8 – Hamiltonian matrix eigenvalues
λ(HM ).

Step 4. For simplicity, we chose a matrix Rc as a diagonal matrix such that
10 · · ·
 . .
 ..
..



Rc = 

0

0

0
..
.



0
.. 
.


.

· · · 10 0 
· · · 0 20

The matrix HM has no eigenvalues on the imaginary axis as shown in Figure III.8. Note that, the
last element of the diagonal of Rc is chosen bigger than the other ones since the last state variable
of the observer is the one related to the available sensor y(t) = p(1, t).
Step 5. We solve the algebraic Riccati equation (III.16) using the numerical method proposed in
[Lanzon 08]. The eigenvalues of the matrix Qc are all pure real and positive define as we show in
Figure III.9.
Step 6. We compute L = Q−1
c K. The eigenvalues of AL = Ad − LCd are shown in Figure III.7.
Finally, we simulate the closed-loop system between the designed OBSF controller and a new
discretized model (III.5) that uses nd = 200, i.e. a more precise model of the BC-PHS (III.1). In
this case, the closed-loop system is composed by 208 states and all the closed-loop eigenvalues are in
the left hand side of the imaginary axis as Figure III.10 shows. Note that, the stability is preserved
when applying the OBSF controller to a new model that it has not been used for the design. This is
due to the structure imposed to the OBSF controller and not in the model used for design.
We simulate the closed-loop system with initial conditions w0 (ζ) = 0.1ζ, q0 (ζ) = 0.1, p0 (ζ) = 0,
and x̂0 = 0. Figure III.11 shows the string deformation in closed-loop, and Figure III.12 shows
the estimated one. Note that, since the size of the model used for the design is nd = 8, some
high frequency modes are not considered for the OBSF design. Then, the oscillations due to these
frequency modes are not controlled as we can see in Figures III.11 and III.12. To reduce these
oscillations, a more precise model has to be used for the design. In the following, we repeat the
design from Step 2 using a more precise discretized model for the design.

49



Chapter III. Finite-dimensional observer-based boundary controllers: early-lumping approach

Figure III.9 – Eigenvalues of Qc λ(Qc )

Figure III.10 – Closed-loop eigenvalues λ(ACL )

Figure III.11 – Deformation.

Figure III.12 – Observed deformation.

Step 2. If we chose nd = 80, the discretized model is represented as (III.5) with the same structure
as before.
Step 3. Similarly as before, the state feedback matrix is obtained as follows:
K=

h

h ··· h 0 ··· 0 1

i
40×1

.

The closed-loop matrix AK = Ad − Bd K is Hurwitz and its eigenvalues are shown in Figure III.13.
Step 4. In this case, we chose a matrix Rc as a diagonal matrix such that


1 ···
. .
 ..
..


Rc = 
0 · · ·
0 · · ·


0 · · ·
0 ···

50

0
..
.

0
..
.

0
..
.



0
.. 
. 


1 0
0
0 
.
0 500 0
0 


0 0 500
0 
0 0
0 2500




III.6. Observer design for a specific state feedback

Figure III.13 – Plant eigenvalues λ(A), controller
Figure III.14 – Hamiltonian matrix eigenvalues
eigenvalues λ(AK ), and observer eigenvalues
λ(HM ).
λ(AL ).
The matrix HM has no eigenvalues on the imaginary axis as Figure III.14.
Step 5. We solve the algebraic Riccati (III.16) with the numerical method proposed in [Lanzon 08].
The eigenvalues of the matrix Qc are all pure real and they are shown in Figure III.15.
Step 6. We compute L = Q−1
c K. The eigenvalues of AL = Ad − LCd are shown in Figure III.13.
Finally, we simulate the closed-loop system between the obtained observer-based state feedback
controller and a new discretized model (III.5) that uses nd = 200, i.e. a more precise model of the
BC-PHS (III.1). In this case, the closed-loop system is composed by 280 states and all the closedloop eigenvalues are in the left hand side of the imaginary axis as Figure III.16 shows. Hence, the
stability is preserved when applied the observer-based controller to a more precise discretized model
of the BC-PHS.

Figure III.15 – Eigenvalues of Qc λ(Qc ).

Figure III.16 – Closed-loop eigenvalues λ(ACL )

51



Chapter III. Finite-dimensional observer-based boundary controllers: early-lumping approach

The initial conditions are w0 (ζ) = 0.1ζ, q0 (ζ) = 0.1, p0 (ζ) = 0, and x̂0 = 0. Figure III.17
shows the string deformation in closed-loop, and Figure III.18 shows the estimated one. Different to
the previous simulation (Figure III.11 and Figure III.12), now the oscillations are reduced. This is
mainly due to the fact that more frequency modes are taken into account for the observer-based state
feedback controller.

Figure III.17 – Deformation.

Figure III.18 – Observed deformation.

♣
In the following example, we use the Timoshenko beam to exemplify the Procedure III.6.1. In this
case, we use linear quadratic regulator for the design of the state feedback matrix K and Proposition
III.6.1 for the design of the observer gain L.
Example III.6.2. We consider the Timoshenko beam of Example II.3.3. The beam is clamped at
the left side and actuated at the right side with a force actuator and a torque actuator. We consider
that the transverse velocity and angular velocity are measured. The model is presented in Example
II.3.3 and the parameters are shown in Table III.1.
Table III.1 – Plant parameters.
Parameters
T
ρ
EI
Iρ
[a, b]

Values

Unit

3.4531 × 105
0.0643
37.0116
2.1485 × 10−6
[0, 0.3]

Pa
kg.m−1
P a.m4
Kg.m2
m

Step 1. The Timoshenko beam is represented as a BC-PHS
x1
0


∂ 
 x2 
1
 =
∂t x3  0
x4
0


52





1
0
0
0

0
0
0
1

0
0
 ∂

1 ∂ζ
0






T x1
0
 1

 ρ x2  

 0
EIx  + 
0
3

1
x
1
Iρ 4


0
0
0
0





T x1
0 −1
 1



0 0   ρ x2 
 , x(ζ, 0) = x0 (ζ),

0 0  EIx3 

1
x
0 0
4
Iρ



III.6. Observer design for a specific state feedback
1
x (a, t)
ρ 2

=

1
x (a, t)
Iρ 4

=0
!
1
x (b, t)
ρ 2
1
x (b, t)
Iρ 4

!

T x1 (b, t)
= u(t),
EIx3 (b, t)

y(t) =

where u(t) contains the force and torque at the right side and y(t) contains the transverse velocity
and the angular velocity at the right side.
Step 2. The finite-dimensional approximation of the BC-PHS is obtained using the method proposed in [Trenchant 18] as in Example III.6.1 (See Appendix A). Using this discretization method,
the grid is chosen such that the boundary conditions ρ1 x2 (a, t), I1ρ x4 (a, t), T x1 (b, t), and EIx3 (b, t) are
exactly located at the respective borders. The discretized model contains as inputs the four boundary conditions
 that, in this case, can be settled equal to 0, 0, u1 (t), and u2 (t), respectively (with

u1 (t)
u(t) = u2 (t) ). We chose for instance, a discretized model with nd = 16 state variables. The force
and torque are approximated at ζ = ζ1i , while the transverse and angular velocities are approximated
at ζ = ζ2i for i = {1, 2, 3, 4}. as shown in Figure III.19.
w(ζ, t)
ζ
a

ζ11

ζ21

ζ12

ζ23

ζ13

ζ22

ζ24

ζ14

b

Figure III.19 – Discretization scheme using staggered grids for the Timoshenko beam.

The discretized model used for the design is on the form (III.5) with the following variables:


xd (t) =






xd1 (t)
xd2 (t)
xd3 (t)
xd4 (t)








 , u(t)


"

=

T x1 (b, t)
EIx3 (b, t)



" 1

#

, y(t) =





ρ4

1 4
x42 (t) + 19 Iρ4
x4 (t)
1 4
x (t)
Iρ4 4





#

,



x14 (t)
x13 (t)
x11 (t)
x12 (t)







..  , xd (t) =  ..  , xd (t) =  ..  , xd (t) =  .. 
xd1 (t) = 
. 
. 
. 
. 
4
3
2


.


4
4
4
4
x3 (t)
x4 (t)
x2 (t)
x1 (t)
The matrices of the discretized model (III.5) are given by
04 D 04 −F
 −D T 0
04
04
4
Jd = 

 04
04 04
D
T
T
F
04 −D
04

T I4 04
04

1
I
04
 04
ρ 4
Qd = h 
 0
04 EII4
 4
04 04
04








,


04
04
04
1
Iρ 4





Rd = 



,








Bd = 

04 04 04
04 04 04
04 04 04
04 04 04
04×1 04×1
b44 04×1
04×1 04×1
b43 b44

04
04
04
04





,


(III.23)



,


53



Chapter III. Finite-dimensional observer-based boundary controllers: early-lumping approach

with
0 ···

.
1 
−1 1 . .

D= 2 . . .
h  .. . . . .
0 0 ···


1

b44

1
=
h

"

1 0 ···


.
1 
0 
1 1 ..


, F =
.
... 
2h 
 .. . . . . . .

1 4×4
0 0 ···
0





03×1
1

#

, b43

1
=
2

"

03×1
1

0



0
...
1







,

4×4

#

,

and h = 29 . Note that, nd is a design parameter and it has to be chosen multiple of 4 in this case.
In order to show the structure of the discretized model, we have considered nd = 16. However, for
the design we chose different values of nd . We show that increasing the precision of the model used
for design, the performances are improved. Note that, when changing nd , the model (III.5) preserves
2(b−a)
.
the same matrices (III.23) with appropriated dimensions and h = 0.5n
d +1
Step 3. The state feedback matrix K is designed with the linear quadratic regulator (LQR) method
using Matlab@ Control System Toolbox (lqr.m). Using this method, the desired control law minimizes
the cost function
JLQR =

Z ∞
0

{xT QLQR x + uT RLQR u + 2xT NLQR u}dt.

We develop three different OBSF controllers. In Table III.2, we show the design parameters. We
have changed the size of the OBSF controller (nd ) and the gain QLQR . The closed-loop matrices
Table III.2 – Design parameters.

nd
QLQR
RLQR
NLQR
Rc

Design 1

Design 2

Design 3

8
1I8
1I2
0
1I8

40
1I40
1I2
0
1I40

40
10I40
1I2
0
5I40

AK = Ad − Bd K are all Hurwitz.
Step 4. For simplicity, the matrix Rc is chosen as the identity multiply by a scalar as in Table
III.2. Note that, for the design 3, the value of Rc has been increased in order to achieve a faster
convergence of the observer than of the controller. For the three designs, the Hamiltonian matrix
HM has no eigenvalues on the imaginary axis.
Step 5. We solve the algebraic Riccati (III.16) with the method proposed in [Lanzon 08].
Step 6. We compute L = Q−1
c K. The matrices AL = Ad − LCd are all Hurwtiz. For the design
3, in Figure III.20, we show the obtained eigenvalues for the matrices AK and AL .
Finally, we simulate the closed-loop system between the OBSF controllers and a new discretized
model (III.5) that uses nd = 200, i.e. a more precise model of the BC-PHS (III.1). For the design
1, the closed-loop system is composed by 208 states, while for the designs 2 and 3 the closed-loop
system is composed by 240 states. For the design 3, the closed-loop eigenvalues are shown in Figure

54



III.6. Observer design for a specific state feedback

Figure III.20 – Plant λ(A), controller λ(AK ), and observer eigenvalues λ(AL ) for the design 3

III.21. The simulation starts from the initial condition
x1 (ζ, 0) = 0.2896 × 10−4 ,
x2 (ζ, 0) = 0,
x3 (ζ, 0) = −0.2702ζ + 0.0811,
x4 (ζ, 0) = 0,
corresponding to the equilibrium position associated to a force of 10N applied at the end tip of the
beam. The initial condition for the observer is x̂(0) = 0. Note that, the beam deformation and its
estimation are reconstructed from the state variables, considering that the beam and the observed one
are clamped at the left side.
In Figure III.22, we show the end-tip displacement of the beam for the three different designs.
We can notice that for design 1, some high-frequency modes are not attenuated. This is because they
are not considered in the design. However, these high-frequency mode do not destabilize the system
(due to the structure of the OBSF controller). The oscillations due to the high-frequency modes
are attenuated using the design 2. The only difference between design 1 and design 2 is the size of
the model used for design. With this new design, some high-frequency oscillations are attenuated.
Finally, using the design 3, most of the oscillations are reduced. This is mainly due to the increase
in the design parameter QLQR (See Table III.2).

55



Chapter III. Finite-dimensional observer-based boundary controllers: early-lumping approach

Figure III.21 – Closed-loop eigenvalues λ(ACL ) for the design 3

Figure III.22 – End tip deformation

Figure III.23 and Figure III.24 show the spatial and temporal responses for the design 1, Figure
III.25 and Figure III.26 show the spatial and temporal responses for the design 2, and Figure III.27
and Figure III.28 show the spatial and temporal responses for the design 3. The only difference

56



III.6. Observer design for a specific state feedback

between design 1 and 2 is the precision of the model used for design (see Table III.2). For this initial
conditions, the oscillations are reduced when using a more precise model for the OBSF controller.
Moreover, when increasing the gains QLQR and Rc (see design 3 of Table III.2), the oscillations are
reduced even more (see Figure III.27 and Figure III.28 for the design 3 and Figure III.25 and Figure
III.26 for the design 2).
In Figure III.23, we show the beam deformation along the time and the space for design 1. In
Figure III.24, we show the observed one. In these figures, it is more evident that the high-frequency
modes can not be attenuated, since the observer (Figure III.24) does not contain enough information
of the beam over the space.

Figure III.23 – Beam deformation (design 1)

Figure III.24 – Observed deformation (design 1)

In Figure III.25, we show the beam deformation along the time and the space for design 2. In
Figure III.26, we show the observed one. Now, since the OBSF controller uses more frequency modes
for describing the infinite-dimensional system than the one of design 1, these high-frequency modes
can be attenuated (see the end-tip response in Figure III.22 as well). Note that, the only difference
between design 1 and design 2 is the size of the discretized model used for the design (See Table
III.2). Then, both closed-loop systems have similar settling times. In order to reduce the settling
time, one can modify the design parameter QLQR as we show in the following for design 3.
In Figure III.27, we show the beam deformation along the time and the space for design 3. In
Figure III.28, we show the observed one. Now, since we have increased the design parameter QLQR ,
the convergence to zero is faster than for designs 1 and 2 (see the end-tip response in Figure III.22
as well).
♣

57



Chapter III. Finite-dimensional observer-based boundary controllers: early-lumping approach

Figure III.25 – Beam deformation (design 2)

Figure III.26 – Observed deformation (design 2)

Figure III.27 – Beam deformation (design 3)

Figure III.28 – Observed deformation (design 3)

III.7

State feedback design for a specific observer

Different to the previous section, the methodology proposed in this section allows to design the
observer gain L (as a dual problem of designing K) with different approaches like LQR [Anderson 07],
pole-placement [Brasch 70], control by interconnection using Casimirs [Ortega 08], or IDA-PBC
[Ortega 02, Prajna 02]. Then, by solving a set of linear matrix inequalities (LMIs), we perform the
state feedback gain K in order to satisfy the matching conditions of Proposition III.4.1. This section
is organized as follows. First, the methodology is proposed, and then, the Timoshenko beam is used
as example.

III.7.1

Design method

Since the pair (Ad , Cd ) is observable, the gain L of the observer is chosen with classical control
tools such that the following assumption is satisfied.
Assumption III.7.1. The gain L is designed such that Ad − LCd is Hurwitz.

58

♣



III.7. State feedback design for a specific observer

Remark III.7.1. In this case, the design of the observer gain is free and it can be achieved by using
traditional methods such as LQR design, pole-placement or the LMI proposed in [Prajna 02]. For
the last one, the details can be found in Appendix A.3.
♣
After the gain L is designed such that Assumption III.7.1 is satisfied, we design the feedback
gain K such that the matching conditions (III.11) are satisfied. The degrees of freedom of this
methodology are related to the lower and upper bounds of the matrices Rc and Qc from the OBSF
controller (III.9). In the following proposition, the design of the state feedback gain K is achieved
by tuning the lower and upper bounds of the matrices Rc and Qc .
Proposition III.7.1. Consider the finite-dimensional port-Hamiltonian system (III.5) and the matrix L such that AL := Ad − LCd is Hurwitz, if the following LMIs:
2Γ1 − Bd L> − LBd> + AL X + XA>
L ≤ 0,
−2Γ2 + Bd L> + LBd> − AL X − XA>
L ≤ 0,
−1
−∆1 + X ≤ 0,
∆−1
2 − X ≤ 0,

(III.24)

have a solution in the unknown matrix X = X> , for some nd × nd symmetric matrices Γ1 , Γ2 , ∆1
and ∆2 such that 0 ≤ Γ1 < Γ2 and 0 < ∆1 < ∆2 , then with the interconnection (III.10) between
(III.5) and (III.9) and matrices
Sc = AL X − Bd L> , Jc = 21 (Sc − Sc> ),
Rc = − 12 (Sc + Sc> ), Qc = X−1 ,
Bc = L,
K = Bc> Qc ,

(III.25)

the following results hold:
(i) lim (xd (t) − x̂(t)) = 0 with the performances given by the matrix AL ;
t→∞

(ii) Matrices Rc and Qc satisfy
(a) Γ1 ≤ Rc ≤ Γ2 ;
(b) ∆1 ≤ Qc ≤ ∆2 ;
(iii) The controller (III.9) is a finite-dimensional port-Hamiltonian system. Moreover, if Γ1 > 0,
it is SPR.
♦
Proof. Since the error is given by x̃(t) = x(t)− x̂(t), the result (i) in Proposition III.7.1 is equivalent
˙
to prove that the error x̃(t) converges asymptotically to zero. The error dynamic x̃(t)
is obtained
from (III.5) and (III.9). Then, replacing the interconnection (III.10) and matrices (III.25) the error
˙
dynamic becomes x̃(t)
= (Ad − LCd )x̃(t). Since AL = Ad − LCd is Hurwitz, the error converge
asymptotically to zero. For the result (ii), we check from the LMI (III.24) that
2Γ1 ≤ Bd L> + LBd> − AL X − XA>
L ≤ 2Γ2
∆2 −1 ≤ X ≤ ∆1 −1
Replacing X, Sc and Sc> from (III.25) and inverting the second inequality we obtain
2Γ1 ≤ −(Sc + Sc> ) ≤ 2Γ2
∆1 ≤ Qc ≤ ∆2

59



Chapter III. Finite-dimensional observer-based boundary controllers: early-lumping approach

then, replacing Rc from (III.25) we can conclude the result (ii). The controller (III.9) is a portHamiltonian system since Jc = −Jc> , Rc = Rc> ≥ 0 and Qc = Q>
c > 0 are satisfied from (III.25) and
(ii). Finally, by Lemma II.5.1 and Corollary II.5.2, the controller (III.9) is SPR if Rc > 0. The
matrix Rc is strictly positive definite if the matrix Γ1 so is.

Remark III.7.2. The simplest choice for Γ1 , Γ2 , ∆1 and ∆2 is to consider an identity matrix
multiplied by a scalar.
♣
Remark III.7.3. Although, the design parameters related to the matrix Rc are Γ1 and Γ2 , when
they are modified, the obtained matrix Qc is also. Similar for the design paramenters ∆1 and ∆2
that are related to the matrix Qc .
♣
The design is completed by using Proposition III.7.1. Then, we apply the OBSF controller (III.6)
to the BC-PHS (III.1). The closed-loop stability between the BC-PHS and the OBSF controller is
guaranteed due to the structure imposed to the OBSF controller. Since, it is SPR the closed-loop
system between the BC-PHS and the OBSF controller is asymptotically stable.
Theorem III.7.1. Consider the BC-PHS (III.1) and the control law (III.6) with K and L designed
using Proposition III.7.1. If Γ1 > 0, the closed-loop system converges asymptotically to zero for
r(t) = 0.
♦
Proof. The proof is a direct application of Theorem III.5.1. By Proposition III.7.1, Γ1 > 0 implies
Rc > 0. Since Rc is positive definite, the controller is SPR (See Corollary II.5.2).

In the following, we present a procedure for the design of the observer-based state feedback
controller proposed in this section.
Procedure III.7.1. The design procedure is summarized as follows:
Step 1: Represent the BC-PHS as in (III.1).
Step 2: Derive a finite-dimensional approximation P as in (III.5).
Step 3: Design L such that Ad − LCd is Hurwitz.
Step 4: Choose matrices Γ1 , Γ2 , ∆1 and ∆2 . For example, the identity by a positive constant.
Step 5: Solve the LMI (III.24) to find Qc .
Step 6: Implement the OBSF controller with K = LT Qc .
♣

III.7.2

Application example

In this subsection, the Timoshenko beam of Example II.3.3 is considered to apply the Procedure
III.7.1.
Example III.7.1. We consider the Timoshenko beam clamped at the left side and actuated at the
right side with force and torque actuators. We consider that the transverse velocity and angular
velocity are measured (see Example II.3.3). For simplicity, we use unitary parameters as in Table
III.3.

60



III.7. State feedback design for a specific observer

Table III.3 – Plant Parameters.

T
ρ
EI
Iρ
[a, b]

Value

Measurement unit

1
1
1
1
[0, 1]

Pa
kg.m−1
P a.m4
Kg.m2
m

In this case, Step 1 and Step 2 are the same as the ones given in the subsection III.6.2, with the
only difference on the plant parameters that in this case are given in Table III.3. Then, we continue
with Step 3 described in the previous section.
Step 3. The observer gain L is designed using IDA-PBC method proposed in [Prajna 02]. This
method uses linear matrix inequalities (LMIs) for solving the IDA-PBC problem for LTI systems.
It is worth stressing that the gain L can be designed using classical approaches like LQR or pole
placement. In this example, we use this approach to have a complete design based on LMIs. In
Appendix A.3, we recall the main Propositions of this method. For the design of L, we follow
Proposition A.3.2 from Appendix A.3. Note that, from Remark A.3.2 we have to replace Ad by ATd ,
Bd by CdT and F by −LT in order to obtain the matrix L.
Three different OBSF controllers are developed. The observer gains are designed using Proposition A.3.2 with the design parameters of Table III.4. Note that, for the observer, designs 1 and 2 are
equivalent and the design 3 uses a more precise model for the synthesis. The matrices AL = Ad −LCd
are all Hurwitz (in Figure III.29, we show the eigenvalues of the matrix AL for design 3).
Table III.4 – Observer design parameters.

Λ1
Λ2
Ξ1
Ξ2
γ
nd

Design1

Design 2

Design 3

0.1I20
5000I20
1I18
1000I18
10
5

0.1I20
5000I20
1I18
1000I18
10
5

0.1I40
5000I40
1I38
1000I38
10
10

Step 4. For simplicity, we chose the matrices Γ1 , Γ2 , ∆1 , and ∆2 as shown in Table III.5 for the
state feedback design. Note that, Γ1 > 0 in every case, and we only change the design parameters
related to the energy matrix Qc .
Step 5. The LMI from Proposition III.7.1 is solved using the Matlab@ Robust Control Toolbox.
Note that, in every case ∆1 < Qc < ∆2 and Γ1 < Rc < Γ2 .
Step 6. We compute K = LT Qc . The matrix AK = Ad − Bd K is Hurwitz. For the design 3, in
Figure III.29, we show the obtained eigenvalues for the matrices AK and AL .
Finally, we simulate the closed-loop system obtained using the OBSF state feedback controllers
and a new discretized model (III.5) that uses nd = 200, (a more precise model of the BC-PHS (III.1)).
For the designs 1 and 2, the closed-loop system is composed by 220 states, while for the design 3

61



Chapter III. Finite-dimensional observer-based boundary controllers: early-lumping approach

Table III.5 – Controller design parameters
Matrix

Design 1

Design 2

Design 3

Γ1
Γ2
∆1
∆2
nd

I20
1000I20
0.005I20
1I20
5

I20
1000I20
0.015I20
1I20
5

I40
1000I40
0.015I40
0.1I40
10

Figure III.29 – Plant λ(A), controller λ(AK ), and observer eigenvalues λ(AL ) (design 3)

the closed-loop system is composed by 240 states. For the design 3, the closed-loop eigenvalues are
shown in Figure III.30. The simulation starts from the initial condition
x1 (ζ, 0) = 0.01,
x2 (ζ, 0) = 0,
x3 (ζ, 0) = −0.01(ζ − 1),
x4 (ζ, 0) = 0,
corresponding to the equilibrium position associated to a force of 0.01N applied at the end tip of the
beam. The initial condition for the observer is x̂(0) = 0.
In Figure III.31, we show the end-tip displacement of the beam for the three different designs.
We can notice that the settling time of design 2 is faster than the one of design 1. This is because
the design parameter ∆1 is bigger in design 2 than in design 1. This implies a matrix Qc with bigger

62



III.7. State feedback design for a specific observer

Figure III.30 – Closed-loop eigenvalues λ(ACL ) (design 3)

eigenvalues for design 2 than design 1. Finally, using design 3, we can notice that high-frequency
oscillations are attenuated. This is because the model used in design 3 is more precise than the one
used for design 2.

Figure III.31 – End tip deformation

63



Chapter III. Finite-dimensional observer-based boundary controllers: early-lumping approach

In Figure III.32 and Figure III.33, we show the beam deformation along the space and the time
for design 1. The settling time is improved using design 2 as shown in Figure III.34 and Figure
III.35. We can notice that the beam reaches the equilibrium approximately at t = 6 s. For t > 6 s,
some high-frequency oscillations remain unattenuated. However, due to the structure imposed on the
OBSF controller, these oscillations do not destabilize the closed-loop system.

Figure III.32 – Beam deformation

Figure III.33 – Observed deformation

Figure III.34 – Beam deformation

Figure III.35 – Observed deformation

Finally, in Figure III.36 and Figure III.37, we show the beam deformation along the space and
time for design 3. The main difference with design 2 is that in design 3, the OBSF controller
contains a more accurate model of the infinite-dimensional system. By increasing nd (see Table III.4
and Table III.5), some higher frequency oscillations can also be attenuated.

64



III.8. Extension to a class of nonlinear systems

Figure III.36 – Beam deformation

Figure III.37 – Observed deformation
♣

III.8

Extension to a class of nonlinear systems

The strictly positive real (SPR) structure imposed to the OBSF controller in Section III.4 can be
advantageously used to stabilize a wide class of systems. In Section III.5, we have shown that, due
to that structure, the OBSF controller can stabilize a boundary controlled port-Hamiltonian system
(BC-PHS). In this section, we show that the same structure can stabilize a class of nonlinear time
invariant (NTI) systems. This class is restricted to the NTI systems that are output strictly passive
(OSP) and zero state detectable (ZSD). Then, we sow that the OBSF controller can be designed on
a linear approximation of the NTI system using the same design methodologies proposed in Section
III.6 and Section III.7. Finally, we show that when applying the OBSF controller to the NTI system,
the stability is preserved.

III.8.1

Design method

In this section, we consider the following finite-dimensional nonlinear system:
P


ẋ(t)
y(t)

= f (x(t), u(t)),
= h(x(t), u(t)),

x(0) = x0

(III.26)

with x(t) ∈ Rn , x0 ∈ Rn , u(t) ∈ Rm , y(t) ∈ Rm and f (·) and h(·) sufficiently smooth differentiable
mappings. The NTI system (III.26) is restricted to the class of nonlinear systems that are OSP and
ZSD. In the following, we define these two characteristics.
Definition III.8.1. [van der Schaft 00, Definition 3.1.4] The nonlinear system (III.26) is output
strictly passive (OSP) if there exists  > 0 such that it is dissipative with respect to the supply rate
s(u, y) = u> y − kyk2 .
♣

65



Chapter III. Finite-dimensional observer-based boundary controllers: early-lumping approach

Definition III.8.2. [van der Schaft 00, Definition 3.2.15] The nonlinear system (III.26) is zero
state detectable (ZSD) if u(t) = 0, y(t) = 0, ∀t ≥ 0, implies limt→∞ x(t) = 0.
♣
We consider that the nonlinear system (III.26) is first linearized around an operational point.
Then, the OBSF controller is designed on the linear approximation. Finally, the closed-loop stability
is shown to be asymptotic when applying the OBSF controller to the nonlinear system. The following
assumption is considered concerning the linearization.
Assumption III.8.1. There exists a linear approximation of the NTI system (III.26) around the
steady state x = x∗ , u = u∗ and y = y ∗ with the following structure

x˙

= Axδ (t) + Buδ (t)
δ (t)
P
yδ (t) = Cxδ (t)

(III.27)

where xδ (t) = x(t) − x∗ , uδ (t) = u(t) − u∗ and yδ (t) = y(t) − y ∗ . A ∈ Rn×n , B ∈ Rn×m , and
C ∈ Rm×n . Furthermore, we assume (III.27) to be controllable and observable. For simplicity, we
refer to the system (A, B, C) as the approximated model of (III.26).
♣
e1 (t)

u1 (t)

P

y2 (t)

C

y1 (t)

u2 (t)

e2 (t)

Figure III.38 – Passive interconnection.

Now, we show that, using the same approaches than the ones of the previous sections, we can
design an OBSF controller on the linearized model (III.27). Then, we show that when applying
the OBSF to the NTI system (III.26), the closed-loop stability is preserved. To this end, we recall
a Proposition from [van der Schaft 00], wherein the asymptotic stability of a closed-loop system
resulting from the power preserving interconnection between two OSP and ZSD systems is guaranteed. Figure III.38 shows the power preserving interconnection, where P represents the NTI system
(III.26) and C represents the linear controller.
Proposition III.8.1. [van der Schaft 00, Proposition 4.3.1] Assume that for every pair of allowed
external input functions e1 (·), e2 (·) there exist allowed input functions u1 (·), u2 (·) of the closed-loop
system of Figure III.38. Suppose that P and C are OSP and ZSD, and that S1 , S2 satisfying
S1 (x1 (t1 )) ≤ S1 (x1 (t0 )) +
S2 (x2 (t1 )) ≤ S2 (x2 (t0 )) +

Z t1 h
t0

Z t1 h
t0

i

u1 (t)T y1 (t) − ε1 ky1 (t)k2 dt
(III.28)
i

u2 (t)T y2 (t) − ε2 ky2 (t)k2 dt

with ε1 > 0 and ε2 > 0, S1 and S2 are C 1 and have strict local minima at x∗1 = 0, respectively x∗2 = 0.
Then, x1 = 0 and x2 = 0 is an asymptotically stable equilibrium when e1 = e2 = 0.
♦

66



III.8. Extension to a class of nonlinear systems

Using Proposition III.8.1, we can show that the OBSF controller of the previous sections can
stabilize a class of NTI systems. Indeed, if the the finite-dimensional controller (III.9) is designed
using either Proposition III.6.1 or Proposition III.7.1, then we can show that the controller is OSP
and ZSD. Finally, if the nonlinear system (III.26) is OSP and ZSD also, then the closed-loop system
is asymptotically stable.
Proposition III.8.2. Consider the dynamic controller (III.9). If Rc > 0, then (III.9) is strictly
positive real (SPR), output strictly passive (OSP) and zero state detectable (ZSD) with respect to the
input uc and output yc .
♦
Proof. The SPR property is a direct application of Corollary II.5.2. The OSP property follows
noting that Rc > 0 and the Hamiltonian of the controller Hc = 21 x>
c Qc xc satisfies
>
>
Ḣc = −x>
c Qc Rc Qc xc + yc uc
>
>
2
= −x>
c Qc (Rc − Bc Bc )Qc xc + yc uc − kyc k

(III.29)

where we have added ±yc> yc , with  > 0, to the first line of (III.29) and used yc = Bc> Qc xc and
Qc = Q>
c in the second line of (III.29). Hence it is always possible to find a small enough  such that
(III.9) is dissipative with respect to the supply rate yc> uc − kyc k2 , implying that (III.9) is OSP. The
ZSD property is inferred from (III.29) setting uc = yc = Bc> Qc xc = 0 and noting that since Rc > 0,
the states of (III.9) converge exponentially to zero.

Finally, we add the following proposition, where the two design methods provided in the previous
sections (Proposition III.6.1 and Proposition III.7.1) are suitable for the design of a linear OBSF
controller for the NTI system (III.26).
Proposition III.8.3. Consider the nonlinear system (III.26) and assume that is OSP and ZSD.
Consider also, the control law given by
uδ (t) = −K x̂δ (t) + rδ (t)
x̂˙ δ (t) = Ax̂δ (t) + Buδ (t) + L(yδ (t) − C x̂δ (t)),

(III.30a)
x̂δ (0) = x̂δ0 ,

(III.30b)

with (A, B, C) from Assumption III.8.1. If K and L are designed either by Proposition III.6.1 or
by Proposition III.7.1 (with Ad = A, Bd = B, and Cd = C), and the Hamiltonian has a minimum
in x = x∗ = 0, then x = 0 is an asymptotically stable equilibrium of the closed-loop system when
rδ (t) = 0.
♦
Proof. This proposition is a direct application of Proposition III.8.1. Indeed, from Proposition
III.8.1, one can take e1 = e2 = 0, x1 = x, x2 = x̂δ , S1 (x1 ) = H(x), S2 (x2 ) = Hc (x̂δ ) = 12 x̂Tδ Qc x̂δ ,
u1 = u, y1 = y, u2 = uc = yδ and y2 = yc = −uδ . We assume that the nonlinear system (III.26) is
OSP and ZSD. From Proposition III.8.2 we know that the observer-based controller (III.30) is OSP
and ZSD if the matrix Rc is positive define. Using both Propositions III.6.1 and III.7.1, the matrix
Rc is always positive define. Then, we have the passive interconnection between two OSP and ZSD
systems, which implies that the closed-loop system is asymptotically stable.


67



Chapter III. Finite-dimensional observer-based boundary controllers: early-lumping approach

III.8.2

Application example

In the following example, we use a Microelectromechanical systems (MEMSs) to exemplify the
finite-dimensional nonlinear case. We follow Procedure III.7.1 for the design of an OBSF controller
for the MEMS.
Example III.8.1. We consider the MEMS of Figure III.39, where q(t) is the deformation of the non
linear spring with spring coefficients k1 and k2 , p(t) is the momentum of the moving mass m, and
Q(t) is the charge in the capacitor C(q(t)) that depends on the spring deformation. b is the damping
coefficient of the damper, r is resistance of the circuit, and u(t) is the voltage input considered as
an actuator.

k1 , k2

b
r

q(t)

m
u(t)

C(q)

Figure III.39 – Microelectromechanical systems (MEMS)

The nonlinearities are due to the capacitance C(q(t)) and the spring force Fk (q(t)) given by:
εAs
,
qmax − q(t)
Fk (q(t)) = k1 q(t) + k2 q(t)3 ,
C(q(t)) =

where ε is the dielectric constant, As is the surface of the MEMS and qmax is such that q(t) < qmax .
The parameters of the system are shown in Table III.6.
Table III.6 – Plant Parameters.
Value
k1
k2
m
ε
As
qmax
b
r

68

0.46
1 × 1011
2.4 × 10−8
8.854 × 10−12
4 × 10−4
10−5
10−7
0.5 × 106

Unit
Nm−1
Nm−3
kg
Fm−1
m2
m
Ns
Ω



III.8. Extension to a class of nonlinear systems

Step 1. We consider the port-Hamiltonian representation [Venkatraman 10b], where the Hamiltonian is given by
1
Q(t)2
p(t)2 1
+ k1 q(t)2 + k2 q(t)4 +
.
H(t) =
2m
2
4
2C(q(t))
The dynamical model of the MEMS is
 



q̇
0
1

 
 ṗ  = −1 −b
0
0
Q̇
y=

  ∂H 

 









0  ∂q 
0
q(0)
q0

 
  ∂H   

0   ∂p  +  0  u,  p(0)  =  p0  ,
−1
1
∂H
Q(0)
Q0
r
r
∂Q

(III.31)

1 ∂H
r ∂Q

where the input of the system is the voltage u(t) and the output is the supplied current y(t). q0 , p0 ,
Q0 are the initial conditions of the system. The balance equation of the Hamiltonian is given by
p(t)
Ḣ(t) = −b
m

!2

− ry(t)2 + y(t)u(t)

which implies that the system is OSP. Assuming Q(t) > 0 for all t > 0, the system is ZSD.
Step 2. The linearization of (III.31) is done around the equilibrium point defined in Table III.7.
The linearized model is on the form of (III.27) with the following matrices
Table III.7 – Linearization point.
Value
q∗
p∗
Q∗
u∗
y∗

0.5 × 10−6
0
−11
4.1445 × 10
0.1112
2.2234 × 10−8



A=

0



−3k2 (q ∗ )2



Q∗

− k1

0

As εr
 

0

B=

 
0 ,
1
r

1
m
b
−
m

Unit
m
kg m s−1
C
V
A



0


Q∗



A
ε

s
q ∗ − qmax 
As εr

−Q∗
−q ∗ − qmax
C=
0
As εr
As εr


(III.32)


The linearized model approaches the nonlinear one near the equilibrium point. To show the influence
of the nonlinearities, we simulate the nonlinear model and the linearized one in open loop with a
step input, which moves away the system from the linearization point. Figure III.40 shows the step
input u(t), the output response of the nonlinear system y(t) and the linearized one yδ (t), and the

69



Chapter III. Finite-dimensional observer-based boundary controllers: early-lumping approach

Figure III.40 – Top: Energy response in open loop. Middle: Output response of the nonlinear
model (blue) and the linearized one (red). Bottom: Applied input.

Hamiltonian H(t). We can see that the output of the linearized system reaches the same equilibrium
as the output of the nonlinear one. However, during the transition the linearized system differs from
the nonlinear one.
Figure III.41 shows the state response of the nonlinear system and the linearized one to a step
input in open loop. The top figure shows the deformation of the string q(t) and the linearized one
qδ (t). The middle figure shows the momentum of the mass p(t) and the linearized one pδ (t). And
the bottom figure shows the charge in the capacitor Q(t) and the linearized one Qδ (t). Since, we take
away the system from the linearization point, the reached equilibrium of the linearized model is not
the same as the one of the nonlinear one (Top and bottom figures of Figure III.41). Also, in the
middle figure (Figure III.41), we can see changes in frequency that are characteristic of nonlinear
systems. In this particular example, this change of frequency is due to the high value of the spring
coefficient k2 in Table III.6.
The linearized model (III.27), with matrices (III.32) is used for the synthesis of the OBSF controller. Similar as the previous example, the gain L is designed using the IDA-PBC approach of
[Prajna 02]. Then, we use Proposition III.7.1 for design of the state feedback gain K. In this way,
the complete design is based on LMIs.
Step 3. The Luenberger gain L is designed using the LMI method proposed in [Prajna 02]. We
follow Propositions A.3.2 from Appendix A.3 with the observer design parameters of Table III.8.
Note that, from Remark A.3.2 we have to replace A by AT , B by C T and F by −LT in order to

70



III.8. Extension to a class of nonlinear systems

Figure III.41 – State response in open loop of the nonlinear model (blue) and the linearized one
(red)

obtain the matrix L. The eigenvalues of the matrix A are shown in Figure III.42 as well as the
eigenvalues of the obtained matrix AL = A − LC. Note that, we can move the eigenvalues of AL
along the real axis by changing the design parameter γ (Table III.8).
Table III.8 – Observer design parameters
Matrix
Λ1
Λ2
Ξ1
Ξ2
γ

Value
1 × 10−2 × diag([1, 200, 1])
1 × 1010 I3
1 × 10−1 I2
1 × 104 I2
30 × 104

As well as before, we simulate the open loop system composed by the nonlinear system and the
observer. We use the same step input as before (Figure III.40). In Figure III.43, we show the state
response of the nonlinear system in open loop (blue line), the linearized one (red line), and observed
one (yellow line). In this case, the observer is initialized such that it is not at the linearization point
(x̂δ (0) 6= 0), and it considers as measurement the nonlinear output. Then, due to the nonlinearities,
the error between the nonlinear system and the observer (x̃(t) = x(t) − x̂(t)) is different to zero
during the transitional period as shown in Figure III.44.

71



Chapter III. Finite-dimensional observer-based boundary controllers: early-lumping approach

Figure III.42 – Plant λ(A), observer λ(AL ), controller 1 λ(AK1 ), and controller 2 λ(AK2 )
eigenvalues.

In the following, we design the state feedback gain using Proposition III.7.1. The benefit of using
this proposition is that even if the state of the observer does not converge to the state of the nonlinear
system (when the state is far from the linearization point), the closed-loop stability is guaranteed when
applying the OBSF controller to the NTI system. Moreover, since the observer is more precise when
it is closer to the linearization point, the performances can be assigned near this point.
Step 4. In order to show the different performances that can be achieved, we design two state
feedback matrices K1 and K2 using the same observer gain obtained in Step 3. We use Proposition
III.7.1 and for simplicity, we choose the matrices Γ1 , Γ2 , ∆1 , and ∆2 as in Table III.9. Note that,
the only difference on the design is given by ∆1 , implying bigger eigenvalues for the matrix Qc in
design 2 than design 1.
Table III.9 – Controller design parameters
Matrix
Γ1
Γ2
∆1
∆2

72

Design 1

Design 2

1 × 10−10 I3
1 × 1010 I3
0.1I3
1 × 1010 I3

1 × 10−10 I3
1 × 1010 I3
0.3I3
1 × 1010 I3



III.8. Extension to a class of nonlinear systems

Figure III.43 – State response in open loop of the nonlinear model (blue), the linearized one (red),
and the observed one (red).

Step 5. The LMI from Proposition III.7.1 is solved with Ad = A, Bd = B, Cd = C using the
Matlab@ Robust Control Toolbox. For design 1, we obtain the following eigenvalues for the matrices
Jc , Rc and Qc




+30.3578i

λ(Jc ) = 
−30.3578i ,
0

3.6621 × 104


0.0359
λ(Rc ) = 
,
−7
4.8491 × 10




2.2934 × 109

λ(Qc ) = 4.0314 × 104 
,
0.1217




and for design 2, the following eigenvalues are obtained




+13.5810i

−13.5810i
λ(Jc ) = 

,
0

4.9313 × 103


0.0287
λ(Rc ) = 
,
−8
2.3287 × 10




8.1510 × 109

λ(Qc ) = 1.0215 × 105 
.
0.3055




Since (III.31) is OSP and ZSD and for booth controllers Γ1 > 0 (Rc > 0), the closed-loop system
between the nonlinear system and the OBSF controller is asymptotically stable by Proposition III.8.3.
Step 6. We compute K = LT Qc . The eigenvalues of AK = A − BK are shown in Figure III.42
for the two cases, where K1 and K2 are the gain obtained for design 1 and 2, respectively.
In Figures III.45, we show the state response using design 1. We show three different behaviors
along the time. First, since the state of the nonlinear system is initialized at the linearization point
and the observer is not, the initial behavior is due to both, the observer and controller. Then, at

73



Chapter III. Finite-dimensional observer-based boundary controllers: early-lumping approach

Figure III.44 – Error between the states of the nonlinear system and the states of the observer in
open loop.

t = 0.0125 s an external output is applied to change the equilibrium position. In this case, the behavior
is mainly due to the controller. Since, the new equilibrium position is different to the linearization
point, the nonlinear state achieves a different equilibrium position than the observed one. Even so,
closed-loop stability is preserved. Finally, when the state goes closer to the equilibrium position, the
observer state approaches the states of the nonlinear system, and the performances are closer to the
desired ones. In Figure III.46, we show the input and output responses for design 1. We can see
that the output of the nonlinear system achieves the same value of the output of the observer, even
far from the linearization point.

74



III.8. Extension to a class of nonlinear systems

Figure III.45 – Design 1. State variable of the nonlinear system (blue) and state variable of the
observer (red).

Figure III.46 – Design 1. Output of the nonlinear system (blue), output of the observer (red), and
control law (bottom figure).

Similarly, in Figure III.47 and Figure III.48, we show the results for design 2. The main difference between design 1 and design 2 is the design parameter ∆1 (See Table III.9). This implies
bigger eigenvalues of the matrix Qc for design 2 than design 1. In this case, when increasing the
eigenvalues of Qc we obtain a faster response but with overshoot.

75



Chapter III. Finite-dimensional observer-based boundary controllers: early-lumping approach

Figure III.47 – Design 2. State variable of the nonlinear system (blue) and state variable of the
observer (red).

Figure III.48 – Design 2. Output of the nonlinear system (blue), output of the observer (red), and
control law (bottom figure)

♣

76



III.9. Conclusions

III.9

Conclusions

In this chapter, we have used the early-lumping approach to design OBSF controllers for the
stabilization of BC-PHSs. Using this approach, the BC-PHS is first discretized and the synthesis
of the OBSF gains is based on the discretized model. Using an example, we have shown that if
the OBSF gains are designed using classical control tools (like LQR or pole placement), then the
closed-loop stability is not guaranteed when the OBSF controller is applied to the BC-PHS. Indeed,
some high-frequency modes are destabilized by the OBSF controller, since they are not considered
during the design.
To guarantee the closed-loop stability, we have imposed a passive structure on the OBSF controller. We have shown that using this structure, the OBSF controller stabilizes the BC-PHS. Then,
we have proposed two methodologies for the synthesis of the OBSF gains. In the first method,
the state feedback gain is freely designed by using classical control techniques, for instance, linear
quadratic regulator or pole placement. Then, the observer gain is designed such that either the OBSF
controller achieves a passive structure and some performances are assigned to the observer. In the
second method, the observer gain is freely designed and the state feedback gain is designed such that
either the OBSF controller achieves the desired structure and some performances are assigned to the
state feedback gain. In both cases, the design of one of the two gains (K or L) is not completely free.
This is the price to pay to achieve closed-loop stability when applying the OBSF controller to the
BC-PHS. To exemplify these methodologies, we have used the vibrating string and the Timoshenko
beam models.
We have extended this result to a class of nonlinear time-invariant (NTI) systems. We have
shown that the proposed OBSF controller is output strictly passive (OSP) and zero state detectable
(ZSD). Then, the OBSF controller can stabilize nonlinear systems that are OSP and ZSD too. In this
way, the synthesis of the OBSF gains can be developed using the aforementioned methodologies.
In this case, the synthesis is based on a linearized model. We have shown that when applying
the OBSF controller to the NTI system, the closed-loop stability is guaranteed. We have used a
microelectromechanical system to exemplify the synthesis method.

77





Chapter IV
Infinite-dimensional observer-based boundary
controllers: late-lumping approach

IV.1

Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 80

IV.2

Preliminaries . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 82

IV.3

Infinite-dimensional observers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
IV.3.1 The co-energy variables are measured . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
IV.3.2 The integral over time of the co-energy variables are measured . . . . . . . . . . . .
IV.3.3 The co-energy variables and their integrals over time are both measured. . . .

84
84
91
98

IV.4

Observer-based damping injection: application to the vibrating string . . . . 105
IV.4.1 Fully actuated string with a force sensor . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 105
IV.4.2 Fully actuated string with a displacement sensor. . . . . . . . . . . . . . . . . . . . . . . . 111

IV.5

Observer-based damping injection and energy shaping: application to the
vibrating string . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 120

IV.6

Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 124

79



Chapter IV. Infinite-dimensional observer-based boundary controllers: late-lumping approach

IV.1

Introduction

Some first steps towards the design of observer-based control laws for impedance energy preserving boundary controlled port-Hamiltonian systems (BC-PHSs) [Le Gorrec 05] are presented in this
chapter using the late-lumping approach. Using this approach, the observer is an infinite-dimensional
system, and it has to be discretized for the real-time implementation.
First, we propose a general setting for the design of infinite-dimensional observers [Demetriou 04,
Smyshlyaev 05, Hidayat 11, Meurer 13] for the class of impedance energy preserving BC-PHSs
[Toledo 20, Malzer 20a]. The infinite-dimensional observer is designed in the case when the conjugated output is measured and in the case when the conjugated output is not measured but the
integral over time of it is. Note that, we define the conjugated output with respect to the input such
that the power of the system is given by the multiplication between the input and the conjugated
output. In this chapter, we cover the cases in which either velocities, forces or displacements are
measured in mechanical systems. To exemplify, we use the vibrating string with different kinds of
sensors (force, velocity and displacement sensors) and the Timoshenko beam in the case where the
transverse displacement and the rotation angle are measured at the end tip of the beam.
Then, we use these infinite-dimensional observers to apply control by damping injection and
energy shaping [Schöberl 12, Macchelli 17] using the observed values [Malzer 20b]. For simplicity,
we use the vibrating string example to illustrate these observer-based control techniques. First, we
apply observer-based damping injection at both sides of the vibrating string with the measurement
available only at one side of the spatial domain. This control strategy allows adding additional
damping at the unmeasured side of the string. In this case, the settling time is smaller than when
only one side damping is applied. We study the case when a force sensor is available and the case
when a displacement sensor is available. Finally, we apply energy shaping and damping injection
to the vibrating string using the observed values of the infinite-dimensional observer. In this case,
we consider the vibrating string attached at one side and with a force actuator and velocity sensor
at the other side. This control law allows to shape the closed-loop energy and does not require a
proper initialization of the observer-based controller.
This chapter is organized as follows: in Section IV.2, we present the BC-PHS of interest, the
observer structure and the resulting error system. In Section IV.3, we propose infinite-dimensional
observers to estimate the state variables of the BC-PHS when different measurements are available.
In Section IV.4, we consider the vibrating string, and we apply damping injection using the observed
values when the force is measured on the left side and when the displacement is measured on the
right side. In Section IV.5, we present some first steps towards observer-based energy shaping and
damping injection for the vibrating string example. Some conclusion and future work are proposed
in Section IV.6.

Scope of this chapter
Concerning the design of the infinite-dimensional observers presented in this chapter, in Table
IV.1 and Table IV.2, we present an overview of the achievable examples related to the vibrating
string and the Timoshenko beam, respectively. For the vibrating string, F (a, t) is the force at ζ = a,
v(b, t) is the velocity at ζ = b and w(b, t) is the displacement at ζ = b. For the Timoshenko beam,

80



IV.1. Introduction

F (a, t) is the force at ζ = a, T (a, t) is the torque at ζ = a, v(b, t) is the velocity at ζ = b and,
ω(b, t) is the angular velocity at ζ = b, w(b, t) is the displacement at ζ = b, and φ(b, t) is the angular
displacement at ζ = b.
Table IV.1 – Scope of the observers for the vibrating string of this chapter
Measurements

Convergence

F (a, t), v(b, t)
F (a, t)
w(b, t)
w(b, t), v(b, t)

Exponential
Exponential
Asymptotic
Exponential

Example

Proposition

Example IV.3.1 Proposition IV.3.1
Example IV.3.1 Proposition IV.3.2
Example IV.3.2 Proposition IV.3.3
Section IV.3.4 Proposition IV.3.4

Table IV.2 – Scope of the observers for the Timoshenko beam of this chapter
Measurements

Convergence

F (a, t), T (a, t)
v(b, t), ω(b, t)
w(b, t), φ(b, t)

Exponential
Exponential
Asymptotic

Example

Proposition

Proposition IV.3.2
Proposition IV.3.2
Section IV.3.3 Proposition IV.3.3

Similarly, in Table IV.3, we present an overview of the results concerning observer-based damping
injection and energy shaping for the vibrating string. In this table, we show the type of sensors, the
type of actuators, the closed-loop stability and the control strategy. In this case, F (a, t) is the force
at ζ = a, F (b, t) is the force at ζ = b, w(b, t) is the displacement at ζ = b, v(a, t) is the velocity at
ζ = a, and v(b, t) is the velocity at ζ = b.
Table IV.3 – Control scope for the vibrating string
Sensors

Actuators

Stability

Control law

Section

F (a, t)
w(b, t)
v(b, t)

v(a, t), F (b, t) Exponential Damping injection (DI) Section IV.4.1
v(a, t), F (b, t) Asymptotic Damping injection (DI) Section IV.4.2
F (b, t)
Asymptotic
Energy shaping + DI
Section IV.5

81



Chapter IV. Infinite-dimensional observer-based boundary controllers: late-lumping approach

IV.2

Preliminaries

We consider the following BC-PHS:

∂
∂x



(ζ,
t)
=
P
(H(ζ)x(ζ, t)) + P0 H(ζ)x(ζ, t),
1


∂ζ
 ∂t 




x(ζ, 0) = x0 (ζ),

f∂ (t)
P WB e∂ (t) = u(t),


f∂ (t)



y(t) = WC e∂ (t) ,





(IV.1)

ym (t) = Cm x(ζ, t),

where ζ ∈ [a, b] is the spatial variable and t ≥ 0 is the time variable. x(ζ, t) ∈ Rn is the state variable
with initial condition x0 (ζ). P1 = P1T ∈ Mn (R) is a non-singular matrix, P0 = −P0T ∈ Mn (R), H(·) ∈
Mn (L2 ([a, b]; R)) is a bounded and continuously differentiable matrix-valued function satisfying for
all ζ ∈ [a, b], H(ζ) = HT (ζ) and mI < H(ζ) < M I with 0 < m < M both scalars independent of ζ.
The Hamiltonian of the BC-PHS (IV.1) is given by
1Z b
H(t) =
x(ζ, t)T H(ζ)x(ζ, t)dζ.
2 a

(IV.2)

The boundary port variables [Le Gorrec 05] associated to the BC-PHS (IV.1) are obtained such that
Ḣ = f∂ (t)T e∂ (t) as follows:
!

1 P1 −P1
f∂ (t)
=√
e∂ (t)
I
2 I

!

!

H(b)x(b, t)
.
H(a)x(a, t)

(IV.3)




WB is defined such that it has full rank and satisfies WB ΣWBT = 0, with Σ = 0Inn 0Inn . WC is defined
such that (IV.1) is an impedance energy preserving system, i.e. WC ΣWCT = 0 and WC ΣWBT = I.
Finally, u(t) ∈ Rn is the input, y(t) ∈ Rn is the conjugated output, and ym (t) ∈ Rp is the measured
output, with Cm a boundary operator which maps the state into the measured variables located at
the spatial boundaries of the domain of ζ.
Definition IV.2.1. The following infinite-dimensional system:

∂ x̂
∂



(ζ, t) = P1 (Hx̂(ζ, t)) + P0 (Hx̂(ζ, t)),



∂ζ
 ∂t 



fˆ∂ (t)
P̂ WB ê∂ (t) = û(t),



fˆ∂ (t)

ŷ(t)
=
W
,

C

ê∂ (t)





x̂(ζ, 0) = x̂0 (ζ)
(IV.4)

ŷm (t) = Cm x̂(ζ, t),

is an observer of the BC-PHS (IV.1) if x̂(ζ, t) converge to x(ζ, t) for some initial condition x̂0 (ζ) 6=
x
(ζ). P , P0 , H, WB , WC , and Cm are defined in (IV.1), and the observer boundary port variables
 0ˆ  1
f∂ (t)
are defined in the same way as in (IV.3).
♣
ê (t)
∂

Since the system P̂ in (IV.4) is virtual, the input û(t) is designed with all the available information, i.e. û(t) = f (u(t), ym (t), x̂(ζ, t)), where u(t) and ym (t) are considered known from (IV.1) and
f (·) is a function to be designed. In the following section, we design this function for different types

82



IV.2. Preliminaries

of measurements ym (t). To analyze the convergence of the observer, it is convenient to analyze the
error between the state of (IV.1) and the state of (IV.4). To this end, we define the error between
the BC-PHS (IV.1) and the observer (IV.4) as:
x̃(ζ, t) := x(ζ, t) − x̂(ζ, t).

(IV.5)

Then, from (IV.1) and (IV.4), we obtain the error dynamics equations as follows:

∂
∂ x̃


(ζ, t) = P1 (Hx̃(ζ, t)) + P0 (Hx̃(ζ, t)),


 ∂t 
∂ζ

P̃ WB f˜∂ (t) = ũ(t),

ẽ∂ (t) 




ỹ(t) = W f˜∂ (t) .
C

x̃(ζ, 0) = x̃0 (ζ)
(IV.6)

ẽ∂ (t)

We define the Hamiltonian of the error system as:
1
1Z b
H̃(t) = kx̃(t)k2H =
x̃(ζ, t)T H(ζ)x̃(ζ, t)dζ.
2
2 a

(IV.7)

Since WB and WC are such that WC ΣWBT = I, the time derivative of H̃(t) satisfies
˙
H̃(t)
= ũ(t)T ỹ(t).

(IV.8)

An important property of BC-PHS is shown in the following theorem. This property is in general
used for showing the exponential stability of BC-PHSs. In this chapter, we use it for showing that
the error system is exponentially stable for different kinds of observers. This theorem states that the
Hamiltonian of the error system H̃(t) is bounded by the integral over time of the co-energy variables
evaluated at the spatial boundaries.
Theorem
IV.2.1.
the error system (IV.6) with WB such that WB ΣWBT ≥ 0 and Σ =
 ˜ Consider



f∂ (t)
0n In
1
2
In 0n . If WB ẽ∂ (t) = 0, for all t ≥ 0, then the Hamiltonian of the error system H̃(t) = 2 kx̃(t)kH
satisfies for τ large enough
H̃(τ ) ≤ c(τ )

Z τ
0

H̃(τ ) ≤ c(τ )

Z τ
0

kH(b)x̃(b, t)k2R dt,

and
(IV.9)

kH(a)x̃(a, t)k2R dt

where c(τ ) is a constant that only depends on τ .

♦

Proof. This result is a direct application of [Villegas 07, Theorem 5.17] to the error system (IV.6).

Remark IV.2.1. Note that, we consider BC-PHSs (IV.1) that are impedance energy preserving
systems, i.e. WB ΣWBT = WC ΣWCT = 0 and WC ΣWBT = I. Then, the condition of Theorem IV.2.1
are satisfied. Moreover, even if WB ΣWBT ≥ 0, we can use Theorem IV.2.1. We use this property in
the following section to show the exponential convergence of the proposed observers.
♣

83



Chapter IV. Infinite-dimensional observer-based boundary controllers: late-lumping approach

IV.3

Infinite-dimensional observers

In this section, the synthesis of infinite-dimensional observers for BC-PHSs is studied. The aim
of these observers is to reconstruct the overall state from partial measurement. We consider three
different cases depending on the nature of the measurements. First, we consider the case where we
can measure the conjugated output or a part of it. This is the case for instance, when the velocity
can be measured in a vibrating string. Then, we consider the case where the conjugated output is
not available but its integral over time is. This is the case for instance, when the deformation is
measured instead of the velocity in a vibrating string. Finally, we consider the case where both are
measured together.

IV.3.1

The co-energy variables are measured

When the full conjugated output y(t) (co-energy variables) from (IV.1) is measured, it is straightforward to design an exponential convergent observer for the BC-PHS (IV.1). Indeed, the observer
design problem is equivalent to the damping injection approach for BC-PHS. In the following proposition, the convergence of the observer (IV.4) is guaranteed to be exponentially when the full conjugated output is measured.
Proposition IV.3.1. Consider the BC-PHS (IV.1). Assume that the full conjugated output is
measurable, i.e. ym (t) = y(t). The state of the observer (IV.4) with
û(t) = u(t) + L(ym (t) − ŷm (t)),

(IV.10)

converge exponentially to the state of the BC-PHS (IV.1) if 0 < L + LT ∈ Rn×n .
♦
Proof. This is an application case of [Villegas 07, Theorem 5.17]. We show the exponential convergence of the observer by showing that the error (IV.5) converges to zero exponentially. Using (IV.10)
in the observer (IV.4), the input of the error system (IV.6) reads
ũ(t) = −Lỹ(t),

(IV.11)

˙
H̃(t)
= −ỹ(t)T Lỹ(t).

(IV.12)

and the balance equation (IV.8) becomes

Finally, the error system can be written as

∂
∂ x̃


(ζ, t) = P1 (Hx̃(ζ, t)) + P0 (Hx̃(ζ, t)),


 ∂t 
∂ζ

f˜∂ (t)
WL ẽ∂ (t) = 0, WL = WB + LWC ,






ỹ(t) = W f˜∂ (t) .
C

x̃(ζ, 0) = x̃0 (ζ)
(IV.13)

ẽ∂ (t)

According to [Le Gorrec 05, Theorem 4.1], the error system (IV.13) is well-posed if WL ΣWLT ≥ 0.
T
T
Since WL = WB + LWC , WB ΣWBT = WC ΣWCT = 0, WB ΣW
 ˜C =
 In , and L = L > 0, the inequality
(t)
WL ΣWLT ≥ 0 is satisfied. Since WL ΣWLT ≥ 0 and WL fẽ∂∂ (t)
= 0, the estimations (IV.9) of the
Hamiltonian error are satisfied (see Theorem IV.2.1). Then, the proof follows the same line of the
proof of Theorem II.5.2 (see [Villegas 07, Theorem 5.17] for further details).

84



IV.3. Infinite-dimensional observers

Indeed, we use the estimations (IV.9) to show that the error system converges to zero exponentially. To this end, we show that, for some τ large enough and some positive constants cτ , l1 and
m1 , the Hamiltonian of the error system is such that
H̃(τ ) ≤

cτ
H̃(0).
cτ + l1 m1

(IV.14)

To find the estimation (IV.14), we write the boundary condition and the output ỹ(t) of (IV.13) as
follows:
!
!
!
!
1 WL
0
P1 −P1
H(b)x̃(b, t)
=√
.
(IV.15)
ỹ(t)
In In
H(a)x̃(a, t)
2 WC
We define the matrix
1 WL
M=√
2 WC
The matrix Rext =

√1
2



P1 −P1
In In

is also invertible. Indeed


0n In
In 0n





WL
WC





!

!

P1 −P1
.
In In

(IV.16)

is invertible (See [Le Gorrec 05, Lemma 3.4]). The matrix


is invertible if and only if

WL ΣWLT WL ΣWCT
WC ΣWLT WC ΣWCT



WL
WC





is invertible with Σ =

(See [Le Gorrec 05, Theorem 4.2]). Then, one can compute
WL ΣWLT WL ΣWCT
WC ΣWLT WC ΣWCT


0

!

!

LT + L In
=
,
In
0n

(IV.17)



I

which has an inverse and it is Inn −(LTn+L) . Then, the matrix M in (IV.16) is invertible as well.
This implies that kM wk2R ≥ m1 kwk2R , for some vector w of appropriated dimension and a constant
m1 that can be the smallest eigenvalue of M , for instance. If we compute the norm at both sides of
(IV.15), we obtain the following:
!

kỹ(t)k2R

H(b)x̃(b, t)
= M
H(a)x̃(a, t)

!

2

≥ m1
R

H(b)x̃(b, t)
H(a)x̃(a, t)

2

≥ m1 kH(b)x̃(b, t)k2R .

R

This implies that the norm of the error co-energy variables evaluated at the spatial boundaries are
bounded by the norm of the output as follows:
kH(b)x̃(b, t)k2R ≤

1
kỹ(t)k2R
m1

(IV.18)

(similar with kH(b)x̃(a, t)k2R ). Moreover, since L is positive definite, the norm of the output can be
also bounded as follows
1
kỹ(t)k2R ≤ ỹ(t)T Lỹ(t),
(IV.19)
l1
with l1 a positive scalar that can be for instance the smallest eigenvalue of L. Then, from (IV.18)
and (IV.19), one can conclude
kH(b)x̃(b, t)k2R ≤

1
ỹ(t)T Lỹ(t).
m1 l1

(IV.20)

85



Chapter IV. Infinite-dimensional observer-based boundary controllers: late-lumping approach

Since the error system (IV.13)
is a BC-PHS and satisfies the conditions of Theorem IV.2.1

f˜∂ (t)
T
(WL ΣWL ≥ 0 and WL ẽ∂ (t) = 0), we can use the estimations (IV.9). Then, using (IV.9) and
(IV.20) we obtain the following estimation for the Hamiltonian of the error system:
cτ Z τ
H̃(τ ) ≤
ỹ(t)T Lỹ(t)dt.
m1 l1 0

(IV.21)

Finally, from (IV.12) we obtain
H̃(τ ) − H̃(0) = −

Z τ

ỹ(t)T Lỹ(t)dt.

(IV.22)

0

Replacing (IV.22) into the estimation (IV.21), we obtain the estimation (IV.14), concluding that the
error state x̃(ζ, t) converges to zero exponentially.

The previous proposition is valid in the case where the full conjugated output is measured.
However, the full conjugated output y(t) is not always fully measurable. This is the case, for
example, when the sensors are restricted to be at one side of the spatial domain. In these cases, by
showing an extra condition, we also can design exponentially convergent observers for the BC-PHS
(IV.1). In the following proposition, we give a necessary condition to guarantee the exponential
convergence of the observer (IV.4) when the conjugated output is partially measured.
Proposition IV.3.2. Consider the BC-PHS (IV.1). Assume that the conjugated output is partially
measurable, i.e. ym (t) = Cm y(t), with Cm = ( Ip 0p×n−p ) ∈ Rp×n and 0 < p < n. The states of the
observer (IV.4) with
T
û(t) = u(t) + Cm
L(ym (t) − ŷm (t))

and

L ∈ Rp×p

converges exponentially to the state of the BC-PHS (IV.1) if
T
T T
LCm ≥ 0, and one of the following conditions is satisfied
L Cm + Cm
Cm

(IV.23)
L

T
kH(b)x̃(b, t)k2R ≤ γ ỹ(t)T Cm
LCm ỹ(t) or
T
kH(a)x̃(a, t)k2R ≤ γ ỹ(t)T Cm
LCm ỹ(t),

for some scalar γ > 0.

is

such

that

(IV.24)
♦

Proof. Showing the exponential convergence of the observer is equivalent to show that the error
(IV.5) converges to zero exponentially. Using (IV.23) in the observer (IV.4), the input of the error
system (IV.6) becomes
T
LCm ỹ(t),
(IV.25)
ũ(t) = −Cm
and the balance equation (IV.8) becomes
˙
T
H̃(t)
= −ỹ(t)T Cm
LCm ỹ(t) = −ỹm (t)T Lỹm (t).

(IV.26)

Finally, the error system can be written as

∂
∂ x̃


(ζ, t) = P1 (Hx̃(ζ, t)) + P0 (Hx̃(ζ, t)),


 ∂t 
∂ζ

f˜∂ (t)
T
WL ẽ∂ (t) = 0, WL = WB + Cm
LCm WC ,






ỹ(t) = W f˜∂ (t) .
C

86

ẽ∂ (t)

x̃(ζ, 0) = x̃0 (ζ)
(IV.27)



IV.3. Infinite-dimensional observers

According to [Le Gorrec 05, Theorem 4.1], the error system (IV.27) is well-posed if WL ΣWLT ≥ 0.
T
T T
T
LCm ≥
L Cm + Cm
LCm WC , WB ΣWBT = WC ΣWCT = 0, WB ΣWCT = In , and Cm
Since WL = WB + Cm
0, the inequality WL ΣWLT ≥ 0 is satisfied.
The exponential convergence of the error system (IV.27) is a direct application of [Villegas 07,
Corollary 5.19]. In fact, we use (IV.9), (IV.26), and (IV.24) to show that the Hamiltonian of the
error system decreases exponentially. First, we use (IV.24) to bound the Hamiltonian estimation
from (IV.9) as follows
H̃(τ ) ≤ c(τ )

Z τ
0

kH(b)x̃(b, t)k2R dt

⇒ H̃(τ ) ≤ c(τ )γ

Z τ
0

≤ c(τ )

Z τ
0

T
γ ỹ(t)T Cm
LCm ỹ(t)dt,

T
LCm ỹ(t)dt.
ỹ(t)T Cm

(IV.28)

Then, we integrate along time both sides of equation (IV.26)
H̃(0) − H̃(τ ) =

Z τ
0

T
LCm ỹ(t)dt,
ỹ(t)T Cm

and finally, we replace the last equation in (IV.28)




H̃(τ ) ≤ c(τ )γ H̃(0) − H̃(τ ) ,
⇔ H̃(τ ) ≤

c(τ )γ
H̃(0).
c(τ )γ + 1

This concludes the proof.

Note that, the conditions (IV.24) are related to the observability of the BC-PHS (IV.1) with
measured output ym (t) = Cm y(t). Indeed, if we are able to show that there exists γ > 0 such that
one of the two conditions in (IV.24) is satisfied, then we can design an exponentially convergent
observer. This is the case, for instance, of the vibrating string (Example II.3.2) where one of the two
conjugated outputs is measured (the force at ζ = a or the velocity at ζ = b) and the Timoshenko
beam (Example II.3.3) where one only needs to measure two conjugated outputs (either the force
and the torque at ζ = a, or the transverse velocity and the angular velocity at ζ = b). In the
following, we exemplify the Proposition IV.3.1 and the Proposition IV.3.2 by using the vibrating
string of Example II.3.2 in two different scenarios. Firstly, we consider that y(t) is fully measured.
Secondly, we consider that y(t) is partially measured.
Example IV.3.1. We consider the vibrating string of Example II.3.2 with unitary parameters
(T (ζ) = ρ(ζ) = 1), unitary length (a = 0, b = 1), and we consider as inputs the velocity at
ζ = a, and the force at ζ = b. The system is written as an impedance energy preserving BC-PHS
(IV.1) as follows:






q(ζ,
t)
0
∂



=



∂t p(ζ, t)

1






 p(a, t)
 = u(t),
P 


q(b,
t)








−q(a, t)


y(t) = 
,



p(b, t)







1 ∂ q(ζ, t)
,
0 ∂ζ p(ζ, t)









q(ζ, 0) q0 (ζ)

=
,
p(ζ, 0)
p0 (ζ)
(IV.29)

ym (t) = Cm y(t),

87



Chapter IV. Infinite-dimensional observer-based boundary controllers: late-lumping approach

where ym (t) represents the measurements. In all the following examples, the plant and the observer
are simulated using the discretization method proposed in [Trenchant 18]. We use finite-differences
for the spatial discretization and midpoint rule for the time discretization. The reader is refer to
Appendix A for further details about the discretization methods. We use 200 state variables for the
plant and 200 state variables for the observer. The time step is δt = 0.1ms, and the initial conditions
are
dw0
2
(ζ), p0 (ζ) = 0, q̂0 (ζ) = 0, p̂0 (ζ) = 0, w0 (ζ) = e−16(ζ−0.5) .
q0 (ζ) =
dζ
Since q(ζ, t) =
obtained by

∂w
(ζ, t),
∂ζ

the string deformation w(ζ, t) and the observed one ŵ(ζ, t) are numerically

w(ζ, t) = w(0, t) +

Z ζ

q(z, t)dz,

ŵ(ζ, t) = ŵ(0, t) +

Z ζ

0

q̂(z, t)dz

0

considering w(0, t) = ŵ(0, t) = 0.
In the following, we consider two scenarios. Firstly, we consider that the full conjugated output
is measured, and secondly, we consider that the conjugated output is partially measured.
(i) We consider firstly the case where the conjugated output is fully measured, i.e.
!

Cm = In

⇒

−q(a, t)
ym (t) = y(t) =
.
p(b, t)

Using Proposition IV.3.1 with u(t) = 0 (the string is attached at ζ = a and free at ζ = b), the state
of the following observer
!

!

∂ q̂(ζ, t)
0 1 ∂
=
1 0 ∂ζ
∂t p̂(ζ, t)
!

p̂(a, t)
l 0
= 1
q̂(b, t)
0 l2

!

!

q̂(ζ, t)
,
p̂(ζ, t)

!

!

q̂(ζ, 0)
q̂ (ζ)
= 0
,
p̂(ζ, 0)
p̂0 (ζ)
!

− [q(a, t) − q̂(a, t)]
p(b, t) − p̂(b, t)





converges exponentially to the state of the system if l1 , l2 > 0. In this case, L = l01 l02 > 0, and for
simplicity, we use l1 = l2 = 1.
Figure IV.1 shows the string deformation along time and space. Figure IV.2 shows the estimated
one (using different initial conditions). Figure IV.3 shows the deformation error. In each figure, the
two bold black lines show the initial and the final values of w(ζ, t), ŵ(ζ, t), and w̃(ζ, t), and the orange
line shows the end-tip deformations w(1, t), ŵ(1, t), and w̃(1, t). Since there is no internal dissipation
and due to the attached/free boundary conditions, the string (Figure IV.1) continues moving along
time due to the initial condition that is chosen to show the wave propagation. The observer (Figure
IV.2) starts from a zero initial condition and reaches the state of the BC-PHS approximately at
t = 1. The error deformation (Figure IV.3), starts from a non zero initial condition and reaches
zero approximately at t = 1.
Finally, in Figure IV.4, we show the Hamiltonians of the plant, the observer and the error system.
We can see that due to the boundary conditions the Hamiltonian of the string (H(t)) is constant.
The Hamiltonian of the error system converges to zero exponentially (H̃(t)) and the Hamiltonian of
the observer (Ĥ(t)) reaches the Hamiltonian of the string.

88



IV.3. Infinite-dimensional observers

Figure IV.1 – String deformation

Figure IV.2 – Estimated deformation

Figure IV.3 – Estimation error

Figure IV.4 – Hamiltonian of the plant (green),
observer (red) and error system (blue)

(ii) Now, we consider that the conjugated output is partially measured with the following measured
output:


Cm = 1 0
⇒ ym = Cm y(t) = −q(a, t).
Consider the following infinite-dimensional observer
!

!

∂ q̂(ζ, t)
0 1 ∂
=
1 0 ∂ζ
∂t p̂(ζ, t)
!

!

!

!

!

!

q̂(ζ, 0)
q̂ (ζ)
= 0
,
p̂(ζ, 0)
p̂0 (ζ)

q̂(ζ, t)
,
p̂(ζ, t)

!

p̂(a, t)
1
=
l (y (t) − ŷm (t)),
q̂(b, t)
0 1 m
with the scalar l1 > 0. The error system is
!

!

∂ q̃(ζ, t)
0 1 ∂
=
1 0 ∂ζ
∂t p̃(ζ, t)
!

!

!

q̃(ζ, 0)
q̃ (ζ)
= 0
,
p̃(ζ, 0)
p̃0 (ζ)

q̃(ζ, t)
,
p̃(ζ, t)
!


 −q̃(a, t)
p̃(a, t)
1
=
l1 1 0
q̃(b, t)
0
p̃(b, t)

89



Chapter IV. Infinite-dimensional observer-based boundary controllers: late-lumping approach

and its exponential convergence is shown using Proposition IV.3.2. To this end, we compute both
sides of the second inequality of (IV.24) as follows:
kH(a)x̃(a, t)k2 = q̃(a, t)2 + p̃(a, t)2 = (l12 + 1)q̃(a, t)2 ,
T
γ ỹ(t)T Cm
LCm ỹ(t) = γl1 q̃(a, t)2 ,

where in the second line we have replaced the boundary condition of the error system p̃(a, t) =
T
LCm ỹ(t) is satl1 q̃(a, t). Finally, choosing γ ≥ (l12 + 1)l1−1 , the condition kHx̃(a, t)k2R ≤ γ ỹ(t)T Cm
isfied and the infinite-dimensional observer converge to the BC-PHS. For simplicity, the observer
is designed using l1 = 1. Similarly as before, Figure IV.5, Figure IV.6, Figure IV.7, and Figure
IV.8 show the string deformation, the observed, the error and the Hamiltonians. The observer converges to the real values approximately at t = 2. The main difference with respect to the full sensing
scenario is that using only one sensor the convergence is slower than using two sensors.

Figure IV.5 – String deformation

Figure IV.6 – Estimated deformation

Figure IV.7 – Deformation error

Figure IV.8 – Hamiltonian of the plant (green),
observer (red) and error system (blue)
♣

90



IV.3. Infinite-dimensional observers

The observers of Proposition IV.3.1 and Proposition IV.3.2 require the measurements of the
conjugated output y(t) of the BC-PHS (IV.1). This means that it is required to measure energy
variables as for instance forces and velocities in mechanical systems. However, this is not always
possible as for example when positions are measured instead of velocities. In these cases, the velocity
has to be estimated for analysis and control. In the following section, these cases are presented
for the considered class of BC-PHS and we propose the observer input û(t) of (IV.4) to achieve
asymptotically convergent observers.

IV.3.2

The integral over time of the co-energy variables are measured

Co-energy variables are very useful to guarantee closed-loop stability. For example, in mechanical
systems, velocities are usually required for a negative feedback on the force actuators. However,
sometimes co-energy variables are difficult and even impossible to measure. In these cases, the
velocity has to be estimated for control purposes. In this section, we extend the infinite-dimensional
observer proposed in [Guo 09] (for the one-dimensional wave equation) to the class of impedance
energy preserving BC-PHSs of interest in this thesis. We show that a more general result can
be achieved using the interconnection properties of port-Hamiltonian systems. In the following
proposition, the input of the observer (IV.4) is designed such that the state of the observer converges
asymptotically to the state of the BC-PHS (IV.1).
Proposition IV.3.3. Consider the BC-PHS (IV.1). Assume that the measurement is on the following form:
ym (t) =

Z t
0

Cm y(τ )dτ + ym (0),

with





Cm = 0p×n−p Ip .

(IV.30)

Assume that the BC-PHS is approximately observable [Curtain 12, Corollary 4.1.14] with respect to
the output Cm y(t). The state of the observer (IV.4) with
T
û(t) = u(t) + Cm
L1 (ym (t) − ŷm (t) + θ(t)),

θ̇(t) = −L2 (ym (t) − ŷm (t) + θ(t)),

θ(0) = θ0 .

(IV.31)

converges asymptotically to the state of the BC-PHS (IV.1) if L1 , L2 ∈ Rp×p are both positive definite
matrices.
♦
Proof. Showing the asymptotic convergence of the observer is equivalent to show that the error
system (IV.6) converges to zero asymptotically. Note that since the BC-PHS (IV.1) is approximately
observable with respect to the output Cm y(t), the error system is (IV.6) is approximately observable
with respect to the output Cm ỹ(t). We use this property to show the asymptotic stability of the error
system by using LaSalle’s invariance principle.
From (IV.31) and (IV.6) we obtain
T
ũ(t) = −Cm
L1 (ym (t) − ŷm (t) + θ(t)).

(IV.32)

We define the following auxiliary variable:
xo (t) = ỹm (t) + θ(t)

(IV.33)

91



Chapter IV. Infinite-dimensional observer-based boundary controllers: late-lumping approach

with
ỹm (t) = ym (t) − ŷm (t),
and
ŷm (t) =

Z t
0

(IV.34)

Cm ŷ(τ )dτ + ŷm (0).

(IV.35)

The dynamic equation of xo (t) in (IV.33) is obtained from (IV.30) and (IV.31) as follows:
ẋo (t) = ỹ˙ m (t) + θ̇(t),
= Cm ỹ(t) − L2 xo (t).

(IV.36)

We define the following auxiliary finite-dimensional system:

ẋ

Po 

o (t)

= Ao xo (t) + Bo uo (t),
yo (t) = Co xo (t),

(IV.37)

with
Ao = −L2 ,

T
Co = Cm
L1 .

Bo = Cm ,

Then, the input of the error system (IV.32) is equivalently obtained with the passive interconnection
!

!

ũ(t)
0 −1
=
uo (t)
1 0

ỹ(t)
yo (t)

!

(IV.38)

between the error system (IV.6) and the auxiliary system (IV.37) as shown in Figure IV.9.
ũ(t)

P̃

yo (t)

Po

ỹ(t)

uo (t)

Figure IV.9 – Power preserving interconnection between the infinite-dimensional observer and the
finite-dimensional auxiliary system.

Now, we use LaSalle’s invariance principle to show that the system represented in Figure IV.9
converges asymptotically to zero. To this end, the reader is refer to [Villegas 07, Theorem 5.8] and
[Villegas 07, Theorem 5.9] for the well-posedness and the compactness of the solutions of the system.
We consider the following Lyapunov function:
1Z b
1
x̃(ζ, t)T H(ζ)x̃(ζ, t)dζ + xo (t)T L1 xo (t).
V (t) =
2 a
2
It follows from LaSalle’s invariance principle that all solutions of the system represented in Figure
IV.9 tend to the maximal invariant set of
ϑo = {x̃ ∈ L2 ([a, b], Rn ), xo ∈ Rp | V̇ (t) = 0}.

92

(IV.39)



IV.3. Infinite-dimensional observers

We define the maximal invariant subset of ϑo as I, and we show that I only contains the zero state,
i.e. I = {x̃(ζ, t) = 0, xo (t) = 0}. From (IV.6), and (IV.37), we obtain the following balance for the
Lyapunov function:
V̇ (t) = −xo (t)T L1 Ro L1 xo (t),
(IV.40)
with Ro = L2 L−1
1 > 0 and L1 > 0 by definition. Then, V̇ (t) = 0 implies xo (t) = 0, which implies
ẋo (t) = 0. Then, from (IV.37) and (IV.38) Bo uo (t) = Cm ỹ(t) = 0. Since xo (t) = 0, from (IV.37)
yo (t) = 0. Since yo (t) = 0, from the interconnection (IV.38) we can conclude ũ(t) = 0. Then, the
maximal invariant set I contains xo = 0 and the solution of the following BC-PHS

∂
∂ x̃


(ζ, t) = P1 (H(ζ)x̃(ζ, t)) + P0 H(ζ)x̃(ζ, t),


 ∂t 
∂ζ

f˜∂ (t)
WB ẽ∂ (t) = 0,


˜ 


f∂ (t)
C ỹ(t) = C W
= 0.
m

m

C

x̃(ζ, 0) = x̃0 (ζ),

ẽ∂ (t)

The latter being approximately observable with respect to Cm ỹ(t) implies that if Cm ỹ(t) = 0 for an
interval of time, then the state is such that x̃(ζ, t) = 0 (See [Curtain 12, Corollary 4.1.14]). Then,
the maximal invariant set I only contains the states x̃(ζ, t) = and xo (t) = 0. Thus, by LaSalle’s
invariance principle, the error system is asymptotically stable.

In the following example, we show that the state of the vibrating string can be asymptotically
estimated using the observer (IV.4) with (IV.31) measuring the end-tip position only.
Example IV.3.2. We consider the vibrating string of Example IV.3.1, and we assume that the
end-tip deformation is measured at ζ = b, i.e.
ym (t) = w(b, t).
Note that, the measured output (deformation at ζ = b) is the integral over time of one of the
conjugated outputs (velocity at ζ = b). Using Proposition IV.3.3, the state of the following infinitedimensional observer
!

!

∂ q̂(ζ, t)
0 1 ∂
=
1 0 ∂ζ
∂t p̂(ζ, t)

!

q̂(ζ, t)
,
p̂(ζ, t)

!

!

!

q̂(ζ, 0)
q̂ (ζ)
= 0
,
p̂(ζ, 0)
p̂0 (ζ)
!

p̂(a, t)
0
=
,
q̂(b, t)
l1 [ym (t) − ŷm (t) + θ(t)]
θ̇(t) = −l2 [ym (t) − ŷm (t) + θ(t)] ,

θ(0) = θ0 ,

with l1 , l2 > 0, θ ∈ R and ŷm (t) = ŵ(b, t), converges asymptotically to the state of the system. Since
the measured output is on the form
ym (t) =

Z t
0

Cm y(τ )dτ + ym (0),





Cm = 0 1 ,

one can show that the plant is approximately observable with respect
to Cm y(t) = p(b, t) (velocity at
Rτ
ζ = b). Indeed, by using (IV.9), one can show that H̃(τ ) ≤ c(τ ) 0 p(b, t)2 dt satisfying the condition
of exact observability (See [Curtain 12, Corollary 4.1.14 a.(iii)]), which is a stronger conditions than
the approximate observability.

93



Chapter IV. Infinite-dimensional observer-based boundary controllers: late-lumping approach

We can use Proposition IV.3.3 with L1 = l1 > 0 and L2 = l2 > 0, to prove the asymptotic
stability of the error system. For simplicity, the observer is designed using l1 = l2 = 1000, and
θ0 = 0. Similarly as in Example IV.3.1, Figure IV.10, Figure IV.11, and Figure IV.12 show the
spatial and temporal responses of the string deformation, the estimated one, and the error one,
respectively. The observer converge to the real values approximately at t = 4. Finally, in Figure
IV.13, we show the Hamiltonians of the plant, the observer and the error system. We can see that
due to the boundary conditions the Hamiltonian of the string (H(t)) is constant. The Hamiltonian of
the error system converges to zero asymptotically (H̃(t)) and the Hamiltonian of the observer (Ĥ(t))
reaches the Hamiltonian of the string. The main difference with respect to Example IV.3.1 is that
in this case, since we can not measure the co-energy variables, we cannot guarantee the exponential
convergence.
♣

94

Figure IV.10 – String deformation

Figure IV.11 – Estimated deformation

Figure IV.12 – Deformation error

Figure IV.13 – Hamiltonian of the plant (green),
observer (red) and error system (blue)



IV.3. Infinite-dimensional observers

The observer presented in Example IV.3.2 was first introduced in [Guo 09]. In Proposition IV.3.3,
we have generalized this idea to the class of impedance energy preserving BC-PHSs. In this way,
we can use Proposition IV.3.3 to design an infinite-dimensional observer for the Timoshenko beam
measuring the end-tip deformation and the end-tip rotation angle as it is shown in the following
example.
Example IV.3.3. Consider the one-dimensional Timoshenko beam of Example II.3.3 with unitary
parameters and unitary length. The beam is clamped at the left side and free at the other side. The
only measures are the transverse displacement and the rotation angle at the right side. We can write
the system as a BC-PHS (IV.1) in the following form


 ∂x (ζ, t) = P ∂ (Hx(ζ, t)) + P (Hx(ζ, t)),

1
0



∂t
∂ζ








−x1 (0, t)
x2 (0, t)








 −x (0, t) 



3


 x4 (0, t) 

y(t) = 
 = 0,
P 



x2 (1, t) 
x1 (1, t) 









x
(1,
t)
x
(1,
t)
4
3








w(1, t) 



,
y (t) = 

 m
φ(1, t)

x(ζ, 0) = x0 (ζ),

with x(ζ, t), P1 , P0 defined in Example II.3.3, H(ζ) = I4 , ζ ∈ [0, 1] and t ≥ 0. Using Proposition
IV.3.3, the following observer


 ∂ x̂ (ζ, t) = P ∂ (Hx̂(ζ, t)) + P (Hx̂(ζ, t)),

x̂(ζ, 0) = x̂0 (ζ),
1
0



∂t
∂ζ







0
x̂2 (0, t)













0



 x̂4 (0, t) 
,
=



P̂  x̂ (1, t)   l (w(1, t) − ŵ(1, t) + θ ) 


1
1 
1








x̂3 (1, t)   l2 (φ(1, t) − φ̂(1, t) + θ2 )









θ
(t)
−l
(w(1,
t)
−
ŵ(1,
t)
+
θ
)
θ
(0)
d
1
3
1
1


,



=


 dt
θ (0)
θ (t)
−l (φ(1, t) − φ̂(1, t) + θ )
4

2

2

= θ0 ,

2

with l1 , l2 , l3 , l4 > 0 and θ1 , θ2 ∈ R, converges asymptotically to the state of the system. Indeed, the
measured output is on the form
ym (t) =
h

i

Z t
0

Cm y(τ )dτ + ym (0),
h

Cm =

0 0 1 0
0 0 0 1

!

.

i

We can choose L1 = l01 l02 > 0 and L2 = l03 l04 > 0. Then, using Proposition IV.3.3 we can
conclude that the error system is asymptotically stable. For simplicity, the observer is designed with
l1 = l2 = 100, l3 = l4 = 150. For the simulation, the plant and the observer are discretized using the
same spatial and time discretization methods as in Example IV.3.1 (See [Trenchant 18] or Appendix
A). We use 200 state variables to describe the beam and 200 state variables for the observer. The

95



Chapter IV. Infinite-dimensional observer-based boundary controllers: late-lumping approach

step time is δt = 0.1ms and the initial initial conditions are


x0 (ζ) =






1
0
1−ζ
0







,







x̂0 (ζ) =

0
0
0
0




,


!

!

!

ŵ(1, 0) − w(1, 0)
θ1 (0)
−1.3234
=
=
,
θ2 (0)
−0.5000
φ̂(1, 0) − φ(1, 0)

that correspond to the beam in an equilibrium position where a force of 1 N and a torque of 0 N m are
applied at ζ = 1. Note that, the initial condition of θ1 and θ2 are chosen such that θ̇1 (0) = θ̇2 (0) = 0.
The transverse displacement w(ζ, t) and the rotation angle φ(ζ, t) are reconstructed from the state
variables using the clamped condition at the left side (w(0, t) = φ(0, t) = 0). Similarly, for the
observer we consider ŵ(0, t) = φ̂(0, t) = 0. The following formulas are implemented to reconstruct
the deformation of the beam
φ(ζ, t) = φ(0, t) +

Z ζ
0

w(ζ, t) = w(0, t) +

Z ζ
0

φ̂(ζ, t) = φ̂(0, t) +

Z ζ
0

ŵ(ζ, t) = ŵ(0, t) +

Z ζ
0

x3 (z, t)dz,
[x1 (z, t) + φ(z, t)]dz,
x̂3 (z, t)dz,
[x̂1 (z, t) + φ̂(z, t)]dz.

Figure IV.14 shows the beam deformation along time and space, Figure IV.15 shows the estimated
one, and Figure IV.16 shows the deformation error. In each figure, the two black lines show the initial
and final value of w(ζ, t), ŵ(ζ, t), and w̃(ζ, t), and the orange line shows the end-tip deformations
w(1, t), ŵ(1, t), and w̃(1, t). The observer (Figure IV.15) starts from a zero initial condition and
reaches the state of the BC-PHS approximately at t = 6. The error (Figure IV.16), starts from a
non zero initial condition and reaches the zero approximately at t = 6. Finally, Figure IV.18 shows
the conjugated outputs and their estimations.
♣

Figure IV.14 – Beam deformation

96

Figure IV.15 – Estimated deformation



IV.3. Infinite-dimensional observers

Figure IV.16 – Deformation error

Figure IV.17 – Hamiltonian of the plant (green),
observer (red) and error system (blue)

Figure IV.18 – Observer convergence of the conjugated output ŷ(t) to y(t). y1 and y2 are
respectively, the negative force and negative torque at the left side of the beam. y3 and y4 are
respectively, the transverse velocity and angular velocity at the right side of the beam.

The performances of the observer can be improved by adding more sensors. In particular, by
adding sensors that measure the co-energy variables, the exponential convergence can be guaranteed.
In the following section, we present the observer input and the conditions such that the observer
(IV.4) achieves exponential convergence with a damping error injection plus an external dynamic
injection.

97



Chapter IV. Infinite-dimensional observer-based boundary controllers: late-lumping approach

IV.3.3

The co-energy variables and their integrals over time are both
measured

In the previous sections, we have shown that when measuring co-energy variables, we can design
infinite-dimensional observers with exponential convergence (Section IV.3.1) and when measuring the
integral over time of co-energy variables, we can design infinite-dimensional observers with asymptotic convergence (Section IV.3.2). In this section, we show that when measuring a combination of
both cases, we can also design infinite-dimensional observers with exponential convergence. In this
case, we consider the following measurements:
ym1 (t) = Cm y(t),

ym2 (t) =

Z t
0

ym1 (τ )dτ + ym2 (0),

(IV.41)

with
Cm =



0p×(n−p) Ip



,

0 < p ≤ n.

Note that, ym1 (t) contains p conjugated outputs and ym2 (t) contains the integral over time of ym1 (t).
In mechanical systems, for example, this can be the case of measuring velocities (ym1 (t)) and displacements (ym2 (t)). Now, we aim to design û(t) from (IV.4) such that x̂(t) converges exponentially
to x(ζ, t) from (IV.1). To this end, we define the error as x̃(ζ, t) = x(ζ, t) − x̂(ζ, t). We define the
observed outputs as follows:
ŷm1 (t) = Cm ŷ(t),

ŷm2 (t) =

Z t

ŷm1 (τ )dτ + ŷm2 (0).

(IV.42)

ỹm2 (t) = ym2 (t) − ŷm2 (t)

(IV.43)

0

Then, we define the error of the measured outputs as
ỹm1 (t) = ym1 (t) − ŷm1 (t),

Finally, we define the conjugated inputs of ym1 (t), ŷm1 (t) and ỹm1 (t), respectively as:
um1 (t) = Cm u(t),

ûm1 (t) = Cm û(t),

ũm1 (t) = um1 (t) − ûm1 (t).

(IV.44)

The following proposition is the main result of this section. We emphasize that ym1 has to satisfy
one of the two conditions in (IV.46). Then, û(t) from (IV.4) is designed to achieve the exponential
convergence.
Proposition IV.3.4. Consider the impedance energy preserving BC-PHS (IV.1) with measurements
given by ym1 (t) and ym2 (t) in (IV.41). The state of the observer (IV.4) with
T
T
So (ym1 (t) − ŷm1 (t))
û(t) = u(t) + Cm
L1 (ym2 (t) − ŷm2 (t) + θ(t)) + Cm

θ̇(t) = −L2 (ym2 (t) − ŷm2 (t) + θ(t)),

θ(0) = θ0 ∈ Rp

(IV.45)

converges exponentially to the state of the BC-PHS (IV.1) if L1 , L2 , So ∈ Rp×p are all positive
definite matrices and one of the following two inequalities
kH(b)x̃(b, t)k2 ≤ kũm1 (t)k2 + kỹm1 (t)k2 ,
kH(a)x̃(a, t)k2 ≤ kũm1 (t)k2 + kỹm1 (t)k2
is satisfied for some  > 0.

98

or

(IV.46)
♦



IV.3. Infinite-dimensional observers

Proof. Showing the exponential convergence of the observer is equivalent to show that the error
x̃(ζ, t) converges exponentially to zero. Using (IV.45), the error dynamics is written as in (IV.6)
with
T
T
ũ(t) = −Cm
L1 (ỹm2 (t) + θ(t)) − Cm
So ỹm1 (t),

θ̇(t) = −L2 (ỹm2 (t) + θ(t)),

θ(0) = θ0 .

(IV.47)

We define the following auxiliary variable:
xo (t) = θ(t) + ỹm2 (t).

(IV.48)

ẋo (t) = θ̇(t) + ỹ˙ m2 (t),
= −L2 (θ(t) + ỹm2 (t)) + ỹm1 (t),
= −L2 xo (t) + Cm ỹ(t).

(IV.49)

From (IV.47) and (IV.43) we obtain:

We define the following finite-dimensional system:

ẋ

Po 

o (t)

= Ao xo (t) + Bo uo (t)
yo (t) = Co xo (t) + Do uo (t),

(IV.50)

with
Ao = −L2 ,

T
Co = Cm
L1 ,

Bo = Cm ,

T
Do = Cm
S o Cm .

Then, the error system (IV.6) with input (IV.47) is equivalent to the interconnection
"

ũ(t)
uo (t)

#

"

=

0 −1
1 0

#"

ỹ(t)
yo (t)

#

(IV.51)

between (IV.6) and (IV.50). In the following, we use the total energy (the energy of (IV.6) plus the
energy of (IV.50)) as a Lyapunov function. We define the total energy as:
V (t) =

1
1Z b
x̃(ζ, t)T Hx̃(ζ, t)dζ + xo (t)T L1 xo (t).
2 a
2

(IV.52)

Now, we follow the same line of [Ramirez 14, Theorem IV.2] to show that the Lyapunov function
satisfies V (τ ) ≤ αV (0) for some 0 < α < 1 and τ > 0. To this end, we recall the following
lemmas concerning the total energy V (t) in (IV.52) and the energy of (IV.50) defined as Ho (t) =
1
x (t)T L1 xo (t).
2 o
Lemma IV.3.1. [Ramirez 14, Lemma IV.1] The total energy V (t) satisfies for τ large enough
2c(τ ) Z τ
Ho (t)dt,
c1 0
0
Z τ
2c(τ ) Z τ
V (τ ) ≤ c(τ )
kH(a)x̃(a, t)k2 dt +
Ho (t)dt
c1 0
0

V (τ ) ≤ c(τ )

Z τ

kH(b)x̃(b, t)k2 dt +

where c(τ ) is a positive constant that depends on τ and c1 is a positive constant.

(IV.53)

♦

99



Chapter IV. Infinite-dimensional observer-based boundary controllers: late-lumping approach

Lemma IV.3.2. [Ramirez 14, Lemma III.4] For every δ1 > 0 there exists a δ2 > 0 such that for all
τ > 0, Ho (t) satisfies the relation
Z τh
0

i

δ1 Ho (t) + kyo (t)k2 dt ≤ δ2

Z τh

i

Ho (t) + kuo (t)k2 dt.

0

(IV.54)
♦

Lemma IV.3.3. [Ramirez 14, Lemma III.3] There exists positive constants ξ1 , ξ1 and τ0 such that
for all τ > τ0 , Ho (t) satisfies
Z τ
0

Ho (t)dt ≤ ξ1

Z τ
0

xo (t)T L1 L2 xo (t)dt + ξ2

Z τ
0

kuo (t)k2 dt.

(IV.55)
♦

The time derivative of the Lyapunov function (IV.52) is given by
V̇ (t) = ũ(t)T ỹ(t) + xo (t)T L1 ẋo (t),
= ũ(t)T ỹ(t) + xo (t)T L1 (−L2 xo (t) + Cm uo (t))
= ũ(t)T ỹ(t) − xo (t)T L1 L2 xo (t) + xo (t)T L1 Cm uo (t)
= ũ(t)T ỹ(t) − xo (t)T L1 L2 xo (t) + xo (t)T CoT uo (t)




= ũ(t)T ỹ(t) − xo (t)T L1 L2 xo (t) + yo (t)T − uo (t)T DoT uo (t)
= ũ(t)T ỹ(t) − xo (t)T L1 L2 xo (t) + yo (t)T uo (t) − uo (t)T Do uo (t)

(IV.56)

= −xo (t)T L1 L2 xo (t) − uo (t)T Do uo (t)
T
= −xo (t)T L1 L2 xo (t) − uo (t)T Cm
So Cm uo (t)
T
= −xo (t)T L1 L2 xo (t) − ỹ(t)T Cm
So Cm ỹ(t)

= −xo (t)T L1 L2 xo (t) − ỹm1 (t)T So ỹm1 (t).
Since So > 0, So ≥ σIp with σ > 0, which it can be the smallest eigenvalue of So , for example. Then,
V̇ (t) ≤ −xo (t)T L1 L2 xo (t) − σ ỹm1 (t)T ỹm1 (t),
= −xo (t)T L1 L2 xo (t) − σkỹm1 (t)k2 ,
= −xo (t)T L1 L2 xo (t) − 1 σkỹm1 (t)k2 − 2 σkỹm1 (t)k2 ,
= −xo (t)T L1 L2 xo (t) − 1 σkỹm1 (t)k2 − 2 σkỹm1 (t)k2 ± 2 σkũm1 (t)k2 ,
= −xo (t)T L1 L2 xo (t) − 1 σkỹm1 (t)k2 + 2 σkũm1 (t)k2




− 2 σ kũm1 (t)k2 + kỹm1 (t)k2 ,
where 1 and 2 are two positive constants such that 1 +2 = 1. In this case we use the first inequality
of (IV.46). However, using the second one, the proof follows the same line. Then, the Lyapunov
function satisfies:
V̇ (t) ≤ −xo (t)T L1 L2 xo (t) − 1 σkỹm1 (t)k2 + 2 σkũm1 (t)k2 − 2 σkH(b)x̃(b, t)k2 .

100



IV.3. Infinite-dimensional observers

For simplicity, in the following, we omit the time dependency (t). We integrate the last inequality
over time as follows:

V (τ ) − V (0) ≤
≤

Z τh
Z0τ h
0

i

−xTo L1 L2 xo − 1 σkỹm1 k2 + 2 σkũm1 k2 − 2 σkH(b)x̃(b)k2 dt,
i

−xTo L1 L2 xo − 1 σkỹm1 k2 + 2 σkũm1 k2 dt
"

#

2 σ 2c(τ ) Z τ
+
Ho (t)dt − V (τ )
c(τ )
c1 0

where we have used −c(τ )
can be written as:

"

Rτ
0

2c(τ ) R τ
0
c1

kH(b)x̃(b, t)k2 dt ≤

Ho (t)dt − V (τ ) from (IV.53). The inequality

#

Z τh
i
σ2 
1+
V (τ ) − V (0) ≤
−xTo L1 L2 xo − 1 σkỹm1 k2 + 2 σkũm1 k2 dt
c(τ )
0
22 σ Z τ
Ho dt,
+
c1 0

=−

Z τ
0

xTo L1 L2 xo dt − 1 σ

+ 2 σ



0

kỹm1 k2 dt

2
kũm1 k + Ho dt.
c1

Z τ
0

Z τ



2



Since Cm = 0p×(n−p) Ip , from (IV.47) we obtain kũk2 = kũm1 k2 . Moreover, from the interconnection (IV.51), we obtain kũk2 = kũm1 k2 = kyo k2 . Then, by using (IV.54) with δ1 = c21 , the following
inequality is satisfied

"

#

Z τ
Z τ
σ2 
1+
V (τ ) − V (0) ≤ −
xTo L1 L2 xo dt − 1 σ
kỹm1 k2 dt
c(τ )
0
0

Z τ
2
+ 2 σ
kyo k2 + Ho dt,
c1
0

≤−

Z τ
0

xTo L1 L2 xo dt − 1 σ

+ 2 σδ2

Z τh
0

2

Z τ
0

kỹm1 k2 dt

i

kuo k + Ho dt,

101



Chapter IV. Infinite-dimensional observer-based boundary controllers: late-lumping approach

Grouping some terms and using the interconnection (IV.51), we obtain the following:
"

#

Z τ
Z τ
Z τ
σ2 
T
V (τ ) − V (0) ≤ −
xo L1 L2 xo dt + 2 σδ2
Ho dt − 1 σ
kỹm1 k2 dt
1+
c(τ )
0
0
0

+ 2 σδ2
=−

Z τ
0

=−

0

≤−

0

≤−

0

+ 2 σδ2

Z τ
0

Ho dt − 1 σ

0

kỹm1 k2 dt

kỹk2 dt,

Z τh
0

Z τ
0

+ 2 σδ2

Z τ
0

2

Ho dt − 1 σ
2

Z τ
0

kỹm1 k2 dt

i

kỹm1 k + kỹnm k dt,
+ 2 σδ2

Z τ
0

Ho dt − 1 σ

Z τ
0

kỹm1 k2 dt

kỹm1 k2 dt,

xTo L1 L2 xo dt

+ σ(2 δ2 − 1 )

+ 2 σδ2

Z τ
0

Z τ
0

Ho dt

kỹm1 k2 dt

where ỹnm (t) is the non measured part of the conjugated output ỹ(t) =
(IV.55) to bound the last inequality as follows:
"

Z τ

0

xTo L1 L2 xo dt

+ 2 σδ2
Z τ

Z τ

xTo L1 L2 xo dt

+ 2 σδ2
Z τ

0

kuo k2 dt,

xTo L1 L2 xo dt

+ 2 σδ2
Z τ

Z τ

h

ỹnm (t)
ỹm1 (t)

i

. Finally, we use

#

Z τ
Z τ
σ2 
T
1+
xo L1 L2 xo dt + σ(2 δ2 − 1 )
kỹm1 k2 dt
V (τ ) − V (0) ≤ −
c(τ )
0
0

+ 2 σδ2
≤−

Z τ
0

Z τ
0

Ho dt,

xTo L1 L2 xo dt + σ(2 δ2 − 1 )


+ 2 σδ2 ξ1
≤ (2 σδ2 ξ1 − 1)

Z τ
Z0 τ
0

Z τ
0

kỹm1 k2 dt

T

xo (t) L1 L2 xo (t)dt + ξ2

Z τ
0

2



kuo (t)k dt ,

xTo L1 L2 xo dt

+ σ(2 δ2 (1 + ξ2 ) − 1 )

Z τ
0

kỹm1 k2 dt

Since 2 > 0 can be chosen arbitrarily such that 1 + 2 = 1 and σ > 0, we can chose 2 such that
the following inequalities are satisfied
1
σ2 δ2 ξ2 − 1 ≤ 0 ⇒ 2 ≤
,
σδ2 ξ1
(IV.57)
1
2 δ2 (1 + ξ2 ) − 1 ⇒ 2 ≤
.
1 + δ2 (1 + ξ)
If 2 satisfies (IV.57), then the Lyapunov function satisfies
"

#

σ2 
c(τ )
V (τ ) − V (0) ≤ 0 ⇒ V (τ ) ≤
V (0).
1+
c(τ )
c(τ ) + σ2 

102

(IV.58)



IV.3. Infinite-dimensional observers

This concludes the proof.

Example IV.3.4. We consider the vibrating string of Example IV.3.1, and we assume that the
end-tip deformation and the velocity are measured at ζ = b
!

w(b, t)
ym (t) =
.
p(b, t)
We can verify that the measurements are given by:
ym1 (t) = Cm y(t) = p(b, t),
ym2 (t) =

Z t
0

Cm =

h

i

0 1 ,

ym1 (τ )dτ + ym2 (0) = w(b, t).

The conjugated input of ym1 (t) is given by the force at ζ = b as follows:
um1 (t) = q(b, t).
Then, one can verify
kH(b)x̃(b, t)k2 ≤ kũm1 (t)k2 + kỹm1 (t)k2 ⇔ (q̃(b, t)2 + p̃(b, t2 )) ≤ q̃(b, t)2 + p̃(b, t)2 .
Using Proposition IV.3.4, the state of the following observer
∂
∂t

"

"

q̂(ζ, t)
p̂(ζ, t)

#

p̂(a, t)
q̂(b, t)

#

"

=
"

=

0 1
1 0

#

∂
∂ζ

"

q̂(ζ, t)
p̂(ζ, t)

#

"

,

q̂(ζ, 0)
p̂(ζ, 0)

#

"

=

q̂0 (ζ)
p̂0 (ζ)

#

0
l1 (w(b, t) − ŵ(b, t) + θ(t)) + so (p(b, t) − p̂(b, t))

θ̇(t) = −l2 (w(b, t) − ŵ(b, t) + θ(t)),

,
#

,

θ(0) = θ0 ,

with l1 , l2 , so > 0 and θ ∈ R, converges exponentially to the state of the system (L1 = l1 , L2 = l2 ,
and So = so from Proposition IV.3.4)
We choose l1 = l2 = 1, so = 0.7, and θ0 = 0. The main difference with respect to Example IV.3.2
is the damping term related to the parameter s0 . With this damping term we do not need high gains
l1 and l2 to achieve a fast convergence. Moreover, in this case, we can guarantee the exponential
convergence using the Lyapunov function V (t) as shown in Figure IV.22.
Figure IV.19 shows the string deformation along time and space, Figure IV.20 shows the estimated one, and Figure IV.21 shows the error. In every figure, the two black lines show the initial
and final value of w(ζ, t), ŵ(ζ, t), and w̃(ζ, t), and the orange line shows the end-tip deformations
w(1, t), ŵ(1, t), and w̃(1, t). The observer (Figure IV.20) starts from a zero initial condition and
achieves the state of the BC-PHS approximately at t = 4. The error (Figure IV.21), starts from a
non zero initial condition and achieves the zero approximately at t = 4. Finally, Figure IV.23 shows
the conjugated outputs and its estimations.

103



Chapter IV. Infinite-dimensional observer-based boundary controllers: late-lumping approach

Figure IV.19 – String deformation

Figure IV.20 – Estimated deformation

Figure IV.21 – Deformation error

Figure IV.22 – Hamiltonian of the plant (green),
observer (red) and error system (blue)

Figure IV.23 – Observer convergence of the conjugated output ŷ(t) to y(t). y1 is the negative force
at the left side of the string and y2 is the velocity of the string at the right side.

♣

104



IV.4. Observer-based damping injection: application to the vibrating string

IV.4

Observer-based damping injection: application to
the vibrating string

In this section, we use the infinite-dimensional observers proposed in the previous section to
apply an observer-based damping injection control strategy. With this control strategy, we aim to
add damping at the non-measurable side of the vibrating string. We consider the vibrating string of
Example II.3.2 in the fully actuated and partially sensed case, i.e. with actuators at both sides of the
string and a sensor at one side of the string only. First, we consider the case where the force at the
left side is measurable and second, the case where the displacement at the right side is measurable.
The results presented in this section are some first steps towards observer-based damping injection
using a late-lumping approach for BC-PHSs.

IV.4.1

Fully actuated string with a force sensor

In this part, we consider the vibrating string with actuators at both sides and with a force sensor
at the left side of the string. We show that the extended system, composed by the BC-PHS and the
infinite-dimensional observer, makes the closed-loop system exponentially stable using the observerbased damping injection strategy. We compare this strategy with the case where damping is applied
at the measurable side only, and we verify by simulations that the settling time can be improved
using the observer-based damping injection strategy.
We consider the vibrating string of Example IV.3.1 with a force sensor at the left side of the
string. Note that, we have two inputs, two conjugated outputs and one measured output, i.e.
!

p(a, t)
= u(t),
q(b, t)

!

−q(a, t)
,
y(t) =
p(b, t)

ym (t) = −q(0, t).

We aim to apply a damping injection control law at both sides of the string. This is:
!

u(t) = −Ky(t) ⇔

p(a, t)
k 0
=− 1
q(b, t)
0 k2

!

!

!

−q(0, t)
k 0
,
, K= 1
p(1, t)
0 k2

where k1 and k2 are two positive scalars. However, since p(1, t) is not measurable, it is not possible
to implement it. In the previous section, we have shown that, in this example, when the conjugated
output is partially measured, we can estimate the state x(ζ, t) with an infinite-dimensional observer
(using Proposition IV.3.2 for example). In this case, we can use the following infinite-dimensional
observer to estimate the state x(ζ, t) from the measurements of ym (t) and u(t)





q̂(ζ,
t)
∂







∂t

p̂(ζ,
t)












0 1 ∂ q̂(ζ, t)
=
,
1 0 ∂ζ p̂(ζ, t)
 



P̂  p̂(0, t)
l

 = u(t) +  1  (ym (t) − ŷm (t)),




q̂(1, t)
0




ŷ

m (t)







q̂(ζ, 0) q̂0 (ζ)

=
,
p̂(ζ, 0)
p̂0 (ζ)
(IV.59)

= −q̂(0, t).

Finally, we implement the observer-based damping injection at the both sides of the string using the
following control law:
!
!
!
k1 0
−q̂(0, t)
k1 q̂(0, t)
u(t) = −
=
.
(IV.60)
0 k2
p̂(1, t)
−k2 p̂(1, t)

105



Chapter IV. Infinite-dimensional observer-based boundary controllers: late-lumping approach

In the following Proposition, we give the main result of this subsection concerning the existence
of solutions and the stability of the closed-loop system composed by (IV.29), (IV.59), and (IV.60).
Proposition IV.4.1. Consider the closed-loop system obtained between the BC-PHS (IV.29) and
the observer-based control law (IV.59)-(IV.60). The following holds:
(i) The closed-loop system is well-posed if k1 > 0, k2 > 0, and 0 < l1 ≤ 4k1 .
(ii) The closed-loop system is exponentially stable if there exists γ > 0 such that
!

k1 − l21
1 + k12 −k1 l1
−
γ
−k1 l1 1 + 2l12
− l21 l1

!

≤0

(IV.61)
♦

Proof. Defining the error variables as q̃(ζ, t) = q(ζ, t) − q̂(ζ, t) and p̃(ζ, t) = p(ζ, t) − p̂(ζ, t), the
error system becomes
!

!

!

∂ q̃(ζ, t)
0 1 ∂
=
1 0 ∂ζ
∂t p̃(ζ, t)
!

!

!

q̃(ζ, 0)
q̃ (ζ)
= 0
,
p̃(ζ, 0)
p̃0 (ζ)

q̃(ζ, t)
,
p̃(ζ, t)

!

p̃(0, t)
l
= 1 q̃(0, t),
q̃(1, t)
0
and the extended closed-loop system can be written as
q̂(ζ, t)
0



∂ p̂(ζ, t) 1

=
∂t q̃(ζ, t) 0
p̃(ζ, t)
0






1
0
0
0

0
0
0
1

0
0
 ∂

1 ∂ζ
0


q̂(ζ, 0)
q̂0 (ζ)
p̂(ζ, 0)
p̂ (ζ)


 0


=
,
q̃(ζ, 0)
 q̃0 (ζ) 
p̃(ζ, 0)
p̃0 (ζ)

q̂(ζ, t)
p̂(ζ, t)



,
q̃(ζ, t)
p̃(ζ, t)












p̂(0, t)
k1 q̂(0, t) − l1 q̃(0, t)
q̂(1, t)


−k2 p̂(1, t)





=
.
p̃(0, t)


l1 q̃(0, t)
q̃(1, t)
0








(IV.62)

In the following, we first show that the system (IV.62) is well-posed and then that it is exponentially stable. For the well-posedness, we use Theorem II.2.2, and for the stability we use the portHamiltonian properties of Theorem IV.2.1. We define the following differential operator associated
to the system (IV.62)
Az = Pz

d
(Hz z)
dζ

(IV.63)

with
q̂(ζ, t)
p̂(ζ, t)

z(ζ, t) = 

,
q̃(ζ, t)
p̃(ζ, t)




0
1
Pz = 

0
0


1
0
0
0

0
0
0
1

0
0

,
1
0


Hz = I4 .

(IV.64)

The boundary conditions of (IV.62) are written with the following parametrization
!

WB

106

f∂ (t)
=0
e∂ (t)

(IV.65)



IV.4. Observer-based damping injection: application to the vibrating string

with
0 0
1 k

2
VB = 
0 0
0 0


WB =

√
Pz −Pz
2VB
I4 I4

and

!−1

,

!

0 −k1
0 0
0 0
0 0

0
0
0
1

!

1 l1
0 0
0 −l1
0 0

0
0

,
1
0


!

1 Pz −Pz
f∂ (t)
Hz (1)z(1, t)
=√
.
e∂ (t)
Hz (0)z(0, t)
2 I4 I4
Note that, for simplicity we use the matrix VB , where the following is satisfied
!

WB

(IV.66)

(IV.67)

!

f∂ (t)
Hz (1)z(1, t)
= VB
= 0.
e∂ (t)
Hz (0)z(0, t)

(IV.68)

From Theorem II.2.2, Az generates
a contraction semigroup on Z = L2 ([0, 1], Rn ) if and only if

WB ΣWBT ≥ 0, with Σ = 0I44 0I44 . To check this condition, we define the matrix Ω = WB ΣWBT and
its eigenvalues λ (Ω). We have
2k1 0 −l1
 0
2k2 0
Ω=

 −l1
0 2l1
0
0
0


0
0

,
0
0






0




2k
q 2


.
λ (Ω) = 
k1 + l1 + k12 − 2k1 l1 + 2l12 


k1 + l1 −

q

k12 − 2k1 l1 + 2l12

(IV.69)



Since k1 , k2 , and l1 are positive values, Ω = WB ΣWBT ≥ 0 if and only if l1 ≤ 4k1 . With the same
conditions, Az generates a contraction semigroup on Z = L2 ([0, 1], Rn ) and (IV.62) is well-posed.
To show the exponential stability, we define the following Hamiltonian
1
1Z 1
HT (t) = kz(t)k2Hz =
z(ζ, t)T Hz z(ζ, t)dζ
2
2 0
1Z 1
=
[q̂(ζ, t)2 + p̂(ζ, t)2 + q̃(ζ, t)2 + p̃(ζ, t)2 ]dζ,
2 0

(IV.70)

with time derivative given by
h

i

ḢT (t) = − k1 q̂(0, t)2 − l1 q̂(0, t)q̃(0, t) + l1 q̃(0, t)2 − k2 p̂(1, t)2 .

(IV.71)

where we have replaced the boundary conditions of (IV.62). Integrating over time we obtain
HT (0) − HT (τ ) −

Z τ
0

2

k2 p̂(1, t) dt =

Z τ
0

!T

q̂(0, t)
q̃(0, t)

k1 − l21
− l21 l1

!

!

q̂(0, t)
.
q̃(0, t)

(IV.72)

Note that, if we are able to show that the Hamiltonian HT (τ ) has an upper bound of the form
HT (τ ) ≤ α

Z τ
0

!T

q̂(0, t)
q̃(0, t)

k1 − l21
− l21 l1

!

!

q̂(0, t)
,
q̃(0, t)

(IV.73)

for some α > 0, then, from (IV.72) and (IV.73), the following inequality is satisfied
Z τ
α
HT (τ ) ≤
HT (0) −
k2 p̂(1, t)2 dt
1+α
0




(IV.74)

107



Chapter IV. Infinite-dimensional observer-based boundary controllers: late-lumping approach

α
and the exponential stability is achieved, since HT (τ ) ≤ 1+α
HT (0). To check that there exists α that
satisfies (IV.73), we use the following bound on the Hamiltonian of a BC-PHS (See Theorem IV.2.1
or [Villegas 07, Theorem 5.17])

HT (τ ) ≤ c(τ )
HT (τ ) ≤ c(τ )

Z τ
0

Z τ
0

kHz (1)z(1, t)k2R dt,

and
(IV.75)

kHz (0)z(0, t)k2R dt.

for some constant c(τ ) that only depends on τ . Since the norm of the co-energy variables evaluated
at ζ = 0 is
kHz (0)z(0, t)k2R = q̂(0, t)2 + p̂(0, t)2 + q̃(0, t)2 + p̃(0, t)2
= q̂(0, t)2 + [k1 q̂(0, t) − l1 q̃(0, t)]2 + q̃(0, t)2 + [l1 q̃(0, t)]2
q̂(0, t)
=
q̃(0, t)

!T

!

q̂(0, t)
,
q̃(0, t)

Z τ

q̂(0, t)
q̃(0, t)

1 + k12 −k1 l1
−k1 l1 1 + 2l12

!

the second inequality of (IV.75) is then equivalent to
HT (τ ) ≤ c(τ )
with

Z τ
0

!T

q̂(0, t)
q̃(0, t)

!

Ω1

q̂(0, t)
≤ c(τ )
q̃(0, t)
!

1 + k12 −k1 l1
Ω1 =
,
−k1 l1 1 + 2l12

0

!T

k1 − l21
Ω2 =
− l21 l1

!

γΩ2

q̂(0, t)
,
q̃(0, t)

!

(IV.76)

for some γ > 0 if
Ω1 ≤ γΩ2

(IV.77)

Finally, since (IV.77) is satisfied from assumption (IV.61), the Hamiltonian is bounded as
HT (τ ) ≤ c(τ )

Z τ
0

q̂(0, t)
q̃(0, t)

!T

!

γΩ2

q̂(0, t)
=α
q̃(0, t)

Z τ
0

q̂(0, t)
q̃(0, t)

!T

k1 − l21
− l21 l1

!

!

q̂(0, t)
,
q̃(0, t)

with α = c(τ )γ. Hence, inequality (IV.73) is satisfied and the exponential stability is corroborated.

By using observer-based damping injection, we can add additional damping at the non-measurable
side of the string. This is interesting when at the measurable side of the string the amount of
damping is limited. This is the case, for instance, when the value of k1 is restricted. In this case, we
assume k1 = 0.3 as shown in Table IV.4 (the greatest damping is obtained for k1 = 1 [Krstic 08]).
Then, we use the observer-based damping injection approach to add additional damping at the
non-measurable side and reduce the settling time. Using the design parameter of Table IV.4, the
conditions of Proposition IV.4.1 are satisfied since k1 > 0, k2 > 0, 0 < l1 ≤ 4k1 , and (IV.61) is
satisfied with γ = 10, for instance.
In Figure IV.24, we show the Hamiltonian of the string when three different control laws are
applied. With the blue line we show the ideal case when all is measurable and the damping is
applied at both sides without observer, with the red line we show the worst case when damping is
applied at the measurable side only, and with the green line we show the new case when damping

108



IV.4. Observer-based damping injection: application to the vibrating string

Table IV.4 – Design parameters
Parameter

Value

k1
k2
l1

0.3
1
1

Damping coefficient at the measurable side
Damping coefficient at the non-measurable side
Observer gain

is applied at both sides using the observed values. The corresponding control laws are respectively
given by
!

−k1 q(0, t)
u(t) = −
,
k2 p(1, t)

!

−k1 q(0, t)
u(t) = −
,
0

!

−k1 q̂(0, t)
u(t) = −
,
k2 p̂(1, t)

and we can notice in Figure IV.24 that the observer-based damping injection approach improves the
settling time with respect to the case where damping injection is applied at one side only.

Figure IV.24 – Hamiltonian energy in the ideal case of full damping (blue), in a partial damping
case due to the lake of sensors (red), and using the observer-based damping (green).

Figure IV.25 shows the string deformation along time and space, Figure IV.26 shows the estimated one, and Figure IV.27 shows the error. In each figure, the two black lines show the initial
and final value of w(ζ, t), ŵ(ζ, t), and w̃(ζ, t), and the orange line shows the end-tip deformations
w(1, t), ŵ(1, t), and w̃(1, t). Since we applied damping at both side of the string using the observed
values, the string deformation (Figure IV.25) converges to zero approximately at t = 3. The observed deformation (Figure IV.26) starts from a zero initial condition, reaches the string deformation
approximately at t = 2 and follows the real system behavior (converging to zero approximately at
t = 3). The error (Figure IV.27), starts from a non zero initial condition and reaches the zero
approximately at t = 2. Finally, Figure IV.29 shows the conjugated outputs and its estimations.

109



Chapter IV. Infinite-dimensional observer-based boundary controllers: late-lumping approach

Figure IV.25 – String deformation

Figure IV.26 – Estimated deformation

Figure IV.27 – Deformation error

Figure IV.28 – Hamiltonian of the plant (green),
observer (red) and error system (blue)

Remark IV.4.1. For the simulation, the string deformation and its estimation are reconstructed
numerically from the state variables. To this end, we integrate q(ζ, t) along the space and p(ζ, t)
along the time as follows
Z ζ
∂w
(ζ, t) ⇒ w(ζ, t) = w(0, t) +
q(s, t)ds,
∂ζ
0
Z t
∂w
p(ζ, t) =
(ζ, t) ⇒ w(ζ, t) = w(ζ, 0) +
p(ζ, τ )dτ.
∂t
0

q(ζ, t) =

(IV.78)
(IV.79)

The velocity at the left side p(0, t) is known from the input. The initial deformation at the left side
w(0, 0) is considered known for the reconstruction of w(ζ, t). Then, we reconstruct w(0, t) using
(IV.79). Finally, we reconstruct w(ζ, t) using of (IV.78). Both integrals in (IV.78) and (IV.79)
are solved numerically by mean of a rectangular approximation. For reconstructing the observed
deformation, we consider ŵ(0, t) = w(0, t), and we do exactly the same numerical integration as
before. However, it is important to notice that this observer does not estimate w(ζ, t). Indeed, a
displacement sensor is needed for reconstructing w(ζ, t) with an observer.
♣

110



IV.4. Observer-based damping injection: application to the vibrating string

Figure IV.29 – Convergence of the observed output ŷ(t) to the conjugated output y(t).

IV.4.2

Fully actuated string with a displacement sensor

In this part, we consider the vibrating string with actuators at both sides and with a displacement
sensor at the right side. We show that the extended system, composed of the BC-PHS, an infinitedimensional observer, and an observer-based damping injection control strategy makes the closedloop system asymptotically stable using damping injection on the observed states. The asymptotic
stability of the closed-loop system is shown using LaSalle’s invariance principle. To this end, we
assume that the trajectories of the solution of the closed-loop system are precompact. Finally,
we show with simulations that the observer-based damping injection improves the settling time
compared to when damping is applied at one side only.
We consider the vibrating string of Example IV.3.1 with a displacement sensor
!

p(a, t)
= u(t),
q(b, t)

!

−q(a, t)
y(t) =
,
p(b, t)

ym (t) = w(1, t).

From Example IV.3.2, we know that the following observer estimates asymptotically the state of the
system













q̂(ζ,
t)
0
1
q̂(ζ,
t)
q̂(ζ,
0)
q̂
(ζ)
∂
∂



=


,

= 0
,



∂t
∂ζ

p̂(ζ,
t)
1
0
p̂(ζ,
t)
p̂(ζ,
0)
p̂
(ζ)
0





P̂
(IV.80)
p̂(0,
t)
0


 = u(t) + 
,


 q̂(1, t)

l1 (ym (t) − ŷm (t) + θ(t))




θ̇(t)

= −l2 (ym (t) − ŷm (t) + θ(t)),

θ(0) = θ0 ,

111



Chapter IV. Infinite-dimensional observer-based boundary controllers: late-lumping approach

with l1 , l2 > 0, and θ(t) an external dynamic with initial condition θ0 .
Remark IV.4.2. As pointed out in [Guo 09], this is the best result in terms of convergence of the
observer, and the exponential convergence is not possible to achieve.
♣
We aim to apply the following control law to the BC-PHS (IV.29)
k 0
u(t) = − 1
0 k2

!

!

!

−q̂(0, t)
k1 q̂(0, t)
=
.
p̂(1, t)
−k2 p̂(1, t)

(IV.81)

Note that, the control law is equivalent to a damping injection using the observed states at both
sides of the string. In the following Proposition, we give the main result of this section concerning
the existence of solutions and the stability of the closed-loop system composed by (IV.29), (IV.80),
and (IV.81).
Proposition IV.4.2. Consider the closed-loop system composed by the BC-PHS (IV.29) and the
observer-based control law (IV.80)-(IV.81), with l1 , l2 , k1 , and k2 positive scalars such that 0 <
l1
< 1. Assume that the solutions are precompact. The following holds
4k2 l2
(i) The closed-loop system is well-posed.
(ii) The closed-loop system is asymptotically stable.
♦
Proof. Defining the error variables as
q̃(ζ, t) = q(ζ, t) − q̂(ζ, t),

p̃(ζ, t) = p(ζ, t) − p̂(ζ, t),

the error system becomes
!

!

∂ q̃(ζ, t)
0 1 ∂
=
p̃(ζ,
t)
1 0 ∂ζ
∂t
!

!

!

!

q̃(ζ, 0)
q̃ (ζ)
= 0
,
p̃(ζ, 0)
p̃0 (ζ)

q̃(ζ, t)
,
p̃(ζ, t)

!

p̃(0, t)
0
=
x (t),
q̃(1, t)
−l1 c
ẋc (t) = −l2 xc (t) + p̃(1, t),

xc (0) = cc0 ,

with xc (t) = ym (t) − ŷm (t) + θ(t) = w̃(1, t) + θ(t). Then, the augmented open-loop system reads
q̂(ζ, t)
0



∂ p̂(ζ, t) 1

=
∂t q̃(ζ, t) 0
p̃(ζ, t)
0






1
0
0
0

0
0
0
1

0
0
 ∂

1 ∂ζ
0


q̂(ζ, t)
p̂(ζ, t)



,
q̃(ζ, t)
p̃(ζ, t)


ẋc (t) = −l2 xc (t) + p̃(1, t),
q̂(1, t)




p̃(0, t)

0


0



q̃(1, t)

112

1 0 0
!
1 l1 
 u(t)

.
0 0  xc (t)
0 0 −l2

p̂(0, t)





=





q̂(ζ, 0)
q̂0 (ζ)
p̂(ζ, 0)
p̂ (ζ)


 0


=
,
q̃(ζ, 0)
 q̃0 (ζ) 
p̃(ζ, 0)
p̃0 (ζ)






xc (0) = cc0 .



(IV.82)



IV.4. Observer-based damping injection: application to the vibrating string

Using the control law (IV.81), the augmented closed-loop system becomes
0
q̂(ζ, t)
1

∂ 
p̂(ζ,
t)




=
∂t q̃(ζ, t) 0
0
p̃(ζ, t)






1
0
0
0

0
0
0
1

0
0
 ∂

1 ∂ζ
0


q̂(ζ, t)
p̂(ζ, t)



,
q̃(ζ, t)
p̃(ζ, t)




q̂0 (ζ)
q̂(ζ, 0)
p̂ (ζ)
p̂(ζ, 0)
 0



,

=
 q̃0 (ζ) 
q̃(ζ, 0)
p̃0 (ζ)
p̃(ζ, 0)




ẋc (t) = −l2 xc (t) + p̃(1, t),
p̂(0, t)







q̂(1, t)




p̃(0, t)

=





xc (0) = cc0 .

k1 q̂(0, t)

(IV.83)



−k p̂(1, t) + l x (t)


2
1 c

.


0

−l1 xc (t)

q̃(1, t)
We define the state of (IV.83) as





q̂(ζ, t)


p̂(ζ, t)



z(ζ, t) = 
q̃(ζ, t) ,


p̃(ζ, t)
xc (t)

(IV.84)

1Z 1
1Z 1
l1
hz1 , z2 iZ =
[q̂1 q̂2 + p̂1 p̂2 ]dζ +
[q̃1 q̃2 + p̃1 p̃2 ]dζ + xc1 xc2 ,
2 0
2 0
2

(IV.85)

and the inner product

where z1 = (q̂1 , p̂1 , q̃1 , p̃1 , xc1 )T and z2 = (q̂2 , p̂2 , q̃2 , p̃2 , xc2 )T . Then, we write the system (IV.83) in
the abstract state space representation. To this end, we define the state space as




Z = L2 [0, 1]; R4 × R

(IV.86)

and the operator A as








q̂
p̂ζ

 

 p̂ 


q̂ζ
 






p̃ζ
Az = A  q̃  = 

 


q̃
p̃
 


ζ
−l2 xc + p̃(1)
xc
with domain




(IV.87)



D(A) = (q̂, p̂, q̃, p̃)T ∈ H 1 ([0, 1], R4 ), xc ∈ R

p̂(0)=k1 q̂(0),

q̂(1)=−k2 p̂(1)+l1 xc ,
.
p̃(0)=0,

q̃(1)=−l1 xc .

(IV.88)

Finally, the closed-loop system is represented in the abstract formulation as
ż(t) = Az(t), z(0) = z0 ∈ Z.

(IV.89)

We use the Lümer-Phillips theorem to show that the operator A (IV.87) with domain D(A)
(IV.88) generates a contraction semigroup, which is equivalent to show that the closed-loop system
(IV.29), (IV.80), (IV.81) is well-posed. To this end, we follow the same steps than in [Augner 18,

113



Chapter IV. Infinite-dimensional observer-based boundary controllers: late-lumping approach

Theorem 3.3.6] (See also [Villegas 07, Theorem 5.8]). First, we show that the operator A is dissipative, and then we show that the range of the operator I − A is equivalent to the space defined for
z in (IV.86).
For simplicity, we avoid the time and space dependency, and we use a dot for the time derivative,
a subscript ζ for the spatial derivative and a subscript 0 or 1 when the variables are evaluated at
∂ q̂
(ζ, t), q̂1 = q̂(1, t).
ζ = 0 or ζ = 1, respectively. For example q̂˙ = ∂∂tq̂ (ζ, t), q̂ζ = ∂ζ
To show that the operator A is dissipative, we have to show that the norm induced by (IV.85),
defined as
i
1Z 1h 2
l1
(IV.90)
E(t) = hz, ziZ =
q̂ + p̂2 + q̃ 2 + p̃2 dζ + x2c ,
2 0
2
is non increasing. To this end, we differentiate (IV.90) along time as follow:
Ė(t) =

Z 1h
0

=

i

q̂ q̂˙ + p̂p̂˙ + q̃ q̃˙ + p̃p̃˙ dζ + l1 xc ẋc

Z 1
0

[q̃ p̃ζ + p̃q̃ζ + q̂ p̂ζ + p̂q̂ζ ] dζ + l1 xc [−l2 xc + p̃1 ]

= q̂1 p̂1 − q̂0 p̂0 + q̃1 p̃1 − q̃0 p̃0 + l1 p̃1 xc − l1 l2 x2c
= [−k2 p̂1 + l1 xc ] p̂1 − k1 q̂02 − l1 p̃1 xc − l1 l2 x2c + l1 p̃1 xc
= −k2 p̂21 + l1 p̂1 xc − k1 q̂02 − l1 l2 x2c
= −k2 p̂21 + l1 p̂1 xc − 1 l1 l2 x2c − k1 q̂02 − 2 l1 l2 x2c
h

(IV.91)

i

= − k2 p̂21 − l1 p̂1 xc + 1 l1 l2 x2c − k1 q̂02 − 2 l1 l2 x2c
=−

q

k2 p̂1 −

q

1 l1 l2 xc

2

− k1 q̂02 − 2 l1 l2 x2c .

where in the first line we have differentiated with respect to time, in the second line we have used
(IV.89), in the third line we have used integration by part, in the fourth line we have replaced the
boundary conditions given in (IV.88), in the fifth line we have grouped some terms, in the sixth line
we have used 1 + 2 = 1 with 0 < 1 < 1 and 0 < 2 < 1, and in the two last lines we have grouped
some terms such that 1 = 4kl21l2 . Since Ė(t) ≤ 0 for all t ≥ 0, the energy norm is non increasing
and hence the operator A is dissipative.
Now, we have to show that the range of the operator I − A is equal to Z in (IV.86). To do so,
we solve the following ordinary differential equation
(I − A)z = f

(IV.92)

where z ∈ D(A) is the unknown variable and f ∈ Z is given. We define f = (σ̂, ρ̂, σ̃, ρ̃, fc )T , we
replace it in (IV.92), and we use (IV.87) to obtain the following ODEs
q̂ − p̂ζ = σ̂
p̂ − q̂ζ = ρ̂
q̃ − p̃ζ = σ̃
p̃ − q̃ζ = ρ̃
xc + l2 xc − p̃(1) = fc

114

(IV.93a)
(IV.93b)
(IV.93c)
(IV.93d)
(IV.93e)



IV.4. Observer-based damping injection: application to the vibrating string

Equations (IV.93a) − (IV.93d) are written in compact form as
x(ζ) − P1

d
x(ζ) = xf (ζ)
dζ

(IV.94)

with
0
q̂
1
p̂


  , P1 = 
x=
0
q̃ 
0
p̃


 

1
0
0
0

0
0
0
1

σ̂
0



0
 ρ̂ 
 , xf =  
σ̃ 
1
ρ̃
0
 



Since P1 is invertible, we define Af = P1−1 and Bf = −P1−1 . Then, the ODE (IV.94) becomes
d
x(ζ) = Af x(ζ) + Bf xf (ζ)
dζ

(IV.95)

which has a general solution
x(ζ) = eζAf x(0) +

Z ζ
0

e(ζ−s)Af Bf xf (s)ds

(IV.96)

where the term x(0) is partially known from the domain of A in (IV.88). We aim to describe the full
x(0) in terms of the other known boundary conditions and also in terms of the external dynamics
(IV.93e). To do so, we write down the boundary conditions from the domain of A in (IV.88) and
from (IV.93e) we obtain the following set of equations.
p̂(0) = k2 q̂0 ,
q̂(1) = −k2 p̂(1) + l1 xc ,
p̃(0) = 0,
q̃(1) = −l1 xc ,
(1 + l2 )xc − p̃(1) = fc .

(IV.97)

We reorganize the last equations as
p̂(0) − k2 q̂0 = 0,
q̂(1) + k2 p̂(1) − l1 xc = 0,
p̃(0) = 0,
q̃(1) + l1 xc = 0,
(1 + l2 )xc − p̃(1) = fc ,

(IV.98)

and we write them in matrix representation











0 0
1 k2
0 0
0 0
0 0

0 0 −k2
0 0
0
0 0
0
1 0
0
0 −1 0

1
0
0
0
0

0
0
0
0
0

0
0
1
0
0



q̂(1)


p̂(1)


 
q̃(1)
0
0




 
p̃(1)
0
−l1 


 




0  q̂(0) = 
0.


 
l1  p̂(0)  0 



fc
1 + l2 
q̃(0)
p̃(0)


xc

(IV.99)

115



Chapter IV. Infinite-dimensional observer-based boundary controllers: late-lumping approach

We define


WB Rext =

0 0 −k2
0 0
0
0 0
0
1 0
0
0 −1 0

0 0
1 k2
0 0
0 0
0 0









1
0
0
0
0

0
0
0
0
0

0
0
0 −l1
1
0
0
l1
0 1 + l2





,




(IV.100)

and
q̂(1)
p̂(1)


 


q̃(1)
0




 


0
x(1)
p̃(1)
 





x(0) = q̂(0) , and Fc = 
0.




p̂(0)
xc
0


q̃(0)
fc




p̃(0)
xc




(IV.101)

Then, the set of equations (IV.99) becomes




x(1)


WB Rext x(0) = Fc .
xc

(IV.102)

We obtain x(1) from the general solution (IV.96) evaluated at ζ = 1. Then, the set of equation
(IV.102) becomes

 A
R
e f x(0) + 01 e(1−s)Af Bf xf (s)ds


WB Rext 
x(0)


= Fc

xc

 A

e f x(0)


WB Rext  x(0) 

=

xc

 A
e f

WB Rext  I

0

!

x(0)
=
xc



R 1 (1−s)A

f B x (s)ds
f f
0 e


Fc − 
0


0

!
0
 x(0)
0
=
xc
1

R 1 (1−s)A

f B x (s)ds
f f
0 e


Fc − 
0


(IV.103)

0

R 1 (1−s)A

f B x (s)ds
f f
0 e


Γ−1 
0
Fc − 



0

with
Γ=

 A
e f

WB Rext  I

0



0
0

1

(IV.104)

Now, x(0) and xc are defined only in terms of f from (I − A)z = f . Replacing x(0) in (IV.96), we
can check that z = (xT , xc )T ∈ D(A) and is defined only in terms of f . So, the range of I − A is
Z, which concludes that the operator A (IV.87) with domain D(A) (IV.88) generates a contraction
semigroup, or equivalently the closed-loop system (IV.29), (IV.80), (IV.81) is well-posed.

116



IV.4. Observer-based damping injection: application to the vibrating string

We use LaSalle’s invariance principle to show the second result of Proposition IV.4.1. Since the
solutions of (IV.89) are precompact and Ė ≤ 0 (IV.91), the solutions converge asymptotically to the
maximal invariant subset
)
(
I = z ∈ Z Ė = 0 .

(IV.105)

Hence, to show that the solutions of (IV.89) converge asymptotically to zero, we have to show that
the subset I in (IV.105) contains only the zero solution. To do so, we evaluate Ė = 0 in (IV.91),
and we obtain p̂1 = q̂0 = xc = 0. Since xc = 0 implies ẋc = 0, from (IV.83) we can conclude p̃1 = 0.
Then, we can conclude that the only solution for x̂˙ = P1 ( 01 10 ) ∂∂ζx̂ , with boundary conditions p̂0 = 0,
q̂1 = 0, p̂1 = 0, and q̂0 = 0, is x̂ = 0. On the error side, xc = 0 implies q̃1 = 0. Then, the only
solution for x̃˙ = P1 ( 01 10 ) ∂∂ζx̃ , with boundary conditions p̃0 = 0, q̃1 = 0, and p̃1 = 0, is x̃ = 0. Since
the only point contained in I (IV.105) is zero, then by using LaSalle’s invariance principle, the state
of the dynamic equation (IV.89) converges asymptotically to zero.

Remark IV.4.3. The result (i) from Proposition IV.4.1 is given for the particular example of the
one-dimensional wave equation. However, it can be extended to the class of BC-PHSs if we assume
that the matrix Γ (IV.104) is invertible.
♣
Remark IV.4.4. Using the LaSalle’s invariance principle for the general case of BC-PHS is an
open question.
♣
Table IV.5 – Controller parameters
Parameter
k1
k2

Table IV.6 – Observer parameters

Value
1
0.3

Parameter

Value

l1
l2

1000
1000

Using the controller parameters of Table IV.5 and the observer parameters of Table IV.6, the
conditions of Proposition IV.4.2 are satisfied since l1 , l2 , k1 , and k2 are all positive scalars, and
0 < 4kl21l2 < 1. Note that, we fix the damping coefficient smaller at the right side than at the left
side to exemplify the case where the amount of damping at the right side is limited to not be the
greatest damping (k2 = 1), and at the left side we add the greatest damping for this example with
k1 = 1.
In Figure IV.30, we show the Hamiltonian of the string considering three different scenarios.
With the blue line we show the ideal case when velocity and strain are measured at both sides of
the spatial domain and damping injection is applied at both sides without observer, with the red
line we show the worst case when damping is applied only at the measurable side using a velocity
estimator at ζ = 1, and with green line we show the new case when damping is applied at both side
using the observed values. The corresponding control laws are respectively given by
!

−k1 q(0, t)
u(t) = −
,
k2 p(1, t)

!

0
u(t) = −
,
k2 v1 (t)

!

−k1 q̂(0, t)
u(t) = −
.
k2 p̂(1, t)

We can notice in Figure IV.30 that the observer-based damping injection approach improves the
settling time with respect to the partial damping approach.

117



Chapter IV. Infinite-dimensional observer-based boundary controllers: late-lumping approach

Figure IV.30 – Hamiltonian energy in the ideal case of full damping (blue), in a partial damping
case due to the lake of sensors (red), and using the observer-based damping (green).

Figure IV.31 shows the string deformation, Figure IV.32 shows the estimated string deformation,
and Figure IV.33 shows the deformation error between the BC-PHS and the observer. The three
figures are shown along the time t and space ζ. In each figure, the two black lines show the initial
and final values of w(ζ, t), ŵ(ζ, t), and w̃(ζ, t), and the orange line shows the end-tip deformations
w(1, t), ŵ(1, t), and w̃(1, t). Since we apply damping at both side of the string using the observed
values, the string (Figure IV.31) converges to zero approximately in 3 seconds. The observer (Figure
IV.32) starts from a zero initial condition and reaches the state of the BC-PHS approximately at
t = 2 and as well as the string deformation, the estimated one converges to zero approximately
at t = 3. The error (Figure IV.33), starts from a non zero initial condition and reaches the zero
approximately at t = 2. Finally, Figure IV.35 shows the conjugated outputs and its estimations.

Figure IV.31 – String deformation

118

Figure IV.32 – Estimated deformation



IV.4. Observer-based damping injection: application to the vibrating string

Figure IV.33 – Deformation error

Figure IV.34 – Hamiltonian of the plant (green),
observer (red) and error system (blue)

Figure IV.35 – Observer convergence of the conjugated output ŷ(t) to y(t).

119



Chapter IV. Infinite-dimensional observer-based boundary controllers: late-lumping approach

IV.5

Observer-based damping injection and energy shaping: application to the vibrating string

In this section, we consider the vibrating string (Example II.3.2) attached at one side and with
a force actuator and velocity sensor at the other side. The objective is to apply energy shaping
and damping injection. Since the desired control law is a state feedback control law, we require the
state variable knowledge to implement it. We use an infinite-dimensional observer to reconstruct
the state of the system. Then, we implement the control law using the observed values from the
infinite-dimensional observer.
The open loop BC-PHS is described by (See Example II.3.2)




∂ q(ζ, t)





 ∂t p(ζ, t)











0 1 ∂ q(ζ, t)
=
,
1 0 ∂ζ p(ζ, t)









q(ζ, 0) q0 (ζ)
=
,
p(ζ, 0)
p0 (ζ)



P p(0, t) = 0,





q(1, t) = u(t),




y(t) = p(1, t),

(IV.106)

and the desired control law is given by
u(t) = −

Z 1

q(ζ, t)dζ − p(1, t).

(IV.107)

0

We have seen in the previous sections that the following infinite-dimensional observer

P̂





q̂(ζ,
t)
∂






 ∂t p̂(ζ, t)









0 1 ∂ q̂(ζ, t)
=
,
1 0 ∂ζ p̂(ζ, t)









q̂(ζ, 0) q̂0 (ζ)

,
=
p̂(ζ, 0)
p̂0 (ζ)

= 0,
q̂(1, t) = u(t) + y(t) − p̂(1, t),



p̂(0, t)





(IV.108)

estimates exponentially the state variables of (IV.106) for some l1 > 0 (See Proposition IV.3.2).
Then, we can apply the following control law
u(t) = −

Z 1

q̂(ζ, t)dζ − p̂(1, t)

(IV.109)

0

instead of the desired one (IV.107). As soon as the observer converge to the real state, the control
law (IV.109) converges to the desired one (IV.107).
Remark IV.5.1. Note that, the OBSF controller (IV.108)-(IV.109) is a particular case of a more
general OBSF controllerR where (IV.108) is such that q̂(1, t) = u(t) + l1 (y(t) − p̂(1, t)) and (IV.109)
is such that u(t) = −qc 01 q̂(ζ, t)dζ − dc p̂(1, t), with l1 , qc and dc > 0 some design parameters. For
simplicity, we consider l1 = qc = dc = 1.
♣
We define the error states as q̃(ζ, t) = q(ζ, t) − q̂(ζ, t) and p̃(ζ, t) = p(ζ, t) − p̂(ζ, t), and we write
the augmented closed-loop system composed by the observer and the error system

120



IV.5. Observer-based damping injection and energy shaping: application to the vibrating string

0
q̂(ζ, t)


∂ 
1
p̂(ζ, t)

=
∂t q̃(ζ, t) 0
0
p̃(ζ, t)






1
0
0
0

0
0
0
1

0
0
 ∂

1 ∂ζ
0


q̂(ζ, t)
p̂(ζ, t)



,
q̃(ζ, t)
p̃(ζ, t)




q̂0 (ζ)
q̂(ζ, 0)
p̂ (ζ)
p̂(ζ, 0)

 0


,

=
 q̃0 (ζ) 
q̃(ζ, 0)
p̃0 (ζ)
p̃(ζ, 0)








0
p̂(0, t)
− R 1 q̂(ζ, t)dζ − p̂(1, t) + p̃(1, t)
q̂(1, t)




0
.

=


p̃(0, t)
0
q̃(1, t)
−p̃(1, t)








(IV.110)

We use a Lyapunov function to show the asymptotic stability of (IV.110). To this end, we
use LaSalle’s invariance principle, assuming that the system (IV.110) is well-posed, the trajectories
are precompact, and the system is approximately observable with respect to the outputs p̂(1, t) and
p̃(1, t). The Lyapunov function is the following:
V (t) =

i
1Z 1h
1
q̂(ζ, t)2 + p̂(ζ, t)2 + q̃(ζ, t)2 + p̃(ζ, t)2 dζ + ŵ(1, t)2 .
2 0
2

(IV.111)

For simplicity, we use the following notation
q̂1 = q̂(1, t), q̂0 = q̂(0, t), q̃1 = q̃(1, t), q̃1 = q̃(0, t), ŵ1 = ŵ(1, t),
p̂1 = p̂(1, t), p̂0 = p̂(0, t), p̃1 = p̃(1, t), p̃1 = p̃(0, t), ŵ0 = ŵ(0, t).
The derivative with respect to time of the Lyapunov function (IV.111) reads
V̇ (t) = q̂1 p̂1 − q̂0 p̂0 + q̃1 p̃1 − q̃0 p̃0 + ŵ1 ŵ˙ 1 ,
= [−ŵ1 − p̂1 + p̃1 ] p̂1 − p̃21 + ŵ1 p̂1 ,

(IV.112)

2

= − 12 (p̂1 − p̃1 ) − 21 p̂21 − 12 p̃21 .
Since the system (IV.110) is well-posed, and the trajectories are precompact, we can use LaSalle’s
invariance principle extended to infinite-dimensional systems to show the closed-loop asymptotic
stability (See [Luo 12, Theorem 3.64]). It follows then, that all solutions of the closed-loop system
tend to the maximal invariant set of ϑc = {q̂(ζ, t), p̂(ζ, t), q̃(ζ, t), p̃(ζ, t) ∈ L2 ([a, b]), | V̇ (t) = 0}. We
define the maximal invariant subset of ϑc as I, and we show that I only contains the zero state,
i.e. I = {q̂(ζ, t) = p̂(ζ, t) = q̃(ζ, t) = p̃(ζ, t) = 0}. V̇ = 0 implies p̂1 = 0 and p̃1 = 0. The system
being approximately observable with respect to the outputs p̂1 and p̃1 implies that q̂(ζ, t) = p̂(ζ, t) =
q̃(ζ, t) = p̃(ζ, t) = 0 is the only point in I (See [Curtain 12, Corollary 4.1.14]). Thus, by LaSalle’s
invariance principle, the asymptotic stability of the closed-loop system is guaranteed.
We simulate the closed-loop system (IV.110) using the same spatial and time discretization
method as in the previous sections. We note that for real implementations, the OBSF controller
(IV.108)-(IV.109) has to be discretized using appropriate methods in such a way that it guarantees
stability when applied to the infinite-dimensional system. For simplicity, in the following, we consider
the same discretization size for the plant (IV.106) and the observer (IV.108). We show the string

121



Chapter IV. Infinite-dimensional observer-based boundary controllers: late-lumping approach

Figure IV.36 – String deformation

Figure IV.37 – Observed deformation

deformation along the time and the space in Figure IV.36. In Figure IV.37, we show the observed
values. Both variables reach the zero equilibrium around t = 6 s. In Figure IV.36, we show in a
green line the desired end-tip behavior. This is, when (IV.107) is applied instead of (IV.109).
Finally, the control law (IV.109) is slightly modified in order to change the equilibrium point.
Now, we consider the following control law
u(t) = 2w1∗ −

Z 1

q̂(ζ, t)dζ − p̂(1, t),

(IV.113)

0

where w1∗ represents the end-tip desired position. Now, we simulate the closed-loop system using
the control law (IV.113) with zero initial condition for the system and nonzero initial condition for
the observer. Note that, the initialization of the observer is chosen different to zero to show the
influence of the observer dynamics on the spatial-temporal response. If the observer is initialized
with the same initial condition than the one of the system, the temporal response is identical to the
desired one. For the simulation we use w1∗ = 0.1. In Figure IV.38, we show the string deformation
along the time and the space. The green line represents the desired end-tip deformation, when the
control law uses the state of the system instead of the observed state. In Figure IV.39, we show the
observed deformation along the time and the space. Similarly as in the previous simulation, both
systems reach the equilibrium at t = 6 s approximately. The observed deformation converges to the
real one at t = 2 s approximately. We can note that the reached equilibrium is independent of the
initial condition of the observer.

122



IV.5. Observer-based damping injection and energy shaping: application to the vibrating string

Figure IV.38 – String deformation

Figure IV.39 – Observed deformation

123



Chapter IV. Infinite-dimensional observer-based boundary controllers: late-lumping approach

IV.6

Conclusion

We have presented a general setting for the design of infinite-dimensional observers for impedance
energy preserving BC-PHSs. We have covered different scenarios depending on the available measurements. In the following, we enumerate the three cases covered in this chapter:
(i) The conjugated output is measured (fully or partially). We have shown that the state variable
of the proposed infinite-dimensional observer converges exponentially to the system one.
(ii) The integral over time of the conjugated output is measured. We have shown that the state
variable of the proposed infinite-dimensional observer converges asymptotically to the system
one.
(iii) Scenarios (i) and (ii) together. We have shown that the state variable of the proposed infinitedimensional observer converges exponentially to the system one.
We have used the infinite-dimensional observers proposed in this chapter to apply energy shaping
and damping injection to the vibrating string example. The following cases have been covered in
this chapter:
(i) We have considered that we measure the force at one side of the actuated string. We have
proposed an infinite-dimensional observer to estimate the state variable of the system. Then,
we have applied a damping injection strategy at both sides of the string using the observed
values. We have shown the exponential stability of the closed-loop system.
(ii) We have considered that we measure the end-tip deformation of the string. We have proposed
an infinite-dimensional observer to estimate the state variables of the system. Then, we have
applied a damping injection strategy at both sides of the string using the observed values. We
have shown the asymptotic stability of the closed-loop system.
(iii) Finally, we have considered the string attached at one side and with a force actuator and
velocity sensor at the other side. We have proposed an infinite-dimensional observer to estimate
the state variables of the system. Then, we have applied an energy shaping and damping
injection strategy using the observed values. We have shown the asymptotic stability of the
closed-loop system.
The results presented in this chapter are some first steps towards observer-based energy shaping
and damping injection for impedance energy preserving BC-PHSs. The generalization to a larger
class of BC-PHSs, including non impedance energy preserving systems and systems in 2D or 3D,
can be investigated in the future. A model reduction of the OBSF controller is also proposed as
future work. This is necessary for the real implementation, and the reduced OBSF controller has to
guarantee the closed-loop stability when it is applied to the BC-PHS.

124



Chapter V
Conclusions and future works

V.1

Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 126

V.2

Future works . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 128

125



Chapter V. Conclusions and future works

V.1

Conclusions

In this thesis, we have considered the synthesis of observer-based state feedback (OBSF) control
laws for linear impedance energy preserving boundary controlled port-Hamiltonian systems (BCPHSs). To this end, we have used two different approaches, namely the early-lumping approach and
the late-lumping approach.
Using an early-lumping approach, the synthesis of the OBSF controller follows the following
steps:
1. The BC-PHS is discretized into a finite-dimensional model (discretized model).
2. The controller and observer gains are designed on the discretized model.
3. The OBSF controller is applied to the BC-PHS.
Using an illustrative example, we have shown that if we design the controller and observer gains
independently of each other using classic control tools, the closed-loop stability is not always guaranteed when applying the OBSF controller to the BC-PHS. To handle this stability problem, we
have imposed a passive structure on the OBSF controller. We have shown that if we use this structure, the OBSF controller stabilizes the BC-PHS. To achieve this structure, we have proposed two
methodologies for the synthesis of the OBSF gains. These methodologies are summarized as follows:
1. The state feedback gain is designed independently using classic control tools like the linear
quadratic regulator or the pole placement. Then, by solving an algebraic Riccati equation, the
observer gain is designed such that the OBSF controller is passive.
2. The observer gain is designed independently using classic control tools like the linear quadratic
regulator or the pole placement. Then, by solving a set of linear matrix inequalities, the state
feedback gain is designed such that the OBSF is passive.
Using these approaches, one of the two gains of the OBSF controller is restricted to satisfy the
passive structure. This design limitation allows to guarantee the closed-loop stability between the
BC-PHS and the OBSF controller. We have proposed a design procedure for both methodologies,
and they have been exemplified using the vibrating string and the Timoshenko beam models.
We have shown that the same procedures can be used to stabilize a class of nonlinear timeinvariant (NTI) systems. Since the proposed OBSF controller is output strictly passive (OSP) and
zero state detectable (ZSD), it stabilizes nonlinear systems that are OSP and ZSD too. In this
case, the synthesis is based on a linearized model of the NTI system. We have shown that when
applying the OBSF controller to the NTI system, closed-loop stability is guaranteed. We have used
a microelectromechanical system to exemplify the synthesis method.

126



V.1. Conclusions

Using a late-lumping approach, the synthesis of the OBSF controller follows the following steps:
1. An infinite-dimensional observer is designed based on the infinite-dimensional BC-PHS.
2. The desired control law is applied using the state variable of the infinite-dimensional observer.
3. The OBSF controller has to be discretized for real implementation.
We have proposed a general setting for the synthesis of infinite-dimensional observers for impedance
energy preserving BC-PHSs. We have studied the following cases:
1. The conjugated output is fully or partially measured. This is the case when forces and/or
velocities in mechanical systems are measured.
2. The integral over time of the conjugated output is measured. This is the case when deformations or displacements in mechanical systems are measured.
3. Scenarios 1 and 2 together. This is the case when both velocities and displacements in mechanical systems are measured, for instance.
In the first case, we have shown that the error between the state of the BC-PHS and the state of
the infinite-dimensional system converges to zero exponentially. In the second case, we have shown
that the error converges asymptotically to zero and in the third one, we have shown that the error
converges exponentially to zero. We have used the vibrating string and the Timoshenko beam with
different types of measurements to exemplify the different scenarios.
Finally, we have used infinite-dimensional observers to apply energy shaping and damping injection to the vibrating string using the observed values. We have considered the following closed-loop
scenarios
1. The force at one side of the vibrating string is measured. We have applied a damping injection
strategy at both sides of the vibrating string using the observed state from an exponentially
convergent observer. We have shown the exponential stability of the closed-loop system.
2. The end-tip deformation at one side of the vibrating string is measured. We have applied
a damping injection strategy at both sides of the string using the observed state from an
asymptotically convergent observer. We have shown the asymptotic stability of the closedloop system.
3. The string attached at one side and with a force actuator and velocity sensor at the other
side. We have applied an energy shaping and damping injection strategy using the observed
values from an infinite-dimensional observer. We have shown the asymptotic stability of the
closed-loop system.

127



Chapter V. Conclusions and future works

V.2

Future works

Concerning the early-lumping approach presented in Chapter III, we propose the following future
works
(i) The design methodologies for the OBSF gains proposed in Chapter III can be extended to 2D
and 3D systems as soon as structure-preserving discretization methods are used [Brugnoli 19a,
Brugnoli 19b, Serhani 19].
(ii) The closed-loop performances depend on the accuracy of the discretized model used for the
design. The accuracy of the discretized model depends on the number of state variables of it.
An optimal amount of elements could be proposed in such a way that the discretized model is
small enough to avoid a huge amount of states in the controller and big enough to achieve the
desired performances. This optimality could be characterized by defining some appropriate
criteria.
(iii) The degrees of freedom concerning the synthesis of the OBSF gains could be reduced to
optimize a cost function.
(iv) To reach some desired output, we can add an integrator to the error between the output and
the desired one. Then, the OBSF design can be modified to obtain the integrator gains as
well.
(v) The same methodologies for the synthesis of the OBSF controller could be formulated for the
in-domain control problem.
(vi) A general setting of BC-PHSs with dissipation could be studied. In this case, the strictly
positive real condition imposed on the OBSF controller could be relaxed for achieving the
asymptotic or exponential stability in the closed-loop.
(vii) The OBSF formulation can be extended to the case when the plant is a couple of partial
differential equations (PDEs) and ordinary differential equations (ODEs). This is the case, for
instance, when the string is attached to a mass or a spring. The controller and observer gain
could be designed similarly as in Chapter III including some extra conditions depending on
the nature of the ODEs and the nature of the control inputs that can be in the PDEs or the
ODEs.
(viii) Since the same methodologies can stabilize a class of nonlinear finite-dimensional system, it
seems that the same methodologies could stabilize a class of nonlinear infinite-dimensional
systems.

128



V.2. Future works

Concerning the late-lumping approach presented in Chapter IV, we propose the following future
works
(i) The general setting of infinite-dimensional observers for BC-PHSs could be extended to the
dissipative case and to a more general class of BC-PHSs where the Euler-Bernoulli beam is
also included.
(ii) The general setting of observer-based damping injection and energy shaping could be studied
for BC-PHSs.
(iii) The discretization of the controller using observer-based damping injection and energy shaping
could be addressed in order to preserve the closed-loop stability.
(iv) Infinite-dimensional observers could be proposed for two-dimensional and three-dimensional
BC-PHSs.

129





Appendix A
Appendix

A.1

Finite-differences spatial discretization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 132
A.1.1 Vibrating string . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 132
A.1.2 Timoshenko beam . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 134

A.2

Mid-point time discretization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 138

A.3

An LMI approach to design K or L . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 139

A.4

Abstract formulation of boundary control systems . . . . . . . . . . . . . . . . . . . . . . . 141

131



Appendix A. Appendix

A.1

Finite-differences spatial discretization

The reader is refereed to [Trenchant 18] for further details on this discretization method. The
benefits of using this discretization method are the following
— The discretized model preserves the port-Hamiltonian structure.
— The boundary conditions can be modified easily.
— The code for simulation is easy to implement.

A.1.1

Vibrating string

We consider the vibrating string with spatial variable ζ ∈ [a, b], time variable t ≥ 0 and with
dynamical boundary conditions given by the velocity at ζ = a and the force ζ = b. The system is
written as follows

∂x
∂


(ζ, t) = P1 (H(ζ)x(ζ, t)) ,



∂t 
∂ζ





H(b)x(b, t) 



P VB H(a)x(a, t)










y(t)

x(ζ, 0) = x0 (ζ),

= u(t),



(A.1)



H(b)x(b, t) 
= VC 
,
H(a)x(a, t)

with
!

!

!

T (ζ)
q(ζ, t)
q (ζ)
0 1
x(ζ, t) =
, x0 (ζ) = 0
, P1 =
, H=
0
p(ζ, t)
p0 (ζ)
1 0
!

0
1
ρ(ζ)

!

,

!

0 0 0 1
0 0 −1 0
VB =
, VC =
,
1 0 0 0
0 1 0 0
where q(ζ, t) := ∂w
(ζ, t) is the strain, p(ζ, t) := ρ(ζ) ∂w
(ζ, t) is the momentum, w(ζ, t) is the string
∂ζ
∂t
deformation, T (ζ) is the Young’s modulus, ρ(ζ) is the mass density of the string, and x0 (ζ) is the
initial condition. u(t) and y(t) are
the input
and output, respectively.


H(b)x(b,t)
The boundary conditions VB H(a)x(a,t) define the staggered grid as we show in Figure A.1, where
q
ζi is the spatial location for the strain variable and ζip for the momentum one with i = {1, 2, 3, 4}. In
this example, we take 4 states for describing the strain q(ζ, t) and 4 states for describing momentum
p(ζ, t). Then, we define 4 finite-dimensional variables for each one as follows
q1 (t) ≈ q(ζ1q , t),
q2 (t) ≈ q(ζ2q , t),
q3 (t) ≈ q(ζ3q , t),
q4 (t) ≈ q(ζ4q , t),

p1 (t) ≈ p(ζ1p , t),
p2 (t) ≈ p(ζ2p , t),
p3 (t) ≈ p(ζ3p , t),
p4 (t) ≈ p(ζ4p , t),

In this case, the length of the grid is given by h =

132

b−a
,
nd +1

with nd = 8. We define ρi = ρ(ζip )



A.1. Finite-differences spatial discretization

ζ
ζ1q

a

ζ1p

ζ2p

ζ2q

ζ3q

ζ3p

ζ4q

ζ4p

b

Figure A.1 – Discretization grid for the vibrating string.
and Ti = T (ζiq ) for i = {1, 2, 3, 4}. Then, using the
obtained
!
1 1
p1 (t) − va (t) ,
q̇1 (t) =
h ρ1
!
1 1
1
q̇2 (t) =
p2 (t) − p1 (t) ,
h ρ2
ρ1
!
1
1 1
p3 (t) − p2 (t) ,
q̇3 (t) =
h ρ3
ρ2
!
1 1
1
q̇4 (t) =
p4 (t) − p3 (t) ,
h ρ4
ρ3

finite-differences, the following discretization is
1
(T2 q2 (t) − T1 q1 (t)) ,
h
1
ṗ2 (t) = (T3 q3 (t) − T2 q2 (t)) ,
h
1
ṗ3 (t) = (T4 q4 (t) − T3 q3 (t)) ,
h
1
ṗ4 (t) = (Fb (t) − T4 q4 (t)) ,
h
ṗ1 (t) =

where va (t) is the velocity at ζ = a and Fb (t) is the force ζ = b. Then, we can write the equations
in a matrix form


d
dt
















q1
q2
q3
q4
p1
p2
p3
p4

























1 


2
h 






=



0 0 0 0 1 0 0 0

0 0 0 0 −1 1 0 0 



0 0 0 0 0 −1 1 0 


0 0 0 0 0 0 −1 1 



−1 1 0 0 0 0 0 0 



0 −1 1 0 0 0 0 0  

0 0 −1 1 0 0 0 0  

0 0 0 −1 0 0 0 0

hT1 q1
hT2 q2
hT3 q3
hT4 q4
h
p
ρ1 1
h
p
ρ2 2
h
p
ρ3 3
h
p
ρ4 4












+























1
h

−1
0
0
0
0
0
0
0

0
0
0
0
0
0
0
1






"










va
Fb

#

where for simplicity, we have omitted the time dependency. We define the discretized strain as qd (t)
and the discretized momentum as pd (t) as follows






q1 (t)

.. 
qd (t) = 
. 

,
q4 (t)



p1 (t)

.. 
pd (t) = 
. 
.

p4 (t)

Then, we obtain the following finite-dimensional model
d
dt

"

qd (t)
pd (t)

#

"

=

0
−DT

D
0

#"

Q T qd
Qρ p d

#

"

+

ba 0
0 bb

#"

va
Fb

#

133



Appendix A. Appendix

with


D=

1
h2







QT =



h


1 0 0
−1 1 0
0 −1 1
0 0 −1

0
0
0
1



T1 0 0 0
0 T2 0 0
0 0 T3 0
0 0 0 T4







,


ba =



,


1


h

Qρ =

−1
0
0
0



,


 1
ρ
 1
 0
h
 0


0

0
0
0
1





bb =

0

1


h

0
0

1
ρ2

1
ρ3

0
0

0

0
0
0
1
ρ4









,



Finally, we can write the discretized model as a finite-dimensional port-Hamiltonian system

ẋ

d (t) = (J − R)Qxd (t) + Bu(t)
P
y(t) = B T Qxd (t)

where

"

#

0
D
T
−D
0

J=

, R=

"

xd (t) =

"

qd (t)
pd (t)

0 0
0 0

#

#

"

, Q=
"

, u(t) =

va (t)
Fb (t)

QT 0
0 Qρ

#

(A.2)

#

"

, B=
"

, y(t) =

−T1 q1 (t)
1
p (t)
ρ4 4

ba 0
0 bb

#

#

.

Note that, the discretized model A.2 has the same structure when nd increase.

A.1.2

Timoshenko beam

In this section, we discretize the Timoshenko beam with dynamical boundary conditions given
by the transversal velocity at the left side va (t), the angular velocity at the left side wa (t), the force
at the right side Fb (t) and the torque at the right side Γb (t). We use finite differences in staggered
grids as in [Trenchant 18]. The model is given by

∂x
∂


(ζ, t) = P1 (H(ζ)x(ζ, t)) + P0 (H(ζ)x(ζ, t)) ,



∂t 
∂ζ





H(b)x(b, t) 



P VB H(a)x(a, t)










y(t)

x(ζ, 0) = x0 (ζ),

= u(t),



(A.3)



H(b)x(b, t) 
= VC 
,
H(a)x(a, t)

with
x1 (ζ, t)
x10 (ζ)
x (ζ, t)
x (ζ)

 20

2
x(ζ, t) = 

 , x0 (ζ) = 
,
x3 (ζ, t)
x30 (ζ)
x4 (ζ, t)
x40 (ζ)


0
1

P1 = 
0
0


134

1
0
0
0

0
0
0
1

0
0


0
0
 , P0 = 
0
1
0
1






0
0
0
0






K(ζ)
0 −1


 0
0 0
, H = 
 0
0 0

0
0 0



0
1
ρ(ζ)

0
0

0
0
EI(ζ)
0

0
0
0
1
Iρ (ζ)




,





A.1. Finite-differences spatial discretization

0
0

VB = 
1
0


0
0
0
0

0
0
0
1

0
0
0
0

0
0
0
0

1
0
0
0

0
0
0
0

0
0


1
0
 , VC = 
0

0
0
0




0
0
1
0

0
0
0
0

0 −1 0 0 0
0 0 0 −1 0

,
0 0 0 0 0
1 0 0 0 0


where x1 (ζ, t) := ∂w
(ζ, t)−φ(ζ, t) is the shear displacement, x2 (ζ, t) := ρ(ζ) ∂w
(ζ, t) is the momentum,
∂ζ
∂t
∂φ
∂φ
x3 (ζ, t) := ∂ζ (ζ, t) is the angular displacement, x4 (ζ, t) := Iρ (ζ) ∂t (ζ, t) is the angular momentum,
w(ζ, t) is the transverse displacement of the beam, and φ(ζ, t) is the rotation angle of a filament of
the beam. K(ζ), ρ(ζ), EI(ζ) and Iρ (ζ) are respectively the shear modulus, the mass density, the
Young’s modulus of elasticity multiplied by the moment of inertia of a cross section and the rotary
moment of inertia of a cross section.




H(b)x(b,t)
define the staggered grid as we show in Figure A.2,
The boundary conditions VB H(a)x(a,t)
i
where ζ1 is the spatial location for x1 (ζ, t) and x3 (ζ, t), and ζ2i is the spatial for x2 (ζ, t) and x4 (ζ, t)
with i = {1, . . . , m}, where m is the amount of finite-dimensional variables per infinite-dimensional
variable. Then, the total state variables of the finite-dimensional system is nd = 4m. We define the
finite-dimensional variables as follows

x11 (t) ≈ x1 (ζ11 , t),
..
.

x12 (t) ≈ x2 (ζ21 , t),
..
.

x13 (t) ≈ x3 (ζ11 , t),
..
.

x14 (t) ≈ x4 (ζ21 , t),
..
.

m
m
m
m
m
m
m
xm
1 (t) ≈ x1 (ζ1 , t), x2 (t) ≈ x2 (ζ2 , t), x3 (t) ≈ x3 (ζ1 , t), x4 (t) ≈ x4 (ζ2 , t).

The length of the grid is given by h =

b−a
.
2m+1

We define Ki = K(ζ1i ), ρi = ρ(ζ2i ), EIi = EI(ζ1i ) and

ζ
a

ζ11

ζ21

ζ12

ζ22

ζ1m

ζ2m

b

Figure A.2 – Discretization grid for the vibrating string.

135



Appendix A. Appendix

Iρi = Iρ (ζ2i ) for i = {1, 2, · · · , m}. Then, using the finite-differences, the following discretization is
obtained


ẋ11 =

1
h



1 1
x
ρ1 2

− va −

ẋ21 =
..
.

1
h



1 2
x
ρ2 2

−

1
h



1 m
x
ρm 2

ẋ12 =

1
h



K2 x21 − K1 x11 ,

ẋ22 =
..
.
ẋm
2 =

1
h



K3 x31 − K2 x21 ,

1
h
1
h

(Fb − Km xm
1 ),


x1 − w a
Iρ1 4

1
h



x2 −
Iρ2 4

ẋm
1

=

ẋ13 =
ẋ23 =
..
.
ẋm
3

=

1
h

1 1
x
ρ1 2

−



1
2



−

wa +

1
2



xm−1
ρm−1 2
1



x1 ,
Iρ1 4
1

x1 +
Iρ1 4
1



1
2

−





x2 ,
Iρ2 4
1

xm−1
Iρ(m−1) 4
1

+

xm
Iρm 4
1



,




1
1



xm
Iρm 4
1




x1 ,
Iρ1 4
1

−

xm−1
Iρ(m−1) 4





1
2



K1 x11 + K2 x21 ,



1
2



K2 x21 + K3 x31 ,

1

,

ẋ14 =

1
h



ẋ24 =
..
.
m
ẋ4 =

1
h



1
h

m
1
(Γb − EIm xm
3 ) + 2 (Km x1 + Fb ) .

EI2 x23 − EI1 x13 +
EI3 x33 − EI2 x23 +




We define the finite-dimensional variables related to the infinite-dimensional variables x1 (ζ, t), x2 (ζ, t),
x3 (ζ, t), and x4 (ζ, t) respectively as
















x13 (t)
x14 (t)
x12 (t)
x11 (t)







..  , xd (t) =  ..  , xd (t) =  ..  , xd (t) =  .. 
xd1 (t) = 
. 
. 
. 
. 
3
4
2


.


m
m
m
m
x4 (t)
x1 (t)
x2 (t)
x3 (t)
Then, we obtain the following matrix representation model


d 


dt 
with

xd1 (t)
xd2 (t)
xd3 (t)
xd4 (t)










=





0
D
0 −F
Q1 xd1 (t)


T
−D
0
0
0   Q2 xd2 (t)

0
0
0
D   Q3 xd3 (t)
F T 0 −DT 0
Q4 xd4 (t)


0 ···

1  −1 1 . . .
D= 2
.
h 
 .. . . . . . .
0 0 ···


136

1





 
 
+
 

b11 b12 0
0
0
0 b23 0
0 b32 0
0
0
0 b43 b44

1 0 ···


..
1 
.
0 
, F =
1 1
 . .
.. 
.
2h  .. . . . .
.
1
0 0 ···
0





0



0
..
.
1



,









va
wa
Fb
Γb









A.1. Finite-differences spatial discretization



 1



K1 · · · 0
 .

.. 
...
Q1 = h 
Q2 = h 
. 
 ..
,

0 · · · Km



EI1 · · ·
0
 .

.. 
..

Q3 = h 
.
. 
 ..
 , Q4 = h 
0 · · · EIm


1
= 
h



b11

−1
0
..
.







,



1
= 
2



b12

0

−1
0
..
.




,





1
= 
h



b23

0

0
0
..
.

ρ1

..
.
0

1
Iρ1

..
.
0

···
...



···
···
...
···



0
.. 
. 
,

1
ρm

0
.. 
. 
,


1
Iρm





,



1
= 
2



b43

1

0
0
..
.



b32 = b11 ,
b44 = b23 .



,



1

Finally, we write the discretized model as a finite-dimensional port-Hamiltonian system
P


ẋ

where
0
 −D T
J =

 0
FT

Q1
 0
Q=

 0
0







xd (t) = 

xd1 (t)
xd2 (t)
xd3 (t)
xd4 (t)




,


d (t)

y(t)

D
0
0
0
0
Q2
0
0

= (J − R)Qxd (t) + Bu(t)
= B T Qxd (t)

0 −F
0 0 0
 0 0 0
0
0 


, R = 
 0 0 0
0
D 
−DT 0
0 0 0


0
0
b11 b12


0
0 
0
 0
,
B=
 0 b32
Q3 0 
0 Q4
0
0







u(t) = 

va (t)
wa (t)
Fb (t)
Γb (t)




,








y(t) = 



(A.4)

0
0 

,
0 
0
0
0
b23 0
0
0
b43 b44


(A.5)







−K1 x11 (t)
1
−EI1 x13 (t)− 2m+1
K1 x11 (t)
1 m
1
1
x (t) + 2m+1
xm (t)
ρm 2
Iρm 4
1
xm (t)
Iρm 4




.



137



Appendix A. Appendix

A.2

Mid-point time discretization

Consider the following ordinary differential equation
ẋ(t) = Ax(t) + Bu(t)

(A.6)

with x ∈ Rn , u ∈ Rm , A ∈ Rn×n , B ∈ Rn×m , n, m ∈ N and t ≥ 0. Given a step time δt > 0 and
k ∈ N, xk estimates x(kδt ), i.e. xk ≈ x(kδt ). Then, the following approximation is known as the
midpoint time integration
xk+1 + xk
xk+1 − xk
=A
ẋ(t) ≈
+ Buk
δt
2




(A.7)

where after some algebra and assuming that In − δ2t A is invertible, with In the identity of size n, we
can write the following discrete model
xk+1 = Ad xk + Bd uk
with
δt
Ad = In − A
2

138

!−1

!

δt
δt
In + A , Bd = In − A
2
2

(A.8)
!−1

δt B.



A.3. An LMI approach to design K or L

A.3

An LMI approach to design K or L

In this appendix, we recall a proposition from [Prajna 02], that allows to solve the IDA-PBC
problem for LTI systems. This approach can be seen as an alternative of pole-placement, LQ-control,
or H∞ -control. We consider the following linear system subject to a state feedback controller:
ẋ(t) = Ax(t) + Bu(t)
u(t) = r(t) + F x(t)

(A.9)

with x(t) ∈ Rn , u(t) ∈ Rm and r(t) ∈ Rm the state, the inputs, and the external input respectively.
A ∈ Rn×n and B ∈ Rn×m known matrices, and F ∈ Rm×n a matrix to design. For LTI system, the
main idea of the IDA-PBC problem is to shape the closed-loop structure into a desired one of the
form:
ẋ(t) = (Jd − Rd )Qd x(t) + Br(t)
(A.10)
with Jd = −Jd> , Rd = Rd> ≥ 0, Qd = Qd > 0 all real matrices of size n × n. To this end, the objective
is to fine the gain F such that
(Jd − Rd )Qd = A + BF
(A.11)
In the following proposition, the existence of matrices Jd , Rd , Qd and F such that (A.11) is verified
by solving a set of LMIs.
Proposition A.3.1. [Prajna 02] Denote by B⊥ a full row rank (n − m) × n matrix that annihilates
B, i.e. B⊥ B = 0. Let us also denote E⊥ = B⊥ A. There exist matrices Jd = −Jd> , Rd = Rd> ≥ 0,
Qd = Qd > 0 and F such that satisfies (Jd − Rd )Qd = A + BF if and only if we can find a solution
X = X> ∈ Rn×n of the following LMIs:
X > 0,

(A.12)

T
−[E⊥ XB⊥
+ B⊥ XE⊥T ] ≥ 0.

Given such an X, compute Sd as follows:
B⊥
Sd =
BT

!−1

!

E⊥ X
,
T −1
−B T XE⊥T (B⊥ B⊥
) B⊥

(A.13)

then the following matrices
Rd = − 12 (Sd + SdT ),
Jd = 21 (Sd − SdT ),
Qd = X−1 ,
F = (B T B)−1 B T (Sd X−1 − A)
satisfy Jd = −Jd> , Rd = Rd> ≥ 0, Qd = Qd > 0 and (Jd − Rd )Qd = A + BF .

(A.14)
♦

Remark A.3.1. Proposition A.3.1 is related to stabilizability. In fact, the LMI (A.12) has solution
if and only if the pair (A, B) is stabilizable [Prajna 02, Proposition 9].
♣
Remark A.3.2. The dual problem consist in following Proposition A.3.1, but replacing A by AT ,
B by C T and F by −LT . The reader can also refer to [Kotyczka 15, Proposition 1].
♣

139



Appendix A. Appendix

Remark A.3.3. As well as in Remark A.3.1, the pair (A, C) is detectable if and only if the LMI
(A.12) has solution with E⊥ = B⊥ AT and B⊥ ∈ R(n−m)×n a left annihilator of C T , i.e. B⊥ C T = 0.
♣
The performances obtained using Proposition A.3.1 are in terms of a desired energy matrix Qd
and a dissipation energy matrix Rd . The LMI (A.12) can be slightly modified in order to keep the
energy matrix in a desired interval and to regulate the damping.
Proposition A.3.2. Under the same statements of Proposition A.3.1, if the following LMIs:
Λ−1
2 − X < 0,
−Λ−1
1 + X < 0,

(A.15)

T
Ξ1 + E⊥ XB⊥
+ B⊥ XE⊥T + ≤ 0,
T
−Ξ2 − E⊥ XB⊥
− B⊥ XE⊥T + ≤ 0,

have solution X = X> for some symmetric matrices Λ1 , Λ2 ∈ Rn×n , Ξ1 , Ξ2 ∈ R(n−m)×(n−m) , such
that 0 < Λ1 < Λ2 and 0 ≤ Ξ1 < Ξ2 , then Λ1 < Qd < Λ2 . Moreover, choosing
B⊥
Sd =
BT

!−1

!

E⊥ X
,
T −1
) B⊥ − γB T
−B T XE⊥T (B⊥ B⊥

(A.16)

with some scalar γ > 0, and the matrices Jd , Rd and F as in (A.14), then A + BF = (Jd − Rd )Qd
with Rd > 0.
♦
Proof. The proof of Proposition A.3.1 is a direct application of [Prajna 02, Proposition 7 and
Remark 8]. See also [Kotyczka 15, Proposition 1].

Remark A.3.4. Matrices Λ1 and Λ2 fix the lowest and highest eigenvalue of Qd respectively. Matrices Ξ1 and Ξ2 keep sufficient (Ξ1 ) but not excessive (Ξ2 ) damping, while the scalar γ > 0 implies
Rd > 0 and then, the asymptotic behavior is ensured.
♣

140



A.4. Abstract formulation of boundary control systems

A.4

Abstract formulation of boundary control systems

Boundary control systems (BCSs) [Fattorini 68, Curtain 12] are a class of control systems where
the dynamics are described by partial differential equations (PDEs), and the actuation and sensing
are situated at the boundaries of the spatial domain. The following abstract formulation aims to
represent a BCS in the standard state space representation:
ẋ = Ax(t), x(0) = x0
Bx(t) = u(t)

(A.17a)
(A.17b)

where A : D(A) → X and B : D(B) → U , X and U are separable Hilbert spaces, such that
D(A) ⊂ D(B) ⊂ X.
Definition A.4.1. [Curtain 12, Definition 3.3.2] The control system (A.17) is a boundary control
system (BCS) if the following hold:
1. The operator A : D(A) → X with D(A) = D(A) ∩ ker(B) and Ax = Ax is the infinitesimal
generator of a C0 -semigroup on X.
2. There exists an operator B ∈ L(U, X), such that for all u ∈ U , Bu ∈ D(A), AB ∈ L(U, X)
and BBu = u.
♣
From condition 1 of Definition A.4.1 we can conclude that if (A.17) is a BCS, then for u(t) = 0
the PDE has aunique solution, while condition 2 implies that any input in the space U can be
applied to the system. The idea of representing the PDE with boundary conditions as a BCS is
that for sufficiently smooth inputs u(t) the system can be written in the standard state formulation
ẋ(t) = Ax(t) + Bu(t).
Example A.4.1. [Jacob 12, Chapter 11] Consider the transport equation given by
∂w
∂w
(ζ, t) =
(ζ, t),
∂t
∂ζ
w(b, t) = u(t),

w(ζ, 0) = w0 (ζ),

(A.18a)
(A.18b)

where ζ ∈ [a, b] is the spatial variable, t ≥ 0 is the time, w(ζ, t) is the transported variable, w0 (ζ)
is the initial condition and u(t) is the input variable. We can write this system as a BCS (A.17)
with A = dζd and B a boundary operator which only takes the value of w(ζ, t) at ζ = b. We
can choose as state space X = L2 ([a, b], R), i.e. the space of all square-integrable functions, and
D(A) = H 1 ([a, b], R), i.e. the space of all absolutely continuous function with square-integrable
derivatives, and D(B) = D(A). The system (A.18) is a BCS, then we can conclude that for u(t) = 0
the PDE (A.18a) has a unique solution and that we can apply any input u(t) on the space U . ♣
Definition A.4.2. [Curtain 12, Definition 3.1.1] Consider the BCS (A.17) on the Hilbert space X.
The function x(t) is called classical solution of (A.17) on [0, τ ] if x(t) ∈ C 1 ([0, τ ] ; X), x(t) ∈ D(A)
for all t ∈ [0, τ ] and x(t) satisfies (A.17) for all t ∈ [0, τ ].
♣

141



Appendix A. Appendix

Definition A.4.3. [Curtain 12, Definition 3.1.4] Consider that we are able to write the BCS (A.17)
as ẋ(t) = Ax(t) + Bu(t) and that A is the infinitesimal generator of a C0 -semigroup T (t). The
function x(t)
Z
t

x(t) = T (t)x0 +

T (t − s)Bu(s)ds

(A.19)

0

with x0 ∈ X is called mild solution of (A.17) on [0, τ ].

♣

Definition A.4.4. [Curtain 12, Definition 2.1.2] A strongly continuous semigroup (C0 -semigroup)
is an operator-valued function T (t) from R+ to L(X) that satisfies the following properties
1. T (t + s) = T (t)T (s), for t, s ≥ 0.,
2. T (0) I,
3. kT (t)x0 − x0 k → 0 when t → 0+ for all x0 ∈ X.
♣

142



Bibliography

Bibliography
[Anderson 07]

B. D. Anderson & J. B. Moore. Optimal control: linear quadratic methods.
Courier Corporation, 2007.

[Andry 83]

A. Andry, E. Shapiro & J. Chung. Eigenstructure assignment for linear systems. IEEE transactions on aerospace and electronic systems, no. 5, pages
711–729, 1983.

[Aoues 17]

S. Aoues, F. L. Cardoso-Ribeiro, D. Matignon & D. Alazard. Modeling and
control of a rotating flexible spacecraft: a port-Hamiltonian approach. IEEE
Transactions on Control Systems Technology, vol. 27, no. 1, pages 355–362,
2017.

[Augner 14]

B. Augner & B. Jacob. Stability and stabilization of infinite-dimensional linear
port-Hamiltonian systems. Evolution Equations and Control Theory, vol. 3,
no. 2, pages 207–229, 2014.

[Augner 18]

B. Augner. Stabilisation of infinite-dimensional port-Hamiltonian systems via
dissipative boundary feedback. PhD thesis, Universität Wuppertal, Fakultät
für Mathematik und Naturwissenschaften . . . , 2018.

[Augner 19]

B. Augner. Well-posedness and stability of infinite-dimensional linear portHamiltonian systems with nonlinear boundary feedback. SIAM Journal on
Control and Optimization, vol. 57, no. 3, pages 1818–1844, 2019.

[Augner 20]

B. Augner & H. Laasri. Exponential stability for infinite-dimensional nonautonomous port-Hamiltonian Systems. Systems & Control Letters, vol. 144,
page 104757, 2020.

[Auriol 19]

J. Auriol, K. A. Morris & F. Di Meglio. Late-lumping backstepping control of
partial differential equations. Automatica, vol. 100, pages 247–259, 2019.

[Balas 78]

M. J. Balas. Active control of flexible systems. Journal of Optimization theory
and Applications, vol. 25, no. 3, pages 415–436, 1978.

[Bassi 07]

L. Bassi, A. Macchelli & C. Melchiorri. An algorithm to discretize onedimensional distributed port Hamiltonian systems. In Lagrangian and Hamiltonian methods for nonlinear control 2006, pages 61–73. Springer, 2007.

[Biedermann 18]

B. Biedermann, P. Rosenzweig & T. Meurer. Passivity-based observer design
for state affine systems using interconnection and damping assignment. In 2018
IEEE Conference on Decision and Control (CDC), pages 4662–4667. IEEE,
2018.

[Brasch 70]

F. Brasch & J. Pearson. Pole placement using dynamic compensators. IEEE
Transactions on Automatic Control, vol. 15, no. 1, pages 34–43, 1970.

[Brogliato 20]

B. Brogliato, R. Lozano, B. Maschke & O. Egeland. Passivity-based control.
In Dissipative Systems Analysis and Control, pages 491–573. Springer, 2020.

143



Bibliography

[Brugnoli 19a]

A. Brugnoli, D. Alazard, V. Pommier-Budinger & D. Matignon. PortHamiltonian formulation and symplectic discretization of plate models Part
I: Mindlin model for thick plates. Applied Mathematical Modelling, vol. 75,
pages 940–960, 2019.

[Brugnoli 19b]

A. Brugnoli, D. Alazard, V. Pommier-Budinger & D. Matignon. PortHamiltonian formulation and symplectic discretization of plate models Part
II: Kirchhoff model for thin plates. Applied Mathematical Modelling, vol. 75,
pages 961–981, 2019.

[Califano 18]

F. Califano, M. Bin, A. Macchelli & C. Melchiorri. Stability analysis of nonlinear repetitive control schemes. IEEE control systems letters, vol. 2, no. 4,
pages 773–778, 2018.

[Cardoso-Ribeiro 17] F. L. Cardoso-Ribeiro, D. Matignon & V. Pommier-Budinger. A portHamiltonian model of liquid sloshing in moving containers and application
to a fluid-structure system. Journal of Fluids and Structures, vol. 69, pages
402–427, 2017.
[Cardoso-Ribeiro 21] F. L. Cardoso-Ribeiro, D. Matignon & L. Lefèvre. A Partitioned Finite Element Method for power-preserving discretization of open systems of conservation laws. IMA Journal of Mathematical Control and Information, vol. 38,
no. 2, pages 493–533, 2021.
[Curtain 12]

R. F. Curtain & H. Zwart. An introduction to infinite-dimensional linear
systems theory, volume 21. Springer Science & Business Media, 2012.

[Dalsmo 98]

M. Dalsmo & A. Van Der Schaft. On representations and integrability of
mathematical structures in energy-conserving physical systems. SIAM Journal
on Control and Optimization, vol. 37, no. 1, pages 54–91, 1998.

[Demetriou 04]

M. A. Demetriou. Natural second-order observers for second-order distributed
parameter systems. Systems & control letters, vol. 51, no. 3-4, pages 225–234,
2004.

[Duindam 09]

V. Duindam, A. Macchelli, S. Stramigioli & H. Bruyninckx. Modeling and
control of complex physical systems: the port-hamiltonian approach. Springer
Science & Business Media, 2009.

[Ennsbrunner 05]

H. Ennsbrunner & K. Schlacher. On the geometrical representation and interconnection of infinite dimensional port controlled hamiltonian systems. In
Proceedings of the 44th IEEE Conference on Decision and Control, pages
5263–5268. IEEE, 2005.

[Fattorini 68]

H. Fattorini. Boundary Control Systems. SIAM Journal on Control, vol. 6,
no. 3, pages 349–385, 1968.

[Feng 16]

H. Feng & B.-Z. Guo. Observer design and exponential stabilization for wave
equation in energy space by boundary displacement measurement only. IEEE
Transactions on Automatic Control, vol. 62, no. 3, pages 1438–1444, 2016.

[Golo 04]

G. Golo, V. Talasila, A. Van Der Schaft & B. Maschke. Hamiltonian discretization of boundary control systems. Automatica, vol. 40, no. 5, pages 757–771,
2004.

144



Bibliography

[Gugat 05]

[Guo 07]

[Guo 09]

[Hamroun 06]

[Hamroun 10]

[Hastir 19]

[Hidayat 11]

[Horn 12]
[Jacob 12]
[Jacob 15]

[Jacob 18]
[Jacob 19]

[Jiang 94]
[John 49]

[Kalman 69]

M. Gugat, G. Leugering & G. Sklyar. Lp -optimal boundary control for the
wave equation. SIAM Journal on Control and Optimization, vol. 44, no. 1,
pages 49–74, 2005.
B.-Z. Guo & C.-Z. Xu. The stabilization of a one-dimensional wave equation
by boundary feedback with noncollocated observation. IEEE Transactions on
Automatic Control, vol. 52, no. 2, pages 371–377, 2007.
B.-Z. Guo & W. Guo. The strong stabilization of a one-dimensional wave
equation by non-collocated dynamic boundary feedback control. Automatica,
vol. 45, no. 3, pages 790–797, 2009.
B. Hamroun, L. Lefèvre & E. Mendes. Port-based modelling for open channel
irrigation systems. Transactions on Fluid Mechanics, vol. 1, no. 12, pages
995–1009, 2006.
B. Hamroun, A. Dimofte, L. Lefèvre & E. Mendes. Control by interconnection
and energy-shaping methods of port Hamiltonian models. Application to the
shallow water equations. European Journal of Control, vol. 16, no. 5, pages
545–563, 2010.
A. Hastir, F. Califano & H. Zwart. Well-posedness of infinite-dimensional
linear systems with nonlinear feedback. Systems & Control Letters, vol. 128,
pages 19–25, 2019.
Z. Hidayat, R. Babuska, B. De Schutter & A. Nunez. Observers for linear
distributed-parameter systems: A survey. In 2011 IEEE international symposium on robotic and sensors environments (ROSE), pages 166–171. IEEE,
2011.
R. A. Horn & C. R. Johnson. Matrix analysis. Cambridge university press,
2012.
B. Jacob & H. J. Zwart. Linear port-hamiltonian systems on infinitedimensional spaces, volume 223. Springer Science & Business Media, 2012.
B. Jacob, K. Morris & H. Zwart. C 0-semigroups for hyperbolic partial differential equations on a one-dimensional spatial domain. Journal of evolution
equations, vol. 15, no. 2, pages 493–502, 2015.
B. Jacob & H. Zwart. An operator theoretic approach to infinite-dimensional
control systems. GAMM-Mitteilungen, vol. 41, no. 4, page e201800010, 2018.
B. Jacob & J. T. Kaiser. On exact controllability of infinite-dimensional linear
port-Hamiltonian systems. IEEE Control Systems Letters, vol. 3, no. 3, pages
661–666, 2019.
J. Jiang. Design of reconfigurable control systems using eigenstructure assignments. International Journal of Control, vol. 59, no. 2, pages 395–410, 1994.
F. John. On linear partial differential equations with analytic coefficients
unique continuation of data. Communications on Pure and Applied Mathematics, vol. 2, no. 2-3, pages 209–253, 1949.
R. E. Kalman, P. L. Falb & M. A. Arbib. Topics in mathematical system
theory, volume 1. McGraw-Hill New York, 1969.

145



Bibliography

[Kosmidou 07]

O. I. Kosmidou. Generalized Riccati equations associated with guaranteed cost
control: An overview of solutions and features. Applied Mathematics and
Computation, vol. 191, no. 2, pages 511–520, 2007.

[Kotyczka 15]

P. Kotyczka & M. Wang. Dual observer-based compensator design for linear
port-Hamiltonian systems. In 2015 European Control Conference (ECC), pages
2908–2913. IEEE, 2015.

[Kotyczka 18]

P. Kotyczka, B. Maschke & L. Lefèvre. Weak form of Stokes–Dirac structures
and geometric discretization of port-Hamiltonian systems. Journal of Computational Physics, vol. 361, pages 442–476, 2018.

[Krstic 08]

M. Krstic, B.-Z. Guo, A. Balogh & A. Smyshlyaev. Output-feedback stabilization of an unstable wave equation. Automatica, vol. 44, no. 1, pages 63–74,
2008.

[Lanzon 08]

A. Lanzon, Y. Feng, B. D. Anderson & M. Rotkowitz. Computing the positive
stabilizing solution to algebraic Riccati equations with an indefinite quadratic
term via a recursive method. IEEE Transactions on Automatic Control, vol. 53,
no. 10, pages 2280–2291, 2008.

[Le Gorrec 05]

Y. Le Gorrec, H. Zwart & B. Maschke. Dirac structures and boundary control
systems associated with skew-symmetric differential operators. SIAM journal
on control and optimization, vol. 44, no. 5, pages 1864–1892, 2005.

[Le Gorrec 06]

Y. Le Gorrec, B. Maschke, J. Villegas & H. Zwart. Dissipative boundary control
systems with application to distributed parameters reactors. In 2006 IEEE Conference on Computer Aided Control System Design, 2006 IEEE International
Conference on Control Applications, 2006 IEEE International Symposium on
Intelligent Control, pages 668–673. IEEE, 2006.

[Liu 21]

N. Liu, Y. Wu & Y. Le Gorrec. Energy based modeling of ionic polymer metal
composite actuators dedicated to the control of flexible structures. IEEE/ASME
Transactions on Mechatronics, pages 1–1, 2021.

[Luenberger 64]

D. G. Luenberger. Observing the state of a linear system. IEEE transactions
on military electronics, vol. 8, no. 2, pages 74–80, 1964.

[Luo 12]

Z.-H. Luo, B.-Z. Guo & Ö. Morgül. Stability and stabilization of infinite
dimensional systems with applications. Springer Science & Business Media,
2012.

[Macchelli 04a]

A. Macchelli & C. Melchiorri. Control by interconnection and energy shaping of
the Timoshenko beam. Mathematical and Computer Modelling of Dynamical
Systems, vol. 10, no. 3-4, pages 231–251, 2004.

[Macchelli 04b]

A. Macchelli & C. Melchiorri. Modeling and control of the Timoshenko beam.
The distributed port Hamiltonian approach. SIAM Journal on Control and
Optimization, vol. 43, no. 2, pages 743–767, 2004.

[Macchelli 05]

A. Macchelli & C. Melchiorri. Control by interconnection of mixed port Hamiltonian systems. IEEE Transactions on Automatic Control, vol. 50, no. 11,
pages 1839–1844, 2005.

146



Bibliography

[Macchelli 11]

[Macchelli 13]
[Macchelli 17]

[Macchelli 18]

[Macchelli 20]

[Malzer 19]

[Malzer 20a]

[Malzer 20b]

[Maschke 92]

[Maschke 98]

[Meurer 09]

[Meurer 11]

[Meurer 12]
[Meurer 13]

A. Macchelli. Energy shaping of distributed parameter port-Hamiltonian systems based on finite element approximation. Systems & Control Letters,
vol. 60, no. 8, pages 579–589, 2011.
A. Macchelli. Boundary energy shaping of linear distributed port-Hamiltonian
systems. European Journal of Control, vol. 19, no. 6, pages 521–528, 2013.
A. Macchelli, Y. Le Gorrec, H. Ramirez & H. Zwart. On the Synthesis of
Boundary Control Laws for Distributed Port-Hamiltonian Systems. IEEE
Transactions on Automatic Control, vol. 62, no. 4, pages 1700–1713, April
2017.
A. Macchelli & F. Califano. Dissipativity-based boundary control of linear
distributed port-Hamiltonian systems. Automatica, vol. 95, pages 54 – 62,
2018.
A. Macchelli, Y. Le Gorrec & H. Ramírez. Exponential Stabilization of PortHamiltonian Boundary Control Systems via Energy Shaping. IEEE Transactions on Automatic Control, vol. 65, no. 10, pages 4440–4447, 2020.
T. Malzer, H. Rams & M. Schöberl. Energy-Based In-Domain Control of a
Piezo-Actuated Euler-Bernoulli Beam. IFAC-PapersOnLine, vol. 52, no. 2,
pages 144–149, 2019.
T. Malzer, H. Rams, B. Kolar & M. Schöberl. Stability Analysis of the Observer
Error of an In-Domain Actuated Vibrating String. IEEE Control Systems
Letters, vol. 5, no. 4, pages 1237–1242, 2020.
T. Malzer, J. Toledo, Y. L. Gorrec & M. Schöberl. Energy-Based In-Domain
Control and Observer Design for Infinite-Dimensional Port-Hamiltonian Systems. arXiv preprint arXiv:2002.01717, 2020.
B. M. Maschke & A. J. van der Schaft. Port-controlled Hamiltonian systems:
modelling origins and systemtheoretic properties. IFAC Proceedings Volumes,
vol. 25, no. 13, pages 359–365, 1992.
B. M. Maschke, R. Ortega & A. J. van der Schaft. Energy-based Lyapunov
functions for forced Hamiltonian systems with dissipation. In Proceedings of
the 37th IEEE Conference on Decision and Control (Cat. No. 98CH36171),
volume 4, pages 3599–3604. IEEE, 1998.
T. Meurer & A. Kugi. Tracking control for boundary controlled parabolic PDEs
with varying parameters: Combining backstepping and differential flatness. Automatica, vol. 45, no. 5, pages 1182–1194, 2009.
T. Meurer & A. Kugi. Tracking control design for a wave equation with dynamic boundary conditions modeling a piezoelectric stack actuator. International Journal of Robust and Nonlinear Control, vol. 21, no. 5, pages 542–562,
2011.
T. Meurer. Control of higher–dimensional pdes: Flatness and backstepping
designs. Springer Science & Business Media, 2012.
T. Meurer.
On the extended Luenberger-type observer for semilinear
distributed-parameter systems. IEEE T. Automat. Contr., vol. 58, no. 7, pages
1732–1743, 2013.

147



Bibliography

[Morgül 94]
[Morgul 98]
[Morgül 02]
[Nishida 11]

[Ortega 02]

[Ortega 04]

[Ortega 08]

[Pasumarthy 07]

[Pasumarthy 12]

[Prajna 02]

[Ramirez 14]

[Ramirez 17a]

[Ramirez 17b]

[Rashad 20]

148

Ö. Morgül. A dynamic control law for the wave equation. Automatica, vol. 30,
no. 11, pages 1785–1792, 1994.
O. Morgul. Stabilization and disturbance rejection for the wave equation. IEEE
Transactions on Automatic Control, vol. 43, no. 1, pages 89–95, 1998.
Ö. Morgül. An exponential stability result for the wave equation. Automatica,
vol. 38, no. 4, pages 731–735, 2002.
G. Nishida, K. Takagi, B. Maschke & T. Osada. Multi-scale distributed parameter modeling of ionic polymer-metal composite soft actuator. Control Engineering Practice, vol. 19, no. 4, pages 321–334, 2011.
R. Ortega, A. Van Der Schaft, B. Maschke & G. Escobar. Interconnection
and damping assignment passivity-based control of port-controlled Hamiltonian
systems. Automatica, vol. 38, no. 4, pages 585–596, 2002.
R. Ortega & E. Garcia-Canseco. Interconnection and damping assignment
passivity-based control: A survey. European Journal of control, vol. 10, no. 5,
pages 432–450, 2004.
R. Ortega, A. Van Der Schaft, F. Castanos & A. Astolfi. Control by interconnection and standard passivity-based control of port-Hamiltonian systems.
IEEE Transactions on Automatic control, vol. 53, no. 11, pages 2527–2542,
2008.
R. Pasumarthy & A. Van Der Schaft. Achievable Casimirs and its implications on control of port-Hamiltonian systems. International Journal of Control,
vol. 80, no. 9, pages 1421–1438, 2007.
R. Pasumarthy, V. Ambati & A. van der Schaft. Port-Hamiltonian discretization for open channel flows. Systems & control letters, vol. 61, no. 9, pages
950–958, 2012.
S. Prajna, A. van der Schaft & G. Meinsma. An LMI approach to stabilization of linear port-controlled Hamiltonian systems. Systems & control letters,
vol. 45, no. 5, pages 371–385, 2002.
H. Ramirez, Y. Le Gorrec, A. Macchelli & H. Zwart. Exponential Stabilization
of Boundary Controlled Port-Hamiltonian Systems With Dynamic Feedback.
IEEE Transactions on Automatic Control, vol. 59, no. 10, pages 2849–2855,
Oct 2014.
H. Ramirez, H. Zwart & Y. Le Gorrec. Stabilization of infinite dimensional
port-Hamiltonian systems by nonlinear dynamic boundary control. Automatica, vol. 85, pages 61 – 69, 2017.
H. Ramirez, H. Zwart, Y. Le Gorrec & A. Macchelli. On backstepping boundary
control for a class of linear port-Hamiltonian systems. In 2017 IEEE 56th
Annual Conference on Decision and Control (CDC), pages 658–663. IEEE,
2017.
R. Rashad, F. Califano, A. J. van der Schaft & S. Stramigioli. Twenty years
of distributed port-Hamiltonian systems: a literature review. IMA Journal of
Mathematical Control and Information, 2020.



Bibliography

[Schaum 18]

A. Schaum, T. Meurer & J. A. Moreno. Dissipative observers for coupled
diffusion–convection–reaction systems. Automatica, vol. 94, pages 307–314,
2018.

[Schöberl 08]

M. Schöberl, H. Ennsbrunner & K. Schlacher. Modelling of piezoelectric
structures–a Hamiltonian approach. Mathematical and Computer Modelling
of Dynamical Systems, vol. 14, no. 3, pages 179–193, 2008.

[Schöberl 12]

M. Schöberl & A. Siuka. On Casimir functionals for infinite-dimensional
port-Hamiltonian control systems. IEEE Transactions on Automatic Control,
vol. 58, no. 7, pages 1823–1828, 2012.

[Schöberl 14]

M. Schöberl & A. Siuka. Jet bundle formulation of infinite-dimensional portHamiltonian systems using differential operators. Automatica, vol. 50, no. 2,
pages 607–613, 2014.

[Serhani 19]

A. Serhani, D. Matignon & G. Haine. A partitioned finite element method
for the structure-preserving discretization of damped infinite-dimensional portHamiltonian systems with boundary control. In International Conference on
Geometric Science of Information, pages 549–558. Springer, 2019.

[Seslija 12]

M. Seslija, A. van der Schaft & J. M. Scherpen. Discrete exterior geometry
approach to structure-preserving discretization of distributed-parameter portHamiltonian systems. Journal of Geometry and Physics, vol. 62, no. 6, pages
1509–1531, 2012.

[Smyshlyaev 05]

A. Smyshlyaev & M. Krstic. Backstepping observers for a class of parabolic
PDEs. Systems & Control Letters, vol. 54, no. 7, pages 613–625, 2005.

[Smyshlyaev 09]

A. Smyshlyaev & M. Krstic. Boundary control of an anti-stable wave equation
with anti-damping on the uncontrolled boundary. Systems & Control Letters,
vol. 58, no. 8, pages 617–623, 2009.

[Staffans 05]

O. Staffans. Well-posed linear systems, volume 103. Cambridge University
Press, 2005.

[Stramigioli 01]

S. Stramigioli. Modeling and ipc control of interactive mechanical systems—a
coordinate-free approach. 2001.

[Toledo 20]

J. Toledo, H. Ramirez, Y. Wu & Y. Le Gorrec. Passive observers for distributed
port-Hamiltonian systems. In 21st IFAC World Congress, 2020, July 12-17,
2020, Berlin, Germany, 2020.

[Trenchant 18]

V. Trenchant, H. Ramirez, P. Kotyczka & Y. Le Gorrec. Finite differences on
staggered grids preserving the port-Hamiltonian structure with application to
an acoustic duct. Journal of Computational Physics, vol. 373, pages 673–697,
November 2018.

[Tucsnak 14]

M. Tucsnak & G. Weiss. Well-posed systems—The LTI case and beyond. Automatica, vol. 50, no. 7, pages 1757–1779, 2014.

[van der Schaft 00]

A. van der Schaft. L2-gain and passivity techniques in nonlinear control,
volume 2. Springer, 2000.

149



Bibliography

[van der Schaft 02]

[Venkatraman 10a]
[Venkatraman 10b]

[Villegas 05]

[Villegas 07]
[Villegas 09]

[Vincent 16]

[Voß 14]

[Vu 17]

[Wu 18]
[Yaghmaei 18]

[Yang 05]

[Zhou 17]

[Zuazua 93]

[Zwart 10]

150

A. van der Schaft & B. M. Maschke. Hamiltonian formulation of distributedparameter systems with boundary energy flow. Journal of Geometry and
Physics, vol. 42, no. 1-2, pages 166–194, 2002.
A. Venkatraman & A. van der Schaft. Full-order observer design for a class
of port-Hamiltonian systems. Automatica, vol. 46, no. 3, pages 555–561, 2010.
A. Venkatraman & A. van der Schaft. Energy shaping of port-Hamiltonian
systems by using alternate passive input-output pairs. European Journal of
Control, vol. 16, no. 6, pages 665–677, 2010.
J. Villegas, H. Zwart, Y. Le Gorrec, B. Maschke & A. Van Der Schaft. Stability
and stabilization of a class of boundary control systems. In Proceedings of the
44th IEEE Conference on Decision and Control, pages 3850–3855. IEEE, 2005.
J. Villegas. A Port-Hamiltonian Approach to Distributed Parameter Systems.
PhD thesis, University of Twente, Netherlands, 2007.
J. A. Villegas, H. Zwart, Y. Le Gorrec & B. Maschke. Exponential stability of
a class of boundary control systems. IEEE Transactions on Automatic Control,
vol. 54, no. 1, pages 142–147, 2009.
B. Vincent, N. Hudon, L. Lefèvre & D. Dochain. Port-Hamiltonian observer
design for plasma profile estimation in tokamaks. IFAC-PapersOnLine, vol. 49,
no. 24, pages 93–98, 2016.
T. Voß & J. M. Scherpen. Port-hamiltonian modeling of a nonlinear timoshenko beam with piezo actuation. SIAM Journal on Control and Optimization,
vol. 52, no. 1, pages 493–519, 2014.
N. M. T. Vu, L. Lefevre & R. Nouailletas. Distributed and backstepping boundary controls for port-Hamiltonian systems with symmetries. Mathematical and
Computer Modelling of Dynamical Systems, vol. 23, no. 1, pages 55–76, 2017.
Y. Wu, B. Hamroun, Y. Le Gorrec & B. Maschke. Reduced order LQG control
design for port Hamiltonian systems. Automatica, vol. 95, pages 86–92, 2018.
A. Yaghmaei & M. J. Yazdanpanah. Structure preserving observer design for
port-Hamiltonian systems. IEEE Transactions on Automatic Control, vol. 64,
no. 3, pages 1214–1220, 2018.
K.-J. Yang, K.-S. Hong & F. Matsuno. Robust boundary control of an axially moving string by using a PR transfer function. IEEE Transactions on
Automatic Control, vol. 50, no. 12, pages 2053–2058, 2005.
W. Zhou, B. Hamroun, F. Couenne & Y. Le Gorrec. Distributed portHamiltonian modelling for irreversible processes. Mathematical and Computer
Modelling of Dynamical Systems, vol. 23, no. 1, pages 3–22, 2017.
E. Zuazua. Exact controllability for semilinear wave equations in one space
dimension. In Annales de l’Institut Henri Poincare (C) Non Linear Analysis,
volume 10, pages 109–129. Elsevier, 1993.
H. Zwart, Y. Le Gorrec, B. Maschke & J. Villegas. Well-posedness and regularity of hyperbolic boundary control systems on a one-dimensional spatial
domain. ESAIM: control, optimisation and calculus of variations, vol. 16,
no. 4, pages 1077–1093, 2010.



List of Figures

List of Figures

II.1

Electrical power distribution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11

II.2

Vibrating strings in a guitar . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13

II.3 Satellite . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
II.4 Static output feedback . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
II.5 Equivalent representation of the static output feedback. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
II.6 Dynamic output feedback . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22
II.7 String deformation

(Desired behavior) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27

II.8 String deformation (control by interconnection) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27
II.9 Discretization scheme using staggered grids.. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
II.10 String deformation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
II.11 Observed deformation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
II.12 String deformation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
II.13 Observed deformation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
II.14 String deformation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
II.15 Observed deformation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
II.16 String deformation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
II.17 Observed deformation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
III.1 (a): λ(A): Eigenvalues of Ad with nd = 59, λ(AK ): Ad − Bd K eigenvalues and λ(AL ):
Ad − LCd eigenvalues. (b): λ(Ah ): discretized model eigenvalues with nd = 67, λ(Acl ):
closed-loop eigenvalues. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
III.2 Observer-based state feedback diagram block. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39
III.3 Passive observer-based state feedback diagram block. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39
III.4 Closed-loop system between a BC-PHS and a finite-dimensional controller . . . . . . . . . . . 41
III.5 Closed-loop system between a BC-PHS and a finite-dimensional controller by partial
interconnection. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42
III.6 Discretization scheme using staggered grids.. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47
III.7 Plant eigenvalues λ(A), controller eigenvalues λ(AK ), and observer eigenvalues λ(AL ).. 49
III.8 Hamiltonian matrix eigenvalues λ(HM ). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49

151



List of Figures

III.9 Eigenvalues of Qc λ(Qc ) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50
III.10 Closed-loop eigenvalues λ(ACL ) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50
III.11Deformation.. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50
III.12Observed deformation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50
III.13Plant eigenvalues λ(A), controller eigenvalues λ(AK ), and observer eigenvalues λ(AL ).. 51
III.14Hamiltonian matrix eigenvalues λ(HM ). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51
III.15Eigenvalues of Qc λ(Qc ). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51
III.16 Closed-loop eigenvalues λ(ACL ) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51
III.17Deformation.. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52
III.18Observed deformation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52
III.19Discretization scheme using staggered grids for the Timoshenko beam. . . . . . . . . . . . . . . . 53
III.20Plant λ(A), controller λ(AK ), and observer eigenvalues λ(AL ) for the design 3 . . . . . . . . 55
III.21Closed-loop eigenvalues λ(ACL ) for the design 3 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56
III.22End tip deformation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56
III.23Beam deformation (design 1) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57
III.24Observed deformation (design 1) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57
III.25Beam deformation (design 2) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58
III.26Observed deformation (design 2) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58
III.27Beam deformation (design 3) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58
III.28Observed deformation (design 3) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58
III.29Plant λ(A), controller λ(AK ), and observer eigenvalues λ(AL ) (design 3) . . . . . . . . . . . . . 62
III.30Closed-loop eigenvalues λ(ACL ) (design 3) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63
III.31End tip deformation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63
III.32Beam deformation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64
III.33Observed deformation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64
III.34Beam deformation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64
III.35Observed deformation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64
III.36Beam deformation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65
III.37Observed deformation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65
III.38Passive interconnection. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 66
III.39Microelectromechanical systems (MEMS) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 68

152



List of Figures

III.40Top: Energy response in open loop. Middle: Output response of the nonlinear model
(blue) and the linearized one (red). Bottom: Applied input. . . . . . . . . . . . . . . . . . . . . . . . . 70
III.41State response in open loop of the nonlinear model (blue) and the linearized one (red) 71
III.42Plant λ(A), observer λ(AL ), controller 1 λ(AK1 ), and controller 2 λ(AK2 ) eigenvalues.

72

III.43State response in open loop of the nonlinear model (blue), the linearized one (red),
and the observed one (red).. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73
III.44Error between the states of the nonlinear system and the states of the observer in
open loop. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 74
III.45Design 1. State variable of the nonlinear system (blue) and state variable of the
observer (red). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 75
III.46Design 1. Output of the nonlinear system (blue), output of the observer (red), and
control law (bottom figure). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 75
III.47Design 2. State variable of the nonlinear system (blue) and state variable of the
observer (red). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76
III.48Design 2. Output of the nonlinear system (blue), output of the observer (red), and
control law (bottom figure) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76
IV.1 String deformation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 89
IV.2 Estimated deformation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 89
IV.3 Estimation error . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 89
IV.4 Hamiltonian of the plant (green), observer (red) and error system (blue) . . . . . . . . . . . . . 89
IV.5 String deformation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 90
IV.6 Estimated deformation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 90
IV.7 Deformation error . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 90
IV.8 Hamiltonian of the plant (green), observer (red) and error system (blue) . . . . . . . . . . . . . 90
IV.9 Power preserving interconnection between the infinite-dimensional observer and the
finite-dimensional auxiliary system. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 92
IV.10String deformation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 94
IV.11Estimated deformation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 94
IV.12Deformation error . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 94
IV.13Hamiltonian of the plant (green), observer (red) and error system (blue) . . . . . . . . . . . . . 94
IV.14Beam deformation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 96
IV.15Estimated deformation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 96
IV.16Deformation error . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 97
IV.17Hamiltonian of the plant (green), observer (red) and error system (blue) . . . . . . . . . . . . . 97

153



List of Figures

IV.18Observer convergence of the conjugated output ŷ(t) to y(t). y1 and y2 are respectively,
the negative force and negative torque at the left side of the beam. y3 and y4 are
respectively, the transverse velocity and angular velocity at the right side of the beam. 97
IV.19String deformation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 104
IV.20Estimated deformation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 104
IV.21Deformation error . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 104
IV.22Hamiltonian of the plant (green), observer (red) and error system (blue) . . . . . . . . . . . . . 104
IV.23Observer convergence of the conjugated output ŷ(t) to y(t). y1 is the negative force
at the left side of the string and y2 is the velocity of the string at the right side. . . . . . . 104
IV.24Hamiltonian energy in the ideal case of full damping (blue), in a partial damping case
due to the lake of sensors (red), and using the observer-based damping (green). . . . . . . . 109
IV.25String deformation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110
IV.26Estimated deformation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110
IV.27Deformation error . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110
IV.28Hamiltonian of the plant (green), observer (red) and error system (blue) . . . . . . . . . . . . . 110
IV.29Convergence of the observed output ŷ(t) to the conjugated output y(t). . . . . . . . . . . . . . . 111
IV.30Hamiltonian energy in the ideal case of full damping (blue), in a partial damping case
due to the lake of sensors (red), and using the observer-based damping (green). . . . . . . . 118
IV.31String deformation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118
IV.32Estimated deformation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118
IV.33Deformation error . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119
IV.34Hamiltonian of the plant (green), observer (red) and error system (blue) . . . . . . . . . . . . . 119
IV.35Observer convergence of the conjugated output ŷ(t) to y(t). . . . . . . . . . . . . . . . . . . . . . . . . 119
IV.36String deformation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 122
IV.37Observed deformation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 122
IV.38 String deformation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 123
IV.39 Observed deformation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 123
A.1 Discretization grid for the vibrating string.. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 133
A.2 Discretization grid for the vibrating string.. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 135

154



List of Tables

List of Tables

III.1 Plant parameters. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52
III.2 Design parameters. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54
III.3 Plant Parameters. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61
III.4 Observer design parameters. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61
III.5 Controller design parameters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62
III.6 Plant Parameters. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 68
III.7 Linearization point.. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69
III.8 Observer design parameters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71
III.9 Controller design parameters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72
IV.1 Scope of the observers for the vibrating string of this chapter . . . . . . . . . . . . . . . . . . . . . . . 81
IV.2 Scope of the observers for the Timoshenko beam of this chapter. . . . . . . . . . . . . . . . . . . . . 81
IV.3 Control scope for the vibrating string. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81
IV.4 Design parameters. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109
IV.5 Controller parameters. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 117
IV.6 Observer parameters. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 117

155



Titre : Synthèse de lois de commande à base d’observateurs pour les systèmes à paramètres distribués: une approche Hamiltonienne à ports.
Mots clefs: Systèmes à dimension infinie, systèmes Hamiltonien à port, observateurs,
commande.
Résumé : L’approche Hamiltonienne à ports premier temps discrétisé et la commande basée
s’est avérée être particulièrement bien adaptée à la modélisation et la commande des systèmes à paramètres distribués (SPD). A titre
d’exemples de systèmes entrant dans cette
classe de systèmes nous pouvons citer les
ondes, les poutres vibrantes, les canaux ouverts, la dynamique des fluides, les structures
piézoélectriques et les réacteurs chimiques.
Dans cette thèse, nous proposons de nouveaux
outils pour la synthèse de lois de commandes
basées observateurs d’état (CBOE) pour une
classe de SPD. Plus précisément la classe de
SPD étudiée dans cette thèse est la classe des
systèmes Hamiltoniens à ports linéaires contrôlés à la frontière (SHP-CF). Ce sont des systèmes décrits par des équations différentielles
partielles dont les actionneurs et les capteurs
sont situés à la frontière de leur domaine spatial. Pour la synthèse, nous utilisons deux approches : early-lumping et late-lumping. Pour
la première approche, le système est dans un

observateurs est ensuite synthétisé en dimension finie. Pour cela nous proposons deux méthodes, l’une privilégiant la commande, l’autre
l’observation. Dans les deux cas, nous combinons des outils de contrôle classiques comme le
régulateur quadratique linéaire ou le placement
de pôles avec l’approche Hamiltonienne pour
garantir la stabilité du système en boucle fermée lorsque le correcteur CBOE d’ordre réduit
est appliqué au SHP-CF. Pour la deuxième
approche, nous proposons différents observateurs de dimension infinie pour les SHP-CF en
fonction des mesures disponibles. Selon le cas
considéré, la convergence asymptotique ou exponentielle de l’observateur est prouvée. Enfin, nous proposons quelques résultats préliminaires sur la commande par injection de dissipation ou modelage d’énergie en utilisant les
observateurs précédemment étudiés et la corde
vibrante comme exemple illustratif.

Title : Observer-based boundary control of distributed parameter systems: a portHamiltonian approach.
Keywords : Infinite-dimensional systems, port-Hamiltonian systems, observer-based state
feedback.
Abstract : The port-Hamiltonian approach lumping approach, we have proposed two mehas shown to be well suited for the modelling and control of distributed parameter systems (DPSs). Some examples of this class of
systems are the waves, beams, open channels,
fluid motion, piezoelectric structures, and chemical reactors. In this thesis, we have provided some tools for the design of observerbased state feedback (OBSF) controllers for a
class of DPSs. The class of DPSs studied in
this thesis is the class of boundary controlled
port-Hamiltonian systems (BC-PHSs). These
are systems described by partial differential
equations with actuators and sensors located
at the spatial boundaries. For the synthesis, we
have used two approaches : the early-lumping
and the late-lumping approach. For the early

Université Bourgogne Franche-Comté
32, avenue de l’Observatoire
25000 Besançon

thods to design the OBSF gains. In both, we
combine classical control tools as the linear
quadratic regulator or pole placement with
the port-Hamiltonian approach to guarantee
the closed-loop stability when applying the
OBSF controller to the BC-PHS. For the latelumping approach, we have proposed infinitedimensional observers for BC-PHSs subject to
different types of measurements. Depending
on the case, the observer convergence is guaranteed to be asymptotic or exponential. Finally, some first steps toward the observerbased damping injection and energy shaping
have been studied using the vibrating string as
an example.

